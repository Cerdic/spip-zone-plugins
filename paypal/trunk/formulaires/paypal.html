[(#REM)
	Formulaire de paiement Paypal : on peut soit acheter, soit s'abonner, soit donner
	Plus d'info sur les paramètres sur le site de paypal:
	https://www.paypalobjects.com/IntegrationCenter/ic_std-variable-ref-cart-upload.html

	paramètres:
		- shopping_url:          URL de la boutique, défaut = adresse du site
		- redirect_ok:           URL de redirection une fois le paiement effectué
		- libelle:               Libellé décrivant la commande
		- custom:                Variable de transit jamais présenté au client.
		                         Sert à identifier le «type» de transaction. Ex: «payer_commande»
		- invoice|identifiant:   chaine unique identifiant la commande
		- shipping:              frais de port, défaut = 0
		- handling_cart:         idem shipping (?)

		# Achat ou Abonnement ?
		- type:                  Détermine si on achète ou si on s'abonne ou si on donne
		                         "abonnement" = s'abonner
		                         ""           = acheter
		                         "donner"     = donner
		# Pour un achat, soit on indique "details", soit on indique "prix"
		# Pour un abonnement, on indique "prix", "duree" et "periode"
		# Pour un donation, on indique "prix" s'il est fourni
		- details:               Tableau associatif détaillant le contenu de l'achat, avec prix et quantité pour chaque article
		                         array(0=>array(descriptif=>xx, prix=>yy, quantite=>zz), 1=>array(...))
		- prix:                  Prix de l'achat ou de l'abonnement
		- duree:                 Durée de l'abonnement
		- periode:               ?

		# livraison
		- no_shipping:           Paypal demandera-t-il à l'acheteur son adresse de livraison ? défaut = 1
		                         0: on demande, mais pas obligatoire
		                         1: pas obligatoire
		                         2: obligatoire

		# Pour pré-remplir les champs du formulaire d'inscription de l'acheteur sur le site de paypal
		- email:                 Email
		- first_name:            Prénom
		- last_name:             Nom
		- address1:              Voie
		- address2:              Complément
		- city:                  Ville
		- zip:                   Code postal
		- country:               Code du pays (2 lettres, idem plugin "pays")
		- night_phone_b:         Numéro de téléphone

		# Personnaliser le bouton Paypal
		# par défaut, il s'agit d'un input image, téléchargée sur le site de Paypal
		- bouton_paypal_acheter:         URL de l'image personnalisée pour acheter
		- bouton_paypal_souscrire:       URL de l'image personnalisée pour s'abonner
		- bouton_paypal_donner:          URL de l'image personnalisée pour donner
		# pour avoir un input classique, il faut renseigner le paramètre 'xxx_texte'
		- bouton_paypal_acheter_texte:   Texte du bouton acheter
		- bouton_paypal_souscrire_texte: Texte du bouton d'abonnement
		- bouton_paypal_donner_texte:    Texte du bouton faire un don
		- bouton_paypal_acheter_class:   Classe du bouton acheter
		- bouton_paypal_souscrire_class: Classe du bouton d'abonnement
		- bouton_paypal_donner_class:    Classe du bouton faire un don

		# Personnaliser la page Paypal
		- logo_url               URL du logo affiché en haut à gauche, 150x150px max (de préférence https)
		- bandeau_url            URL de l'image affichée en haut à gauche, 750x90px max (de préférence https)
		- couleur_bandeau        Couleur de fond du bandeau : code hexa 6 caractères
		- couleur_bloc           Couleur de fond du bloc de paiement : code hexa 6 caractères
		- cbt                    texte du bouton permettant le retour sur le site du vendeur une fois le paiement effectué
]
<div class="formulaire_spip formulaire_paypal">

[(#REM) URL de soumission : défini dans la fonction charger d'après une constante + configuration du plugin ]
<form action="[(#ENV{soumission})]" method="post"><div class="boutons">

[(#REM) Qui vend ? = adresse email du compte paypal du vendeur, définie dans la fonction charger d'après la configuration du plugin ]
<input name="business" type="hidden" value="[(#ENV{identifiant_vendeur})]" />

[(#REM) Quelle devise ? Défini dans la fonction charger d'après la configuration du plugin ]
<input name="currency_code" type="hidden" value="[(#ENV{currency_code})]" />

[(#REM) Frais d'envoi ? ]
<input name="shipping" type="hidden" value="#ENV{shipping,0.00}" />
[<input name="handling_cart" type="hidden" value="(#ENV{handling_cart})" />]

[(#REM) Informations de facturation
        Sert à pré-remplir les champs du formulaire d'inscription sur le site paypal si l'acheteur n'est pas connecté ]
[<input type="hidden" name="email" value="(#ENV{email})" />]
[<input type="hidden" name="first_name" value="(#ENV{first_name})" />]
[<input type="hidden" name="last_name" value="(#ENV{last_name})" />]
[<input type="hidden" name="address1" value="(#ENV{address1})" />]
[<input type="hidden" name="address2" value="(#ENV{address2})" />]
[<input type="hidden" name="city" value="(#ENV{city})" />]
[<input type="hidden" name="zip" value="(#ENV{zip})" />]
[<input type="hidden" name="country" value="(#ENV{country})" />]
[<input type="hidden" name="night_phone_b" value="(#ENV{night_phone_b})" />]

[(#REM) Adresse de livraison ?
	0 : on demande, mais pas obligatoire
	1 : pas demande
	2 : obligatoire.
]
<input name="no_shipping" type="hidden" value="#ENV{no_shipping,1}" />

[(#REM) URLS de traitement ]

<input name="return" type="hidden" value="[(#ENV{redirect_ok})]" />
<input name="cancel_return" type="hidden" value="[(#SELF|url_absolue)]" />
<input name="shopping_url" type="hidden" value="#ENV{shopping_url, #URL_SITE_SPIP}" />
[(#REM) Un ping est fait sur cette url en cas de traitement ok, avec des parametres envoyes
		  Les parametres id_auteur et invoice ne servent a priori a rien car ils ne sont traites nulle part au retour ]
<input name="notify_url" type="hidden" value="[(#URL_ACTION_AUTEUR{paypal_ipn,[(#SESSION{id_auteur})-#ENV{invoice, #ENV{identifiant}}]})]" />

[(#REM) On ecrit dans quelle langue ? ]
<input name="lc" type="hidden" value="#LANG" />
<input name="charset" type="hidden" value="utf-8" />

[(#REM) Le bouton et son type ]


[(#REM) C'est quoi qu'on achete ? ]
[<input name="item_name" type="hidden" value="(#ENV{libelle})" />]
[<input name="custom" type="hidden" value="(#ENV{custom})" />]
[<input name="invoice" type="hidden" value="(#ENV{invoice, #ENV{identifiant}})" />]

[(#REM) Avoir les details ]
[(#ENV{details}|et{#ENV{type}|=={abonnement}|non}|oui) 
	#INCLURE{fond=formulaires/inc-paypal-details,details=#ENV{details}}
	<input type="hidden" name="cmd" value="_cart" /> 
	<input type="hidden" name="upload" value="1" />
	[(#REM) Bouton...]
	[(#REM) Soit le bouton est une image - par défaut ]
	[(#ENV{bouton_paypal_acheter_texte}|non)<input type="image" name="submit" alt="<:paypal:info_bouton_paypal:>" src="[(#ENV{bouton_paypal_acheter}|sinon{https://www.paypal.com/fr_FR/FR/i/btn/btn_buynow_LG.gif})]" />]
	[(#REM) Soit il s'agit d'un bouton traditionnel ]
	[(#ENV{bouton_paypal_acheter_texte}|oui)<input type="submit" name="submit" alt="[(#ENV{bouton_paypal_acheter_texte})]" value="[(#ENV{bouton_paypal_acheter_texte})]"[ class="(#ENV{bouton_paypal_acheter_class})"] />]
	<img src="https://www.paypal.com/fr_FR/i/scr/pixel.gif" border="0" alt="" width="1" height="1" />
]

[(#REM) Acheter ]
[(#ENV{type}|=={abonnement}|non|et{#ENV{details}|non})
[(#ENV{type}|=={donner}|non)
	[(#REM) Prix/Produit ]
	<input name="amount" type="hidden" value="#ENV{prix}" />
	[(#REM) commentaires possibles ? 1 : non, 0 : oui ]
	<input name="no_note" type="hidden" value="1" />
	[(#REM) Bouton...]
	<input name="cmd" type="hidden" value="_xclick" />
	<input name="bn" type="hidden" value="PP-BuyNow" />
	[(#REM) Soit le bouton est une image - par défaut ]
	[(#ENV{bouton_paypal_acheter_texte}|non)<input type="image" name="submit" alt="<:paypal:info_bouton_paypal:>" src="[(#ENV{bouton_paypal_acheter}|sinon{https://www.paypal.com/fr_FR/FR/i/btn/btn_buynow_LG.gif})]" />]
	[(#REM) Soit il s'agit d'un bouton traditionnel ]
	[(#ENV{bouton_paypal_acheter_texte}|oui)<input type="submit" name="submit" alt="[(#ENV{bouton_paypal_acheter_texte})]"  value="[(#ENV{bouton_paypal_acheter_texte})]"[ class="(#ENV{bouton_paypal_acheter_class})"] />]
	<img src="https://www.paypal.com/fr_FR/i/scr/pixel.gif" border="0" alt="" width="1" height="1" />
]]

[(#REM) Ou s'abonner ]
[(#ENV{type}|=={abonnement}|oui|et{#ENV{details}|non})	
	[(#REM) Prix/Abonnement ]
	<input name="a3" type="hidden" value="#ENV{prix}" />
	<input name="p3" type="hidden" value="#ENV{duree}" />
	<input name="t3" type="hidden" value="#ENV{periode}" />
	[(#REM) commentaires toujours a non pour les souscriptions ]
	<input name="no_note" type="hidden" value="1" />
	[(#REM) Bouton...]
	<input name="cmd" type="hidden" value="_xclick-subscriptions" />
	<input name="bn" type="hidden" value="PP-Subscribe" />
	[(#REM) Soit le bouton est une image - par défaut ]
	[(#ENV{bouton_paypal_souscrire_texte}|non)<input type="image" name="submit" alt="<:paypal:info_bouton_paypal:>" src="[(#ENV{bouton_paypal_souscrire}|sinon{https://www.paypal.com/fr_FR/FR/i/btn/btn_subscribe_LG.gif})]" />]
	[(#REM) Soit il s'agit d'un bouton traditionnel ]
	[(#ENV{bouton_paypal_souscrire_texte}|oui)<input type="submit" name="submit" alt="[(#ENV{bouton_paypal_souscrire_texte})]"  value="[(#ENV{bouton_paypal_souscrire_texte})]"[ class="(#ENV{bouton_paypal_souscrire_class})"] />]
	<img src="https://www.paypal.com/fr_FR/i/scr/pixel.gif" border="0" alt="" width="1" height="1" />
]
    

[(#REM) Ou donner ]
[(#ENV{type}|=={donner}|oui|et{#ENV{details}|non})
	[(#REM) Prix/Produit facultatif]
	[<input name="amount" type="hidden" value="(#ENV{prix})" />]
	[(#REM) commentaires possibles ? 1 : non, 0 : oui ]
	<input name="no_note" type="hidden" value="1" />
	[(#REM) Bouton...]
	<input name="cmd" type="hidden" value="_donations" />	
	[(#REM) Soit le bouton est une image - par défaut ]
	[(#ENV{bouton_paypal_donner_texte}|non)<input type="image" name="submit" alt="<:paypal:info_bouton_paypal:>" src="[(#ENV{bouton_paypal_donner}|sinon{https://www.paypal.com/fr_FR/FR/i/btn/btn_donate_LG.gif})]" />]
	[(#REM) Soit il s'agit d'un bouton traditionnel ]
	[(#ENV{bouton_paypal_donner_texte}|oui)<input type="submit" name="submit" alt="[(#ENV{bouton_paypal_donner_texte})]"  value="[(#ENV{bouton_paypal_donner_texte})]"[ class="(#ENV{bouton_paypal_donner_class})"] />]
	<img src="https://www.paypal.com/fr_FR/i/scr/pixel.gif" border="0" alt="" width="1" height="1" />
]

[(#REM) Personnaliser la page de paiement ]

[(#REM) Logo du vendeur affiché en haut à gauche à la place du nom, 150x150px max. De préférence URL https  ]
[<input name="image_url" type="hidden" value="(#ENV{logo_url})" />]
[(#REM) Image affichée en haut à gauche de la page de paiement, 750x90px max. De préférence URL https ]
[<input name="cpp_header_image" type="hidden" value="(#ENV{bandeau_url})" />]
[(#REM) Couleur de fond du bandeau : code hexa 6 caractères ]
[<input name="cpp_headerback_color" type="hidden" value="(#ENV{couleur_bandeau})" />]
[(#REM) Couleur de fond du bloc de paiement : code hexa 6 caractères ]
[<input name="cpp_payflow_color" type="hidden" value="(#ENV{couleur_bloc})" />]
[(#REM) Texte du bouton permettant le retour sur le site du vendeur une fois le paiement effectué ]
[<input name="cbt" type="hidden" value="(#ENV{texte_bouton_continuer})" />]


</div></form>

</div>
