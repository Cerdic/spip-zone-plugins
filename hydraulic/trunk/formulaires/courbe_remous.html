[<div class='hyd_formulaire_erreur '><span>(#ENV*{message_erreur})</span></div>]

<script language="javascript" type="text/javascript" src="#CHEMIN{js/hyd_fonctions.js}"></script>
<script>
	//Permet d'afficher ou cacher les champs correspondant à une section.
	function afficher_cacher() {
		var section = getSelectValue('choix_section_cr');
		// On récupère tous le formulaire
		var f = document.getElementById("form_courbe_remous");
		if(f) {
			// On récupère seulement les lignes <tr> du formulaire stocké dans f
			var champs = f.getElementsByTagName("tr");
			// On parcourt tous les <tr> du formulaire
			for(var i=0, n=champs.length; i<n; i++) {
				// Si le champ appartient à la section choisis , alors on l'affiche.
				if((champs[i].getAttribute("id") != null) &&((champs[i].getAttribute("id")).substr(0,2) == section)){
					document.getElementById((champs[i].getAttribute("id"))).style.display='table-row';
				}
				// Sinon si il appartient aux autres sections, alors on le masque
				else if((champs[i].getAttribute("id") != null) &&((champs[i].getAttribute("id")).substr(0,1) == 'F')) {
					document.getElementById((champs[i].getAttribute("id"))).style.display='none';
				}
			}
		}
	}
</script>
<div class="formulaire_spip form_courbe_remous">
	<form method="post" action="#ENV{action}#VAL{#resultat_courbe_remous}" id="form_courbe_remous">
		#ACTION_FORMULAIRE{#ENV{action}}
		<table class="hyd_formulaire">
			<tbody>
				<tr id="type_section_field_cr">
					<td colspan="2"><div class="hyd_formulaire_chapitre"><:hydraulic:type_section:></div></td>
				</tr>

				<tr id="type_section_choix_cr">
					<td align="right">
						<:hydraulic:choix_section:>
					</td>

					<!-- On génére les options du select, correspondant aux types de section -->
					<td>
						<select name="crTypeSection" id="choix_section_cr" onChange="afficher_cacher();">
							<BOUCLE_selectOptions(POUR){tableau #ENV{mes_saisies}}>
								#SET{test, #VALEUR|table_valeur{0}|decoupeIdSection}
								<BOUCLE_choixSection(CONDITION){si #CLE|substr{0,1}|== {'F'}}>
									<option value="#CLE" [(#ENV{crTypeSection}|=={#CLE}|?{'selected',''})]>#GET{test}</option>
								</BOUCLE_choixSection>
							</BOUCLE_selectOptions>
						</select>

						[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{[(#VALEUR|table_valeur{0})]})</div>]
					</td>

				</tr>

				<BOUCLE_fieldChamps(POUR){tableau #ENV{mes_saisies}}>

					#SET{id_fieldset, #CLE}

					<!-- Fieldset des champs-->
					<tr id="#GET{id_fieldset}_field" style="display:[(#CLE|match{^([(#ENV{crTypeSection})]|c_bief|Cond_lim|Param_calc)$}|?{'table-row','none'})];">
						<td colspan="2"><div class="hyd_formulaire_chapitre">[(#VALEUR|table_valeur{0}|traduction_hydraulic)]</div></td>
					</tr>

					<BOUCLE_champsLib(POUR){tableau (#VALEUR|table_valeur{1})}>

						<!-- Tous les champs d'un seul fieldset -->
						<tr id="#GET{id_fieldset}_[(#CLE)]" style="display:[(#GET{id_fieldset}|match{^([(#ENV{crTypeSection})]|c_bief|Cond_lim|Param_calc)$}|?{'table-row','none'})];" [(#ENV**{erreurs}|table_valeur{#GET{id_fieldset}_[(#CLE)]}|oui) class="hyd_erreur"]>
							<td align="right" width="65%">
								[(#VALEUR|table_valeur{0}|traduction_hydraulic)]
							</td>

							<td width="35%" >
								[<span class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{#GET{id_fieldset}_[(#CLE)]})</span>]
								<input type="text" value="[(#ENV{#GET{id_fieldset}_[(#CLE)]})]" maxlength="30" name="#GET{id_fieldset}_[(#CLE)]">
							</td>

						</tr>

					</BOUCLE_champsLib>

				</BOUCLE_fieldChamps>
				<tr>
					<td align="right">
						<:hydraulic:choix_resolution:>
					</td>

					<!-- On génére les options du select, correspondant aux types de section -->
					<td>
						[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{choix_resolution})</div>]
						<select name="choix_resolution" id="choix_resolution">
							<option value="Trapez" [(#ENV{choix_resolution}|=={Trapez}|?{'selected',''})]>
								<:hydraulic:integration_trapez:>
							</option>
							<option value="RK4" [(#ENV{choix_resolution}|=={RK4}|?{'selected',''})]>
								<:hydraulic:runge_kutta:>
							</option>
							<option value="Euler" [(#ENV{choix_resolution}|=={Euler}|?{'selected',''})]>
								<:hydraulic:euler_explicite:>
							</option>
						</select>
					</td>
				</tr>

				<tr>
					<td colspan="2" class="hyd_bouton_submit">
						<input type="submit" value="<:hydraulic:calculer_remous:>">
					</td>
				</tr>

			</tbody>
		</table>
	</form>
</div>
[<div id="hyd_resultat">(#ENV*{message_ok})</div>]
