[<div class='hyd_formulaire_erreur '><span>(#ENV*{message_erreur})</span></div>]

<script language="javascript" type="text/javascript" src="#CHEMIN{js/hyd_fonctions.js}"></script>
<script>
	/**
	 * La plupart des commentaires sont les mêmes que pour la page lechapt_calmon.html
	 */

	// Choix de l'ouvrage
	var globSelectOuv = 'vRect';
	var glob = [];

	function initGlob(){
		<BOUCLE_globChOuv(POUR){tableau #ENV{OuvrageCaract}}>
			glob['#CLE'] = '#ENV{choix_champs_#CLE}';
		</BOUCLE_globChOuv>

		<BOUCLE_globSurverse(POUR){tableau #ENV{surverse}}>
			<BOUCLE_pasLoiDeb(CONDITION){si #CLE|!= {'loi_debit'}}>
				glob['#CLE'] = '#ENV{choix_champs_#CLE}';
			</BOUCLE_pasLoiDeb>
		</BOUCLE_globSurverse>

		<BOUCLE_globCaractFixes(POUR){tableau #ENV{caract_fixes}}>
			#SET{caractFixes, #VALEUR|table_valeur{1}}
			<BOUCLE_siCaractFixes(CONDITION){si #VALEUR|table_valeur{0}|== {'caract_globale'}}>
				<BOUCLE_Fixes(POUR){tableau #GET{caractFixes}}>
					glob['#CLE'] = '#ENV{choix_champs_#CLE}';
				</BOUCLE_Fixes>
			</BOUCLE_siCaractFixes>
		</BOUCLE_globCaractFixes>
	}

	initGlob();
	function setVarGlob(){
		globSelectOuv = getSelectValue('choix_ouvrage');
		for(var i in glob){
			glob[i] = getRadioValue('choix_champs_'+i);
		}
	}

	function inArray(array, p_val) {
		var l = array.length;
		for(var i = 0; i < l; i++) {
			if(array[i] == p_val) {
				return true;
			}
		}
		return false;
	}

	// Retourne sous forme de tableau tous les élèments de la Class classe et de type tagName
	function elementsParClasse(classe, tagName) {
		var divs = document.getElementsByTagName(tagName);
		var resultats = new Array();
		for(var i=0; i<divs.length; i++){
			if(divs[i].className == classe){
				resultats.push(divs[i]);
			}
		}
		return resultats;
	}

	function retourneIndiceSuivant(tabIndice, nom) {
		var indice = '';
		for(var i = 0; i < tabIndice.length; i++){
			if(tabIndice[i] == nom){
				// Si on est pas arrivé au dernier élément
				if(i+1 <= tabIndice.length-1){
					indice = tabIndice[i+1];
				}
				else{
					indice = tabIndice[0];
				}
			}
		}
		return indice;
	}

	function affichageEtValeur() {
		afficher_cacher_champs_select();
		afficher_cacher_champs_ouv();
		afficher_cacher_surverse();
	}

	function afficher_cacher_champs_select() {
		setVarGlob();
		var tabAfficher = [];

		<BOUCLE_tabS(POUR){tableau #ENV{mes_saisies}}>
		if(globSelectOuv == '#CLE'){
			<BOUCLE_tabS2(POUR){tableau #VALEUR|table_valeur{2}}>
			tabAfficher.push([(#VALEUR|table_valeur{0})]);
			</BOUCLE_tabS2>
		}
		</BOUCLE_tabS>

		var bSel = false;
		var ch_equaQ = document.getElementById("choix_equation_debit");
		for(var i = 0; i < ch_equaQ.length; i++){
			ch_equaQ.options[i].style.display="none";
			ch_equaQ.options[i].selected=false;
			for(var j = 0; j < tabAfficher.length; j++){
				if(tabAfficher[j] == ch_equaQ.options[i].value) {
					ch_equaQ.options[i].style.display="list-item";
					if(!bSel) {
						bSel = true;
						ch_equaQ.options[i].selected=true;
					}
				}
			}
		}
	}

	function afficher_cacher_champs_ouv() {

		for(var i in glob){
			if(document.getElementById('varier_val_'+i).checked){
				var cacher = elementsParClasse('champs_var_'+i, 'tr');
				for(var j in cacher){
					cacher[j].style.display='none';
				}
				document.getElementById('val_fixe_'+i).checked=true;
				document.getElementById('caract_'+i).disabled=false;
			}
			if(document.getElementById('calcul_val_'+i).checked){
				document.getElementById('val_fixe_'+i).checked=true;
			}
		}

		<BOUCLE_initGlob(POUR){tableau #ENV{mes_saisies}}>
			<BOUCLE_initGlob1(POUR){tableau #VALEUR|table_valeur{1}}>
				#SET{compteur, #COMPTEUR_BOUCLE}
				<BOUCLE_premiereVal(CONDITION){si #GET{compteur}|== {1}}>
					document.getElementById('calcul_val_#CLE').checked=true;
				</BOUCLE_premiereVal>
					document.getElementById('val_fixe_#CLE').checked=true;
				<//B_premiereVal>
			</BOUCLE_initGlob1>
		</BOUCLE_initGlob>

		var tabOuvrageAfficher = [];
		var tabOuvrageCacher = [];

		<BOUCLE_remplisTabOuv(POUR) {tableau #ENV{mes_saisies}}>
			if(globSelectOuv == '#CLE'){
				<BOUCLE_remplisTabOuv2(POUR) {tableau #VALEUR|table_valeur{1}}>
					tabOuvrageAfficher.push('#CLE');
				</BOUCLE_remplisTabOuv2>
			}
		</BOUCLE_remplisTabOuv>

		<BOUCLE_libEquat(POUR){tableau #ENV{OuvrageCaract}}>
			tabOuvrageCacher.push('#CLE');
		</BOUCLE_libEquat>

		for(var i in tabOuvrageCacher){
			document.getElementById('ouvrage_'+tabOuvrageCacher[i]).style.display='none';
		}

		for(var i in tabOuvrageAfficher){
			document.getElementById('ouvrage_'+tabOuvrageAfficher[i]).style.display='table-row';
		}

	}

	function afficher_cacher_surverse() {
		setVarGlob();
		var tabAffSurv = [];

		<BOUCLE_vanne1(POUR){tableau #ENV{mes_saisies}}>
			#SET{afficherVanne, #VALEUR|table_valeur{1}}
			<BOUCLE_vanne2(CONDITION){si #VALEUR|table_valeur{0}|substr{0,5}|== {'vanne'}}>
				tabAffSurv.push('#CLE');
			</BOUCLE_vanne2>
		</BOUCLE_vanne1>

		// Afficher ou cacher le fieldset + la case a cocher si cest pas une vanne
		if(tabAffSurv.indexOf(globSelectOuv) !== -1){
			document.getElementById("surverseField").style.display='table-row';
			document.getElementById("SurverseEnabled").style.display='table-row';

		}
		else{
			document.getElementById("surverseField").style.display='none';
			document.getElementById("SurverseEnabled").style.display='none';
			document.getElementById("affSurverse").checked=false;
		}

		var f = document.getElementById("form_calcul_ouvrages");
		if(f) {
			var champs = f.getElementsByTagName("tr");
			for(var i=0, n=champs.length; i<n; i++) {
				if(champs[i].getAttribute("id") !== null && champs[i].getAttribute("id").indexOf('field_surverse',0) !== -1 && document.getElementById("affSurverse").checked){
					document.getElementById(champs[i].getAttribute("id")).style.display="table-row";
					document.getElementById('loi_debit_surverse').style.display="table-row";
				}
				else if(champs[i].getAttribute("id") !== null && champs[i].getAttribute("id").indexOf('field_surverse',0) !== -1 && !document.getElementById("affSurverse").checked){
					document.getElementById(champs[i].getAttribute("id")).style.display="none";
					document.getElementById('loi_debit_surverse').style.display="none";
				}
			}
		}
	}

	// Gére le comportement des boutons radios
	function gestion_radios(nom,valeur) {
		tabPartiel = [];
		tabIndice = [];

		<BOUCLE_chOuv(POUR){tableau #ENV{mes_saisies}}>
			if(globSelectOuv == '#CLE'){
				<BOUCLE_chOuv2(POUR){tableau #VALEUR|table_valeur{1}}>
					tabPartiel['#CLE'] = '#ENV{choix_champs_#CLE}';
					tabIndice.push('#CLE');
				</BOUCLE_chOuv2>
			}
		</BOUCLE_chOuv>

		if(document.getElementById('affSurverse').checked){
			<BOUCLE_surverseCoche(POUR){tableau #ENV{surverse}}>
				<BOUCLE_pasLoi(CONDITION){si #CLE|!= {'loi_debit'}}>
					tabPartiel['#CLE'] = '#ENV{choix_champs_#CLE}';
					tabIndice.push('#CLE');
				</BOUCLE_pasLoi>
			</BOUCLE_surverseCoche>
		}

		<BOUCLE_globCaractFixes2(POUR){tableau #ENV{caract_fixes}}>
			#SET{caractFixes2, #VALEUR|table_valeur{1}}
			<BOUCLE_siCaractFixes2(CONDITION){si #VALEUR|table_valeur{0}|== {'caract_globale'}}>
				<BOUCLE_Fixes2(POUR){tableau #GET{caractFixes2}}>
					tabPartiel['#CLE'] = '#ENV{choix_champs_#CLE}';
					tabIndice.push('#CLE');
				</BOUCLE_Fixes2>
			</BOUCLE_siCaractFixes2>
		</BOUCLE_globCaractFixes2>

		// On supprime du tableau l'élément sur lequel on a cliqué
		delete(tabPartiel[nom]);

		if(valeur.substr(0,3) == 'cal'){
			document.getElementById('caract_'+nom).disabled=false;
			for(var cle in tabPartiel){
				if(document.getElementById('calcul_val_'+cle).checked){
					document.getElementById('val_fixe_'+cle).checked=true;
					setVarGlob();
				}
			}
		}

		// Si on appuit sur un bouton de type "varier_val" ou "val_fixe"
		else if(valeur.substr(0,3) == 'var' || valeur.substr(0,3)=='val'){
			for(var cle in tabPartiel){
				if(document.getElementById('varier_val_'+cle).checked && (glob[nom] != "calcul_val_"+nom)){
					if(document.getElementById('varier_val_'+nom).checked){
						document.getElementById('val_fixe_'+cle).checked=true;
						document.getElementById('caract_'+nom).disabled=true;
					}
					setVarGlob();
				}
				else if(document.getElementById('varier_val_'+cle).checked && (glob[nom] == "calcul_val_"+nom) && valeur.substr(0,3) == 'var'){
					document.getElementById('calcul_val_'+cle).checked=true;
					document.getElementById('caract_'+cle).disabled=false;
					setVarGlob();
				}
			}

			// Compte le nombre de calcul_val checké
			var cptValCal = 0;
			for(var cle in glob){
				if(inArray(tabIndice, cle)){
					if(document.getElementById('calcul_val_'+cle).checked){
						cptValCal++;
					}
				}
			}
			// Si aucune calcul_val n'est checké
			if(cptValCal == 0){
				// Alors on chercher l'indice suivant...
				indice = '';
				for(var i = 0; i < tabIndice.length; i++){
					if(tabIndice[i] == nom){
						// Si on est pas arrivé au dernier élément
						if(i+1 <= tabIndice.length-1){
							indice = tabIndice[i+1];
						}
						else{
							indice = tabIndice[0];
						}
					}
				}
				// ... et on le met a calcul_val
				document.getElementById('calcul_val_'+indice).checked=true;
				document.getElementById('caract_'+indice).disabled=false;
				document.getElementById('caract_'+nom).disabled=false;
				var cacher = elementsParClasse('champs_var_'+indice, 'tr');
				for(var i in cacher){
					cacher[i].style.display='none';
				}
				setVarGlob();
			}
		}

		// Si on appuis sur un bouton de type varier_val
		if(valeur.substr(0,3) == 'var'){
			setVarGlob();
			document.getElementById('caract_'+nom).disabled=true;
			for(var cle in glob){
				if(inArray(tabIndice, cle)){
					if(glob[cle].substr(0,3) == 'val'){
						document.getElementById('caract_'+cle).disabled=false;
					}
				}
			}

			// on affiche les champs correspondant au bouton sélectionné
			var afficher = elementsParClasse('champs_var_'+nom, 'tr');
			for(var i in afficher){
				afficher[i].style.display='table-row';
			}
			// On cache tous les autres champs de variations.
			for(var cle in tabPartiel){
				var cacher = elementsParClasse('champs_var_'+cle, 'tr');
				for(var i in cacher){
					cacher[i].style.display='none';
				}
			}

			setVarGlob();
		}

		// Compte le nombre de varier_val checké
		var cptVarVal = 0;
		for(var cle in glob){
			if(inArray(tabIndice, cle)){
				if(document.getElementById('varier_val_'+cle).checked){
					cptVarVal++;
				}
			}
		}

		if(cptVarVal == 0){
			for(var cle in glob){
				if(inArray(tabIndice, cle)){
					if(glob[cle].substr(0,3) != 'cal'){
						document.getElementById('caract_'+cle).disabled=false;
					}
				}
			}
			var cacher = elementsParClasse('champs_var_'+nom, 'tr');
			for(var i in cacher){
				cacher[i].style.display='none';
			}
		}

		setVarGlob();
	}

</script>

<form method="post" action="#ENV{action}#VAL{#hyd_resultat}" id="form_calcul_ouvrages">
	#ACTION_FORMULAIRE{#ENV{action}}
	<table class="hyd_formulaire">
		<tbody>

			<tr id="ch_ouvrage_field">
				<td colspan="5"><div class="hyd_formulaire_chapitre"><:hydraulic:type_ouvrage:></div></td>
			</tr>

			<tr id="type_ouvrage">
				<td align="right" width="30%">
					<:hydraulic:choix_ouvrage:> :
				</td>

				<td colspan="4" width="70%">
					<select name="OuvrageType" id="choix_ouvrage" onChange="affichageEtValeur()">
						<BOUCLE_OuvrageTypes(POUR){tableau #ENV{mes_saisies}}>
							<option value="#CLE" [(#ENV{OuvrageType}|=={#CLE}|?{'selected',''})]>[(#VALEUR|table_valeur{0}|traduction_hydraulic)]</option>
						</BOUCLE_OuvrageTypes>
					</select>

					[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{[(#VALEUR|table_valeur{0})]})</div>]
				</td>

			</tr>

			<tr id="equation_debit">
				<td align="right" width="30%">
					<:hydraulic:loi_debit:> :
				</td>

				<td colspan="4" width="70%">
					<select name="OuvrageLoi" id="choix_equation_debit">
						<BOUCLE_choixEquat(POUR){tableau #ENV{numLoi}}>
							#SET{numLoi, #CLE}
							<BOUCLE_tabMesSaisies(POUR){tableau #ENV{mes_saisies}}>
								#SET{val2-0, #VALEUR|table_valeur{2}}
								<BOUCLE_conditionAff(CONDITION){si #ENV{OuvrageType}|=={#CLE}}>
									<BOUCLE_tabMesSaisies2(POUR){tableau #GET{val2-0}}>
										<BOUCLE_numeroLoi(CONDITION){si #GET{numLoi}|=={#VALEUR|table_valeur{0}}}>
											#SET{affichage, #GET{numLoi}}
										</BOUCLE_numeroLoi>
									</BOUCLE_tabMesSaisies2>
								</BOUCLE_conditionAff>
							</BOUCLE_tabMesSaisies>
							<option value="#CLE" [(#ENV{OuvrageLoi}|=={#CLE}|?{'selected',''})] style="display: [(#CLE|=={#GET{affichage}}|?{'list-item','none'})]">[(#VALEUR|traduction_hydraulic)]</option>
						</BOUCLE_choixEquat>
					</select>

					[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{[(#VALEUR|table_valeur{0})]})</div>]
				</td>
			</tr>

			<tr id="caract_ouvrages">
				<td colspan="5"><div class="hyd_formulaire_chapitre"><:hydraulic:caract_ouvrages:></div></td>
			</tr>

			<tr>
				<td colspan="2"></td>
				<td align="center"><:hydraulic:calcul_val:></td>
				<td align="center"><:hydraulic:varier_val:></td>
				<td align="center"><:hydraulic:fixer_val:></td>
			</tr>


			<BOUCLE_caract(POUR) {tableau #ENV{OuvrageCaract}}>
				#SET{cleLibOuv, #CLE}
				<BOUCLE_tableauSaisies(POUR){tableau #ENV{mes_saisies}}>
					#SET{ident_cle_field, #CLE}
					<BOUCLE_tableauSaisies2(POUR){tableau #VALEUR|table_valeur{1}}>
						#SET{cleValeur, #CLE}
						<BOUCLE_condLib(CONDITION){si #ENV{OuvrageType}|=={#GET{ident_cle_field}}}>
							<BOUCLE_condLib2(CONDITION){si #GET{cleValeur}|=={#GET{cleLibOuv}}}>
								#SET{afficher_cle, #CLE}
							</BOUCLE_condLib2>
						</BOUCLE_condLib>
					</BOUCLE_tableauSaisies2>
				</BOUCLE_tableauSaisies>

				<tr id="ouvrage_#CLE" style="display: [(#GET{afficher_cle}|=={#CLE}|?{'table-row','none'})]">
					<td align="right">
						[(#VALEUR|table_valeur{0}|traduction_hydraulic)] :
					</td>

					<td>
						<input id="caract_#CLE" type="text" value="#ENV{#CLE}" maxlength="30" name="#CLE"/>
						[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{#CLE})</div>]
					</td>

					<td align="center">
						<input type="radio" id="calcul_val_#CLE" name="choix_champs_#CLE" value="calcul_val_#CLE" onclick="gestion_radios('#CLE', 'calcul_val_#CLE')" [(#ENV{choix_champs_#CLE}|=={calcul_val_#CLE}?{'checked',''})]/>
					</td>

					<td align="center">
						<input type="radio" id="varier_val_#CLE" name="choix_champs_#CLE" value="varier_val_#CLE" onclick="gestion_radios('#CLE', 'varier_val_#CLE')"[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}?{'checked',''})]/>
					</td>

					<td align="center">
						<input type="radio" id="val_fixe_#CLE" name="choix_champs_#CLE" value="val_fixe_#CLE" onclick="gestion_radios('#CLE', 'val_fixe_#CLE')"[(#ENV{choix_champs_#CLE}|=={val_fixe_#CLE}?{'checked',''})]/>
					</td>
				</tr>

				<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
					<td colspan="3" align="right"><:hydraulic:val_min:> : </td>
					<td colspan="2">
						<input name="val_min_#CLE" type="text" value="#ENV{val_min_#CLE}"/>
						[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{val_min_#CLE})</div>]
					</td>
				</tr>

				<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
					<td colspan="3" align="right"><:hydraulic:val_max:> :</td>
					<td colspan="2">
						<input name="val_max_#CLE" type="text" value="#ENV{val_max_#CLE}"/>
						[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{val_max_#CLE})</div>]
					</td>
				</tr>

				<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
					<td colspan="3" align="right"><:hydraulic:pas_var:> :</td>
					<td colspan="2">
						<input name="pas_var_#CLE" type="text" value="#ENV{pas_var_#CLE}"/>
						[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{pas_var_#CLE})</div>]
					</td>
				</tr>

			</BOUCLE_caract>
			<tr id="surverseField" style="display: [(#ENV{OuvrageType}|match{^(vRect|vCirc|vTrap)$}|?{'table-row', 'none'})]">
				<td colspan="5"><div class="hyd_formulaire_chapitre"><:hydraulic:surverse:></div></td>
			</tr>

			<tr id="SurverseEnabled" style="display: [(#ENV{OuvrageType}|match{^(vRect|vCirc|vTrap)$}|?{'table-row', 'none'})]">
				<td align="right">
					<:hydraulic:surverse:> :
				</td>
				<td>
					<input type="checkbox" id="affSurverse" name="SurverseEnabled" onclick="afficher_cacher_surverse()" [(#ENV{SurverseEnabled}|=={'on'}|?{'checked', ''})]/>
					[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{[(#VALEUR|table_valeur{0})]})</div>]
				</td>
			</tr>

			<tr id="loi_debit_surverse" style="display:[(#ENV{SurverseEnabled}|=={'on'}|?{'table-row','none'})];">
				<td align="right" width="30%">
					<:hydraulic:loi_debit:> :
				</td>

				<td colspan="4" width="70%">

					<select name="SurverseLoi" id="choix_surverse">
						<BOUCLE_champsNSurverse(POUR){tableau #ENV{surverse}}>
							#SET{tabV2, #VALEUR}
							<BOUCLE_conditionsurv(CONDITION){si #CLE|=={'loi_debit'}}>
								<BOUCLE_champsNSurverse2(POUR){tableau #GET{tabV2}}>
									<option value="[(#VALEUR|table_valeur{0})]" [(#ENV{SurverseLoi}|=={[(#VALEUR|table_valeur{0})]}|?{'selected',''})]>[(#VALEUR|table_valeur{1}|traduction_hydraulic)]</option>
								</BOUCLE_champsNSurverse2>
							</BOUCLE_conditionsurv>
						</BOUCLE_champsNSurverse>
					</select>

					[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{[(#VALEUR|table_valeur{0})]})</div>]
				</td>
			</tr>

			<BOUCLE_champsSurverse(POUR){tableau #ENV{surverse}}>
				<BOUCLE_conditionLDebit(CONDITION){si #CLE|!={'loi_debit'}}>
					<tr id="[(#CLE)]_field_surverse" style="display:[(#ENV{SurverseEnabled}|=={'on'}|?{'table-row','none'})];">
						<td align="right">
							[(#ENV{surverse}|table_valeur{#CLE}|table_valeur{0}|traduction_hydraulic)] :
						</td>

						<td>
							<input id="caract_#CLE" type="text" value="#ENV{#CLE}" maxlength="30" name="#CLE"/>
							[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{#CLE})</div>]
						</td>

						<td align="center">
							<input type="radio" id="calcul_val_#CLE" name="choix_champs_#CLE" value="calcul_val_#CLE" onclick="gestion_radios('#CLE', 'calcul_val_#CLE')" [(#ENV{choix_champs_#CLE}|=={calcul_val_#CLE}?{'checked',''})]/>
						</td>

						<td align="center">
							<input type="radio" id="varier_val_#CLE" name="choix_champs_#CLE" value="varier_val_#CLE" onclick="gestion_radios('#CLE', 'varier_val_#CLE')"[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}?{'checked',''})]/>
						</td>

						<td align="center">
							<input type="radio" id="val_fixe_#CLE" name="choix_champs_#CLE" value="val_fixe_#CLE" onclick="gestion_radios('#CLE', 'val_fixe_#CLE')"[(#ENV{choix_champs_#CLE}|=={val_fixe_#CLE}?{'checked',''})]/>
						</td>
					</tr>

					<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
						<td colspan="3" align="right"><:hydraulic:val_min:> : </td>
						<td colspan="2">
							<input name="val_min_#CLE" type="text" value="#ENV{val_min_#CLE}"/>
							[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{val_min_#CLE})</div>]
						</td>
					</tr>

					<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
						<td colspan="3" align="right"><:hydraulic:val_max:> :</td>
						<td colspan="2">
							<input name="val_max_#CLE" type="text" value="#ENV{val_max_#CLE}"/>
							[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{val_max_#CLE})</div>]
						</td>
					</tr>

					<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
						<td colspan="3" align="right"><:hydraulic:pas_var:> :</td>
						<td colspan="2">
							<input name="pas_var_#CLE" type="text" value="#ENV{pas_var_#CLE}"/>
							[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{pas_var_#CLE})</div>]
						</td>
					</tr>
				</BOUCLE_conditionLDebit>
			</BOUCLE_champsSurverse>

			<BOUCLE_caractFixe(POUR){tableau #ENV{caract_fixes}}>

				<tr id="[(#VALEUR|table_valeur{0})]">
					<td colspan="5"><div class="hyd_formulaire_chapitre">[(#VALEUR|table_valeur{0}|traduction_hydraulic)]</div></td>
				</tr>
				#SET{valFixe2, #VALEUR|table_valeur{1}}
				<BOUCLE_condPasPrec(CONDITION){si #VALEUR|table_valeur{0}|!= {'param_calcul'}}>
					<BOUCLE_caractFixe2(POUR){tableau #GET{valFixe2}}>
						<tr id="ouvrage_#CLE">
							<td align="right">
								[(#VALEUR|table_valeur{0}|traduction_hydraulic)] :
							</td>

							<td>
								<input id="caract_#CLE" type="text" value="#ENV{#CLE}" maxlength="30" name="#CLE"/>
								[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{#CLE})</div>]
							</td>

							<td align="center">
								<input type="radio" id="calcul_val_#CLE" name="choix_champs_#CLE" value="calcul_val_#CLE" onclick="gestion_radios('#CLE', 'calcul_val_#CLE')" [(#ENV{choix_champs_#CLE}|=={calcul_val_#CLE}?{'checked',''})]/>
							</td>

							<td align="center">
								<input type="radio" id="varier_val_#CLE" name="choix_champs_#CLE" value="varier_val_#CLE" onclick="gestion_radios('#CLE', 'varier_val_#CLE')"[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}?{'checked',''})]/>
							</td>

							<td align="center">
								<input type="radio" id="val_fixe_#CLE" name="choix_champs_#CLE" value="val_fixe_#CLE" onclick="gestion_radios('#CLE', 'val_fixe_#CLE')"[(#ENV{choix_champs_#CLE}|=={val_fixe_#CLE}?{'checked',''})]/>
							</td>
						</tr>

						<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
							<td colspan="3" align="right"><:hydraulic:val_min:> : </td>
							<td colspan="2">
								<input name="val_min_#CLE" type="text" value="#ENV{val_min_#CLE}"/>
								[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{val_min_#CLE})</div>]
							</td>
						</tr>

						<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
							<td colspan="3" align="right"><:hydraulic:val_max:> :</td>
							<td colspan="2">
								<input name="val_max_#CLE" type="text" value="#ENV{val_max_#CLE}"/>
								[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{val_max_#CLE})</div>]
							</td>
						</tr>

						<tr class="champs_var_#CLE" style="display:[(#ENV{choix_champs_#CLE}|=={varier_val_#CLE}|?{'table-row','none'})];">
							<td colspan="3" align="right"><:hydraulic:pas_var:> :</td>
							<td colspan="2">
								<input name="pas_var_#CLE" type="text" value="#ENV{pas_var_#CLE}"/>
								[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{pas_var_#CLE})</div>]
							</td>
						</tr>
					</BOUCLE_caractFixe2>
				</BOUCLE_condPasPrec>

				<BOUCLE_caractFixe3(POUR){tableau #GET{valFixe2}}>
					<tr id="ouvrage_#CLE">
						<td align="right" width="30%">
							[(#VALEUR|table_valeur{0}|traduction_hydraulic)] :
						</td>

						<td colspan="4" width="70%">
							<input id="caract_#CLE" type="text" value="#ENV{#CLE}" maxlength="30" name="#CLE" [(#ENV{choix_champs_#CLE}|match{^((calcul_val_#CLE)|(varier_val_#CLE))$}|?{'disabled="true"',''})]/>
							[<div class='hyd_erreur'>(#ENV**{erreurs}|table_valeur{#CLE})</div>]
						</td>
					</tr>
				</BOUCLE_caractFixe3>
				<//B_condPasPrec>
			</BOUCLE_caractFixe>

			<tr>
				<td colspan="4" class="hyd_bouton_submit">
					<input type="submit" value="<:hydraulic:calculer:>">
				</td>
			</tr>

		</tbody>
	</table>
</form>

<script>afficher_cacher_champs_select();</script>

[<div id="hyd_resultat">(#ENV*{message_ok})</div>]
