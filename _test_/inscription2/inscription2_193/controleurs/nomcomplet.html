[(#REM)

	Controleur pour le crayon 'nom-complet', uniquement html
	Validation JS pour les champs spécifiés obligatoires
	Si les champs ne sont pas activés dans le CFG, ils n'apparaissent pas...

]
#CACHE{0}
<BOUCLE_b(AUTEURS_ELARGIS){id_auteur=#ENV{id_auteurs_elargi}}{tout}>
[<script type="text/javascript" src="(#URL_PAGE{crayons_validation.js}|parametre_url{lang,#ENV{lang}})"></script>]
<script type="text/javascript">
		
	var me = cQuery(".auteurs_elargi-nomcomplet-#ID_AUTEUR");
	var id = me.crayon().find('form');
	
	function validation(){
		var validator = cQuery(id).validate({
			onkeyup:function(){
				validation();
			},
			showErrors: function(errors, errorList) {
				crayon_affiche_submit(me,id);
				validator.defaultShowErrors();
			},
			errorPlacement: function(error, element) {
				error.appendTo( element.parent("li") );
			},
			success: function(label){
				label.remove();
				crayon_affiche_submit(me,id);
			},
			rules: {
				#ENV{name_nom_famille}: {
					[(#CONFIG{inscription2/nom_famille_obligatoire}|=={on}|?{required: true,}),]
					chaine:true,
					rangelength:[2,30]
				},
				#ENV{name_prenom}: {
					[(#CONFIG{inscription2/prenom_obligatoire}|=={on}|?{required: true,}),]
					chaine:true,
					rangelength:[2,20]
				}
			},
			messages: {
				#ENV{name_nom_famille}: {
					required:"<:inscription2:champ_obligatoire:>",
					chaine:"<:inscription2:chaine_valide:> <:inscription2:chainelettre:>"
				},
				#ENV{name_prenom}: {
					required:"<:inscription2:champ_obligatoire:>",
					chaine:"<:inscription2:chaine_valide:> <:inscription2:chainelettre:>"
				}
			}
		});
		//On ajoute l'asterisque qui signale qu'un champ est obligatoire
		id.find('.obligatoire input').each(function(){
			if(cQuery(this).val() == ""){
				cQuery(this).addClass('error');
				var id_label = cQuery(this).attr('name');
				var label = '<label class="error" generated="true"><:inscription2:champ_obligatoire:></label>';
				cQuery(this).parent("div").append(label);
				cQuery(this).parent("div").find("label.error").show();
				id.find('.crayon-submit').hide();
			}
		});
		//On test le formulaire pour chercher les potentielles erreurs
		validator.form();
		crayon_affiche_submit(me,id);
	}
	//On ajoute l'asterisque qui signale qu'un champ est obligatoire
	id.find('.obligatoire label').not('.error').append('*');
	setTimeout('validation()',500);
</script>
<div class="formulaire_spip">
	<fieldset[ style="(#ENV{style})"]>
		<legend><:inscription2:votre_nom_complet:></legend>
		<ul>
			[(#CONFIG{inscription2/nom_famille}|?{' ',''})
			#SET{nom_famille_obligatoire, false}
			[(#CONFIG{inscription2/nom_famille_obligatoire}|=={on}|?{' ',''})#SET{nom_famille_obligatoire, true}]
			[(#GET{nom_famille_obligatoire}|=={true}|?{<li class="obligatoire">,<li>})]
				<label><:inscription2:nom_famille:></label>
				<input class="crayon-active" name="#ENV{name_nom_famille}" style="width:#ENV{largeur}px;" value="[(#NOM_FAMILLE**|entites_html)]" />
			</li>]
		
			[(#CONFIG{inscription2/prenom}|?{' ',''})
			#SET{prenom_obligatoire, false}
			[(#CONFIG{inscription2/prenom_obligatoire}|=={on}|?{' ',''})#SET{prenom_obligatoire, true}]
			[(#GET{prenom_obligatoire}|=={true}|?{<li class="obligatoire">,<li>})]
				<label><:inscription2:prenom:></label>
				&nbsp;<input class="crayon-active" name="#ENV{name_prenom}" style="width:#ENV{largeur}px;" value="[(#PRENOM**|entites_html)]" />
			</li>]
		</ul>
	</fieldset>
</div>
</BOUCLE_b>
<//B_b>