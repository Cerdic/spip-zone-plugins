[(#REM)

	Controleur pour le crayon 'nom-complet', uniquement html
	Validation JS pour les champs spécifiés obligatoires
	Si les champs ne sont pas activés dans le CFG, ils n'apparaissent pas...

]
#CACHE{0}
<BOUCLE_b(AUTEURS_ELARGIS){id_auteur}{tout}>
<script type="text/javascript" src="#CHEMIN{lib/jquery-validate/jquery.validate.js}"></script>
[(#LANG|=={en}|?{'',' '})
	<script type="text/javascript" src="#CHEMIN{lib/jquery-validate/localization/messages_#LANG.js}"></script>
]
<script type="text/javascript">
/* http://bassistance.de/jquery-plugins/jquery-plugin-validation/ */

	jQuery.validator.addMethod("chaine", function(value, element) {
		return !jQuery.validator.methods.required(value, element) || /^[A-Za-z\-\'\.ÒÁ‡ËÈ‚ÍÓÙ˚ ]+$/.test(value);
	}, "<:inscription2:champ_obligatoire:>, <:inscription2:chaine_valide:>");
	
	var id = cQuery(".auteurs_elargi-nomcomplet-#ID_AUTEUR").crayon();
	id = jQuery(id).find('form');
	
	function validation(){
		var validator = id.validate({
			onkeyup:function(){
				validation();
			},
			showErrors: function(errors, errorList) {
				affiche_submit(id);
				validator.defaultShowErrors();
			},
			errorPlacement: function(error, element) {
				error.appendTo( element.parent("div") );
			},
			success: function(label){
				id.find('label.error').remove();
				affiche_submit(id);
			},
			rules: {
				#ENV{name_nom_famille}: {[(#CONFIG{inscription2/nom_famille_obligatoire}|=={on}|?{required: true,}),]chaine:true, rangeLength:[2,30]},
				#ENV{name_prenom}: {[(#CONFIG{inscription2/prenom_obligatoire}|=={on}|?{required: true,}),]chaine:true, rangeLength:[2,20]}
			},
			messages: {
				#ENV{name_nom_famille}: {
					required:"<:inscription2:champ_obligatoire:>",
					chaine:"<:inscription2:chaine_valide:> <:inscription2:chainelettre:>",
					rangelength:"Min 2 Max 30 <:inscription2:caracteres:>"},
				#ENV{name_prenom}: {
					required:"<:inscription2:champ_obligatoire:>",
					chaine:"<:inscription2:chaine_valide:> <:inscription2:chainelettre:>",
					rangelength:"Min 2 Max 20 <:inscription2:caracteres:>"}
			}
		});

		//On ajoute l'asterisque qui signale qu'un champ est obligatoire
		jQuery(id).find('.obligatoire input').each(function(){
			if(jQuery(this).val() == "" ){
				jQuery(this).addClass('error');
				var id_label = jQuery(this).attr('name');
				var label = '<label class="error" generated="true"><:inscription2:champ_obligatoire:></label>';
				jQuery(this).parent("div").append(label);
				jQuery(this).parent("div").find("label.error").show();
				jQuery(id).find('.crayon-submit').hide();
			}
		});
		//On test le formulaire pour chercher les potentielles erreurs
		validator.form();
		affiche_submit(id);
	}
		
	function affiche_submit(id){
		if(id.find('label.error:visible').length == 0){
			id.find('.crayon-submit').show();
		}
		else{
			id.find('.crayon-submit').hide();
		}
	}
	jQuery(id).find('.obligatoire label').not('.error').append('*');
	setTimeout('validation()',500);
</script>

<fieldset[ style="(#ENV{style})"]>
	<legend><:inscription2:votre_nom_complet:></legend>

	[(#CONFIG{inscription2/nom_famille}|?{' ',''})
	#SET{nom_famille_obligatoire, false}
	[(#CONFIG{inscription2/nom_famille_obligatoire}|=={on}|?{' ',''})#SET{nom_famille_obligatoire, true}]
	[(#GET{nom_famille_obligatoire}|=={true}|?{<div class="obligatoire">,<div>})]		
	<label><:inscription2:nom_famille:></label>
	<input class="crayon-active" name="#ENV{name_nom_famille}" style="width:#ENV{largeur}px;" value="[(#NOM_FAMILLE**|entites_html)]" />
	</div>]
	
	[(#CONFIG{inscription2/prenom}|?{' ',''})
	#SET{prenom_obligatoire, false}
	[(#CONFIG{inscription2/prenom_obligatoire}|=={on}|?{' ',''})#SET{prenom_obligatoire, true}]
	[(#GET{prenom_obligatoire}|=={true}|?{<div class="obligatoire">,<div>})]
	<label><:inscription2:prenom:></label>
	&nbsp;<input class="crayon-active" name="#ENV{name_prenom}" style="width:#ENV{largeur}px;" value="[(#PRENOM**|entites_html)]" />
	</div>]

</fieldset>

</BOUCLE_b>
<//B_b>