<BOUCLE_doc (DOCUMENTS) {id_document=#ENV{id}} {tout}>
[(#REM)
	Modele en dl/dt/dd si affichage de la légende
	cf. http://pompage.net/pompe/listesdefinitions/
	Sinon, utilisation d'un span.
	
	On utilise la vignette explicitement donné à un document si existante, l'image si c'est une image, sinon l'icône.
	On est indépendant du mode de l'image et des réglages de génération automatique des vignettes.
]
[(#SET{vignette,#LOGO_DOCUMENT{vignette}|sinon{#URL_DOCUMENT|media_generer_vignette{#EXTENSION}}|sinon{#LOGO_DOCUMENT{icone}}})]
[(#SET{img,#MEDIA_IMAGE_RETAILLEE{#GET{'vignette'}}})]
[(#SET{width,[(#GET{img}|extraire_attribut{width})]})]
[(#MEDIA_AFFICHER_LEGENDE|oui)
<dl class='spip_document_#ID_DOCUMENT spip_documents[ spip_documents_(#ENV{align})] media media_vignette[ (#ENV{class})] spip_lien_ok'[ style='float:(#ENV{align}|match{left|right});']>
<dt>#MEDIA_LIEN{#GET{img},'oui'}</dt>
#MEDIA_LEGENDE{'dl',#GET{width}}
</dl>]
[(#MEDIA_AFFICHER_LEGENDE|non)
<span class='spip_document_#ID_DOCUMENT spip_documents[ spip_documents_(#ENV{align})] media media_vignette[ (#ENV{class})] spip_lien_ok'[ style='float:(#ENV{align}|match{left|right});']>#MEDIA_LIEN{#GET{img},'oui'}</span>]
</BOUCLE_doc>
