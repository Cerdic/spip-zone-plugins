[(#REM)
- taille : taille des icones : 20px
- couleur : couleur du bord : #FFFFFF 
- bord : taille du bord : 4
Parametres issus du modele GEOPORTAIL : 
- id_geoportail   : si on veux plusieurs cartes
- lon , lat, zoom, zone, mode, layerctrl, toolbox, infobox, searchtools, carto, ortho, width, height
]
<script language=javascript>

function initSpipMap#ENV{id_geoportail,0} (map,id)
{	
	// Definition des styles pour l'affichage sous forme de punaises
	var styleMap = new OpenLayers.StyleMap({"default": {pointRadius: 6, graphicXOffset: -6, graphicYOffset: -6}, "select": {pointRadius: 10, graphicXOffset: -10, graphicYOffset: -10}});
	// Affichage en fonction de l'attribut statut
	var lookup = {
		'0minirezo' : { externalGraphic:"#CHEMIN{images/admin-12.gif}" },
		'1comite' : { externalGraphic:"#CHEMIN{images/redac-12.gif}" },
		'6forum' : { externalGraphic:"#CHEMIN{images/visit-12.gif}" }
	}
	styleMap.addUniqueValueRules("default", "statut", lookup);

	// Rajoute une couche pour les points
	var l = new OpenLayers.Layer.Vector("<:spip:icone_auteurs:>",{ styleMap: styleMap, opacity:1, visibility:1, originators: jQuery.geoportail.originators });
	map.rlayer = l;
	map.getMap().addLayer(l);
	
	// Controle pour la selection
	options = {
		clickout: true, toggle: false, 
		multiple: false, hover: false, 
		onSelect: $.geoportail.popupFeature,
		onUnselect: $.geoportail.unpopupFeature
		}
	var selectControl = new OpenLayers.Control.SelectFeature(map.rlayer, options);
	map.getMap().addControl(selectControl);
	map.rlayer.selectControl = selectControl;
	selectControl.activate();
	
	// Ajouter les auteurs
	<BOUCLE_a(AUTEURS){geoposition}{tout}{id_auteur?}{statut?}{0,#ENV{max,200}}>
	{	[(#SET{largeur,[(#LOGO_AUTEUR||image_reduire{40}|largeur|plus{[(#ENV{bord,4})]})]})]
		[(#SET{hauteur,[(#LOGO_AUTEUR||image_reduire{40}|hauteur|plus{[(#ENV{bord,4})]})]})]
		var feature = jQuery.geoportail.createFeature (map, #LON,#LAT, "[(#LOGO_AUTEUR||image_reduire{40}|image_recadre{#GET{largeur},#GET{hauteur},center,#ENV{couleur,#FFFFFF}}|extraire_attribut{src})]",#ENV{taille,20});
		feature.attributes.img = "[(#LOGO_AUTEUR||image_reduire{40}|replace{'"',"'"})]";
		feature.attributes.name = "[(#NOM|attribut_html)]";
		feature.attributes.link = "[(#URL_AUTEUR|url_absolue)]";
		feature.attributes.description = "[(#BIO**|attribut_html|replace{\n,''}|replace{\r,''}|couper{100})]";
		feature.attributes.statut = "#STATUT";
		map.rlayer.addFeatures(feature);
	}
	</BOUCLE_a>

}
</script>
[(#MODELE{geoportail}{id_geoportail=#ENV{id_geoportail,0}}{overview}{searchtools}{zone}{mode}{lon}{lat}{zoom}{min_zoom}{layerctrl}{toolbox}{infobox}{carto}{ortho}{width}{height})]
