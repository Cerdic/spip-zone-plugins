<BOUCLE_img(DOCUMENTS){id_document=#ID_DOC}{extension IN (jpg,png,gif)}>
<script language=javascript>
/**
* Plugin SPIP Geoportail
*
* @author:
* Jean-Marc Viglino (ign.fr)
*
* Copyright (c) 2010
* Logiciel distribue sous licence GNU/GPL.
*
* Exemple d'affichage d'une couche image en superposition sur une carte geoportail
* L'exemple defini une fonction initSpipMapX (ne marche qu'une seule fois !)
*	<geoportailX|image|id_doc=YY|xmin=2.444775|ymin=48.92170|xmax=2.448227|ymax=48.92357>
**/

$.geoportail.onLoad([(#ENV{id_geoportail,0})] ,
function onloadSpipMap[(#ENV{id_geoportail,0})](map,id)
{	
	var xmin = [(#ENV{xmin,2.444775})];
	var ymin = [(#ENV{ymin,48.92170})];
	var xmax = [(#ENV{xmax,2.448227})];
	var ymax = [(#ENV{ymax,48.92357})];
	
	var pt1 = new OpenLayers.Geometry.Point(xmin,ymin);
	pt1.transform(new OpenLayers.Projection('IGNF:RGF93G'), map.getMap().getProjection());
	var pt2 = new OpenLayers.Geometry.Point(xmax,ymax);
	pt2.transform(new OpenLayers.Projection('IGNF:RGF93G'), map.getMap().getProjection());

	var options = 
	{	minZoomLevel:0, 
		maxZoomLevel:18, 
		maxResolution:100, 
		opacity: 0.65, 
		isBaseLayer:false, 
		visibility:true, 
		maxExtent: new OpenLayers.Bounds(pt1.x, pt1.y, pt2.x, pt2.y),
		originators: jQuery.geoportail.originators,
		view:{ zoomToExtent:true } 
	};

	var graphic = new OpenLayers.Layer.Image(
                '[(#TITRE|sinon{image})]',
                '[(#FICHIER)]',
                new OpenLayers.Bounds(pt1.x, pt1.y, pt2.x, pt2.y),
                new OpenLayers.Size([(#LARGEUR)], [(#HAUTEUR)]),
                options
            );
	map.getMap().addLayer(graphic);
	map.getMap().setCenterAtLonLat((xmin+xmax)/2,( ymin+ymax)/2, [(#ENV{zoom,15})]);
}
);
</script>
</BOUCLE_img>
