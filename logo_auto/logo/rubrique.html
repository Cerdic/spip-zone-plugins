[(#REM) reglages des variables ]
#SET{largeur,150}
#SET{hauteur,#GET{largeur}}
#SET{class,spip_logos}

[(#REM) recuperer le logo d'article de facon classique]
#SET{logo,#ENV*{logo_rubrique}}

[(#REM) s'il n'existe pas, chercher une image associee a l'article ;

  On teste "rubon" pour respecter l'ordre des priorités suivant :
  * logo de rubrique
  * image liée à la rubrique
  * logo du site SPIP

]

<BOUCLE_doc(DOCUMENTS)
  {si (#GET{logo}|match{rubon}|non)}
  {id_rubrique}
  {par date}
  {0,1}
>
#SET{logo,#FICHIER}
</BOUCLE_doc>

[(#REM) traiter/recadrer l'image ]
[(#GET{logo}
    |sinon{#LOGO_SITE_SPIP}
    |image_passe_partout{#GET{largeur},#GET{hauteur}}
    |image_recadre{#GET{largeur},#GET{hauteur},center,transparent}
    |inserer_attribut{class,#GET{class}}
)]