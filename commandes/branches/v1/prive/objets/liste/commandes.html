[(#REM)
	param√®tres d'affichage :
		titre_dehors (bool): true pour afficher le titre en dehors du tableau
		cacher_tri (bool): true pour cacher le tri
][
(#SET{defaut_tri,#ARRAY{
	date,-1,
	date_paiement,-1,
	reference,1
	id_auteur,1
}})
]<B_liste_commandes>
<div class='nettoyeur'></div>
#ANCRE_PAGINATION
[(#ENV{titre_dehors}|oui)[<h2>(#ENV*{titre,#TOTAL_BOUCLE|objet_afficher_nb{commande}})</h2>]]
<div class="liste-objets commandes">
	[(#ENV{cacher_tri}|non)
	<div class='pagination tri'>
		[(#TRI{'>',#CHEMIN_IMAGE{tri-asc-16.png}|balise_img{<:par_tri_croissant:>}})][
		<span class="sep">&nbsp;|&nbsp;</span>(#TRI{'<',#CHEMIN_IMAGE{tri-desc-16.png}|balise_img{<:par_tri_decroissant:>}})][
		<span class="sep">&nbsp;|&nbsp;</span>(#TRI{id_commande,<:info_numero_abbreviation:>,ajax})][
		<span class="sep">&nbsp;|&nbsp;</span>(#TRI{reference,<:commandes:reference:>,ajax})][
		<span class="sep">&nbsp;|&nbsp;</span>(#TRI{statut,<:commandes:etat:>,ajax})][
		<span class="sep">&nbsp;|&nbsp;</span>(#TRI{date,<:commandes:date_commande_label_court:>,ajax})][
		<span class="sep">&nbsp;|&nbsp;</span>(#TRI{date_paiement,<:commandes:date_paiement_label_court:>,ajax})][
		<span class="sep">&nbsp;|&nbsp;</span>(#TRI{date_envoi,<:commandes:date_envoi_label_court:>,ajax})]
	</div>
	]
	[<div class="pagination">(#PAGINATION{prive})</div>]
	<table class='spip liste'>
		[(#ENV{titre_dehors}|non)[<caption><strong class="caption">(#ENV*{titre,#TOTAL_BOUCLE|singulier_ou_pluriel{commandes:info_1_commande,commandes:info_nb_commandes}})</strong></caption>]]
		<thead>
			<tr class='first_row'>
				<th class='etat' scope='col'>#</th>
				<th class='infos' scope='col'><:commandes:label_infos:></th>
				<th class='dates' scope='col'><:commandes:label_commande_dates:></th>
				<th class='descriptif' scope='col'><:commandes:label_objets:></th>
				<th class='montant' scope='col'><:prix:label_total_ttc:></th>
				[(#ENV{simuler}|=={1}|oui)<th scope='col'><:commandes:simuler:></th>]
			</tr>
		</thead>
		<tbody>
		<BOUCLE_liste_commandes(COMMANDES)
			{id_auteur?}{id_commande?}{where?}{statut?}{annee?}{mois?}
			{tri #ENV{order,date},#GET{defaut_tri}}
			{pagination #ENV{nb,20}}>
			<tr class="[(#COMPTEUR_BOUCLE|alterner{row_odd,row_even})][ (#STATUT)]">
				<td class='etat'>[(#STATUT|puce_statut{commande,#ID_COMMANDE})&nbsp;]</td>
				<td class='infos'>
					[<div class='id'>
						<a href="[(#ID_COMMANDE|generer_url_entite{commande})]"><:commandes:commande_titre:>&nbsp;<:info_numero_abbreviation:>(#ID_COMMANDE)</a>
					</div>]
					[<div class='reference'>
						(#REFERENCE)
					</div>]
					<div class='qui'>
						<BOUCLE_client(CONTACTS ?){id_auteur}><a href="[(#ID_CONTACT|generer_url_entite{contact})]">#CIVILITE #PRENOM #NOM </a></BOUCLE_client>
						[<a href="[(#ID_AUTEUR|generer_url_entite{auteur})]">(#INFO_NOM{auteur, #ID_AUTEUR})</a>]<//B_client>
					</div>
				</td>
				<td class='dates'>
					<ul>
						#SET{date,#DATE|annee|=={#ENV{date}|annee}|?{
							#DATE|affdate{jourcourt},
							#DATE|jour|concat{'&nbsp;',#DATE|nom_mois{abbr},'&nbsp;'#DATE|annee}}}
						<li class="date">
							[<span class="label"><:commandes:date_commande_label_court:>&nbsp;:</span>&nbsp;(#GET{date})]
						</li>
						[(#DATE_PAIEMENT|intval|>{0}|oui)
						#SET{date_paiement,#DATE_PAIEMENT|annee|=={#ENV{date}|annee}|?{
							#DATE_PAIEMENT|affdate{jourcourt},
							#DATE_PAIEMENT|jour|concat{'&nbsp;',#DATE_PAIEMENT|nom_mois{abbr},'&nbsp;'#DATE_PAIEMENT|annee}}}
						<li class="date paiement">
							[<span class="label"><:commandes:date_paiement_label_court:>&nbsp;:</span>&nbsp;(#GET{date_paiement})]
						</li>
						]
						[(#DATE_ENVOI|intval|>{0}|oui)
						#SET{date_envoi,#DATE_ENVOI|annee|=={#ENV{date}|annee}|?{
							#DATE_ENVOI|affdate{jourcourt},
							#DATE_ENVOI|jour|concat{'&nbsp;',#DATE_ENVOI|nom_mois{abbr},'&nbsp;'#DATE_ENVOI|annee}}}
						<li class="date envoi">
							[<span class="label"><:commandes:date_envoi_label_court:>&nbsp;:</span>&nbsp;(#GET{date_envoi})]
						</li>
						]
					</ul>
				</td>
				<td class='descriptif'>
					<B_details>
					<ul>
						<BOUCLE_details(COMMANDES_DETAILS){id_commande}{objet!=''}{id_objet!=0}{!par objet}{par id_commandes_detail}>
						#SET{objet_spip, #OBJET|in_array{#REM|lister_tables_objets_surnoms|array_keys}|et{#ID_OBJET|>{0}}|?{oui}}
						#SET{objet_base, #OBJET|table_objet_sql|sql_countsel{#OBJET|id_table_objet|concat{=,#ID_OBJET}}}
						[(#GET{objet_spip}|oui)
						<li>
							[(#QUANTITE)&times;&nbsp;][(#GET{objet_base}|oui)<a href="[(#INFO_URL{#OBJET,#ID_OBJET})]">]
								[(#DESCRIPTIF*|typo|supprimer_numero|sinon{#VAL{info_sans_titre}|_T|wrap{<em>}})]
							[(#GET{objet_base}|oui)</a>]
						</li>
						]
						</BOUCLE_details>
					</ul>
					</B_details>
				</td>
				<td class='montant'>[(#PRIX)]</td>
				[(#ENV{simuler}|=={1}|oui)
				<td class='simuler'>
				[(#BOUTON_ACTION{
					<:commandes:statut_encours:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-encours,#SELF})]})]
				[(#BOUTON_ACTION{
					<:commandes:statut_attente:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-attente,#SELF})]})]
				[(#BOUTON_ACTION{
					<:commandes:statut_partiel:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-partiel,#SELF})]})]
				[(#BOUTON_ACTION{
					<:commandes:statut_paye:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-paye,#SELF})]})]
				[(#BOUTON_ACTION{
					<:commandes:statut_envoye:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-envoye,#SELF})]})]
				[(#BOUTON_ACTION{
					<:commandes:statut_retour:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-retour,#SELF})]})]
				[(#BOUTON_ACTION{
					<:commandes:statut_retour_partiel:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-retour_partiel,#SELF})]})]
				[(#BOUTON_ACTION{
					<:commandes:statut_erreur:>,
					[(#URL_ACTION_AUTEUR{instituer_commande,#ID_COMMANDE-erreur,#SELF})]})]
				</td>
				]
			</tr>
		</BOUCLE_liste_commandes>
		</tbody>
	</table>
	[<p class='pagination'>(#PAGINATION{prive})</p>]
</div>
</B_liste_commandes>[
<div class="liste-elements commandes"><strong class="caption">(#ENV*{sinon,''})</strong></div>
]<//B_liste_commandes>
