[(#REM) <!-- Liste des commentaires :
	Dans ces differents cas les informations different car la taille des blocs influe sur l'affichage.

	Les parametres d'environnement specifiques sont :
	- titre			: le titre de la liste
	- par			: le champ tri principal
	- pas			: le pas de pagination
	- id_relecture	: l'id de la relecture concernee (facultatif)
	- element		: element d'article sur lequel porte le commentaire (facultatif)
	- statut		: le statut des commentaires cherches (facultatif)
	- recherche		: critere de recherche (facultatif)
	- where			: condition d'exclusion de certains commentaires (facultatif)
	- affichage		: menu_navigation ou liste
 -->]

[(#SET{defaut_tri,#ARRAY{
	date_modif, -1,
	element, 1,
	id_commentaire, 1,
	points, -1
}})]
<B_liste_commentaires>
#ANCRE_PAGINATION
<div class="liste-objets commentaires">
	<table class="spip liste" summary="<:relecture:resume_table_commentaires:>">
		[<caption><strong class="caption">(#ENV*{titre, #GRAND_TOTAL|singulier_ou_pluriel{relecture:info_1_commentaire, relecture:info_nb_commentaires}})</strong></caption>]
		<thead>
			<tr class="first_row">
				<th class="statut" scope="col">#</th>
			[(#ENV{affichage}|=={menu_navigation}|non)
				[(#ENV{id_relecture}|non)<th class="titre" scope="col"><:relecture:titre_relecture:></th>]
				[(#ENV{element}|non)<th class="element" scope="col">[(#TRI{element, <:relecture:label_element:>, ajax})]</th>]
				<th class="auteur" scope="col">[(#TRI{id_emetteur, <:relecture:label_emetteur:>, ajax})]</th>
				<th class="date" scope="col">[(#TRI{date_ouverture, <:relecture:label_date_ouverture_commentaire:>, ajax})]</th>
				<th class="statut" scope="col">[(#TRI{statut, <:relecture:label_statut:>, ajax})]</th>
				<th class="date" scope="col">[(#TRI{date_cloture, <:relecture:label_date_cloture_commentaire:>, ajax})]</th>
			]
			[(#ENV{affichage}|=={menu_navigation}|oui)
				<th><:relecture:label_date_statut:></th>
				<th><:relecture:label_date_statut:></th>
			]
				<th class="id" scope="col">[(#TRI{id_commentaire, <:info_numero_abbreviation:>, ajax})]</th>
			</tr>
		</thead>
		<tbody>
	<BOUCLE_liste_commentaires(COMMENTAIRES) {id_relecture?}{element?}{statut?}{where?}{recherche?}{tri #ENV{par, date_modif}, #GET{defaut_tri}}{pagination #ENV{pas, 10}}>
			<tr class="[(#COMPTEUR_BOUCLE|alterner{row_odd, row_even})]">
				<td class="statut">
					[(#STATUT|puce_statut{commentaire, #STATUT, 0, commentaire, #EVAL{false}, #EVAL{false}})]
				</td>
			[(#ENV{affichage}|=={menu_navigation}|non)
				[(#ENV{id_relecture}|non)
				<td class="titre">
					<a[ href="(#ID_RELECTURE|generer_url_entite{relecture})"]>[(#INFO_TITRE{relecture, ID_RELECTURE})]</a>
				</td>
				]
				[(#ENV{element}|non)<td class="element">[(#VAL{relecture:label_article_}|concat{#ELEMENT}|_T)]</td>]
				<td class="auteur">
					<BOUCLE_auteurs(AUTEURS){id_auteur=#ID_EMETTEUR}{tout}>
						<a href="[(#ID_AUTEUR|generer_url_entite{auteur})]">#NOM</a>
					</BOUCLE_auteurs>
				</td>
				<td class="date">[(#DATE_OUVERTURE|affdate_court)]</td>
				<td class="statut-clair">[(#VAL{relecture:texte_commentaire_}|concat{#STATUT}|_T)]</td>
				<td class="date">[(#DATE_CLOTURE|intval|oui)[(#DATE_CLOTURE|affdate_court)]]</td>
			]
			[(#ENV{affichage}|=={menu_navigation}|oui)
				<td>
					[(#STATUT|=={ouvert}|oui)[(#DATE_OUVERTURE|affdate_court)]]
					[(#STATUT|=={ouvert}|non)[(#DATE_CLOTURE|affdate_court)]]
				</td>
				<td>
				[(#AUTORISER{moderer, commentaire, #ID_RELECTURE})
					[(#BOUTON_ACTION{<:relecture:bouton_moderer:>, 'commentaire_edit', '', '', ''})]
				]
				[(#AUTORISER{modifier, commentaire, #ID_RELECTURE})
					[(#BOUTON_ACTION{<:relecture:bouton_modifier:>, 'commentaire_edit', '', '', ''})]}
				)]
				</td>
			]
				<td class="id">#ID_COMMENTAIRE</td>
			</tr>
	</BOUCLE_liste_commentaires>
		</tbody>
	</table>
	[<p class="pagination">(#PAGINATION{#ENV{pagination, prive}})</p>]
</div>
</B_liste_commentaires>
[<div class="liste-objets commentaires caption-wrap"><strong class="caption">(#ENV*{sinon,''})</strong></div>]
<//B_liste_commentaires>
