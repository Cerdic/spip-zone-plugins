[(#REM)

	Compilation des résultats pour les visites sur un type d'objet particulier
	sans que son id numérique ne soit spécifié

	Doit recevoir dans l'environnement :
	-* Un array de d'id_journal #ENV{id_journals}
	-* Un type d'objet

	On crée deux tableaux différents de compilation :
	-* Par id_objet
	-* Par id_auteur
]
#SET{auteurs,#ARRAY}
#SET{temps_auteurs, #ARRAY}
#SET{id_objets,#ARRAY}
#SET{temps_objets, #ARRAY}
<BOUCLE_journal_stats_total(JOURNAL){id_journal IN #ENV{id_journals}}{objet}{id_auteur ?}{action = #ENV{journal_action}}>
	#SET{
		temps_auteurs,
		#GET{temps_auteurs}|array_merge{
			#ARRAY{
				aut#ID_AUTEUR,
				#GET{temps_auteurs}|table_valeur{aut#ID_AUTEUR,0}|plus{#DATE|bigbrother_duree{#INFOS|table_valeur{date_fin},secondes}}
			}
		}
	}
	#SET{
		temps_objets,
		#GET{temps_objets}|array_merge{
			#ARRAY{
				obj#ID_OBJET,
				#GET{temps_objets}|table_valeur{obj#ID_OBJET,0}|plus{#DATE|bigbrother_duree{#INFOS|table_valeur{date_fin},secondes}}
			}
		}
	}
	#SET{auteurs,#GET{auteurs}|push{#ID_AUTEUR}}
	#SET{id_objets,#GET{id_objets}|push{#ID_OBJET}}
</BOUCLE_journal_stats_total>
<div>
#SET{auteurs,#GET{auteurs}|array_unique}
#SET{id_objets,#GET{id_objets}|array_unique}
#SET{nb_users,#GET{auteurs}|count}
#SET{nb_objets,#GET{id_objets}|count}
#SET{nb_visites,#TOTAL_BOUCLE}

<h2><:bigbrother:titre_compilation_resultats:></h2>
[(#ENV{id_auteur}|non)
	<p><:bigbrother:info_stats_objet_visite_auteurs_nb{nb=#GET{nb_users},nb_visites=#GET{nb_visites},objet=#ENV{objet},id_objet=#ENV{id_objet}}:></p>
]

<B_visites_par_auteurs>
	#ANCRE_PAGINATION
	<table class="bigbrother">
		<thead>
			<tr class="row_first">
				<th><:bigbrother:thead_id_auteur:></th>
				<th class="temps"><:bigbrother:temps_passe:></th>
			</tr>
		</thead>
		<tbody>
	<BOUCLE_visites_par_auteurs(POUR){tableau #GET{auteurs}}{pagination #ENV{pagination,0}}>
		<tr class="tr_liste">
			<td>
				<a title="<:bigbrother:detail:>" href="[(#SELF|parametre_url{id_auteur,#VALEUR})]">
					[(#VALEUR|is_numeric|oui)
						#INFO_NOM{auteur,#VALEUR}]
					[(#VALEUR|is_numeric|non)
						#VALEUR]
				</a>
			</td>
			[<td class="temps">(#GET{temps_auteurs}|table_valeur{aut#VALEUR}|bigbrother_duree{0,horaire})</td>]
		</tr>
	</BOUCLE_visites_par_auteurs>
		</tbody>
	</table>
	[<div class="pagination pagination_bigbrother">(#PAGINATION{page_precedent_suivant})</div>]

	<p><strong><:bigbrother:temps_total:></strong> : [(#GET{temps_auteurs}|array_sum|bigbrother_duree{0, horaire})]</p>
	<p><strong><:bigbrother:temps_median:></strong> : [(#GET{temps_auteurs}|bigbrother_mediane|floor|bigbrother_duree{0, horaire})]</p>
	<p><strong><:bigbrother:temps_moyen:></strong> : [(#GET{temps_auteurs}|array_sum|div{#GET{auteurs}|count}|bigbrother_duree{0, horaire})]</p>
</B_visites_par_auteurs>
<B_visites_par_id_objets>
	#ANCRE_PAGINATION
	<table class="bigbrother">
		<thead>
			<tr class="row_first">
				<th><:bigbrother:thead_id_objet:></th>
				<th><:bigbrother:thead_titre:></th>
				<th class="temps"><:bigbrother:thead_temps_consultation:></th>
			</tr>
		</thead>
		<tbody>
	<BOUCLE_visites_par_id_objets(POUR){tableau #GET{id_objets}}{pagination #ENV{pagination,0}}>
		<tr class="tr_liste">
			<td>
				<a title="<:bigbrother:detail:>" href="[(#SELF|parametre_url{id_objet,#VALEUR})]">
					#VALEUR
				</a>
			</td>
			<td>
				<a title="<:bigbrother:detail:>" href="[(#SELF|parametre_url{id_objet,#VALEUR})]">
					#INFO_TITRE{#ENV{objet},#VALEUR}
				</a>
			</td>
			[<td class="temps">(#GET{temps_objets}|table_valeur{obj#VALEUR}|bigbrother_duree{0,horaire})</td>]
		</tr>
	</BOUCLE_visites_par_id_objets>
		</tbody>
	</table>
	[<div class="pagination pagination_bigbrother">(#PAGINATION{page_precedent_suivant})</div>]

	<p><strong><:bigbrother:temps_total:></strong> : [(#GET{temps_objets}|array_sum|bigbrother_duree{0, horaire})]</p>
	<p><strong><:bigbrother:temps_median:></strong> : [(#GET{temps_objets}|bigbrother_mediane|floor|bigbrother_duree{0, horaire})]</p>
	<p><strong><:bigbrother:temps_moyen:></strong> : [(#GET{temps_objets}|array_sum|div{#GET{id_objets}|count}|bigbrother_duree{0, horaire})]</p>
</B_visites_par_id_objets>
</div>
</B_journal_stats_total>