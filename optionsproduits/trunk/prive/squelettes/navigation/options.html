<div class="formulaire formulaire_spip formulaire_navigation_filtre">
	#ENV{action}
	<form method='post'>
		#ACTION_FORMULAIRE{#ENV{action}}
		<div class="editer-groupe">

			#SAISIE{optionsgroupes,id_optionsgroupe,label=Groupe}
			#SAISIE{input, recherche, label=Recherche}
			
		</div>
		<p class="boutons"><input type="submit" class="submit" name="valide" value="Recherche"/></p>
	</form>
</div>

[(#URL_ECRIRE{optionsgroupes}|icone_horizontale{<:optionsgroupe:gerer_groupes:>,optionsgroupe})]
	
<script>
	$(function() {
		var $filtreForm = $('.formulaire_navigation_filtre form');

		$filtreForm.find('select, input[type=checkbox], input[type=radio]').on('change', function(){
			$filtreForm.submit();
		});
		
		$filtreForm.on('submit', function(e) {
			e.preventDefault();

			var formData = $filtreForm.serializeArray().reduce(function(obj, item) {
				if(item.name.indexOf('[]')!==-1) {
					var name = item.name.replace(/[\[\]]+/g, '');
					if(!obj.hasOwnProperty(name)) {
						obj[name] = [];
					}
					obj[name].push(item.value);
				} else {
					obj[item.name] = item.value;
				}
				return obj;				
			}, {});

			//console.log(formData);
			
			// passer une valeur vide explicite pour les checkbox et radios non coch√©s
			var $checkradio = $filtreForm.find('input[type=checkbox], input[type=radio]');
			$.each($checkradio,function(){
				var checkRadioName = $(this).attr('name');
				var name = '';
				if(checkRadioName.indexOf('[]')!==-1) {
					name = checkRadioName.replace(/[\[\]]+/g, '');
				} else {
					name = checkRadioName;
				}
				if(!formData.hasOwnProperty(name)){
					formData[checkRadioName] = '';
				}
			});
			
			console.log(formData);
			
			ajaxReload('liste-objets', {args:formData});
		});
	});
</script>
