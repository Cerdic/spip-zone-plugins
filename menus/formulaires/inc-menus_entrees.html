
#SET{rang_suivant,1}
<ul id="menu-#ENV{id_menu}" class="menus_entrees">
	<BOUCLE_entrees(MENUS_ENTREES){id_menu}{par rang}>
	<li class="entree"[ style="background-image:url((#ENV{types_entrees}|table_valeur{#TYPE_ENTREE}|table_valeur{icone}|image_reduire{24}|extraire_attribut{src}))"]>
		<BOUCLE_test_modifier(CONDITION){si #ENV{erreurs}|table_valeur{id_menus_entree}|=={#ID_MENUS_ENTREE}|non}>
		<div class="ligne">
			<div class="description arial2">
				#MENUS_AFFICHER_ENTREE{appel_formulaire}
			</div>
			<div class="actions">
				[(#REM) S'il y a déjà un sous-menu on ne l'affiche pas ?)]
				<BOUCLE_sous_menu_test(MENUS){id_menus_entree}>
				[(#REM) Rien]
				</BOUCLE_sous_menu_test>
				[(#ENV{types_entrees}|table_valeur{#TYPE_ENTREE}|table_valeur{refuser_sous_menu}|non)
				<button name="demander_sous_menu" value="#ID_MENUS_ENTREE" title="<:menus:formulaire_ajouter_sous_menu:>">
					[<img height="24" width="24" src="(#CHEMIN{images/menus-24.png})" />]
				</button>
				]
				<//B_sous_menu_test>
				<button name="modifier_entree" value="#ID_MENUS_ENTREE" title="<:menus:formulaire_modifier_entree:>">
					[<img height="24" width="24" src="(#CHEMIN{images/menus_action_modifier.png})" />]
				</button>
				<button name="supprimer_entree" value="#ID_MENUS_ENTREE" title="<:menus:formulaire_supprimer_entree:>">
					[<img height="24" width="24" src="(#CHEMIN{images/menus_action_supprimer.png})" />]
				</button>
				<button name="deplacer_entree" value="#ID_MENUS_ENTREE-bas" title="<:menus:formulaire_deplacer_bas:>">
					[<img height="24" width="24" src="(#CHEMIN{images/menus_action_bas.png})" />]
				</button>
				<button name="deplacer_entree" value="#ID_MENUS_ENTREE-haut" title="<:menus:formulaire_deplacer_haut:>">
					[<img height="24" width="24" src="(#CHEMIN{images/menus_action_haut.png})" />]
				</button>
			</div>
		</div>
		</BOUCLE_test_modifier>
		#INCLURE{fond=formulaires/inc-nouvelle_entree-2, env, id_menus_entree=#ID_MENUS_ENTREE}
		<//B_test_modifier>
		[(#REM) Est-ce qu'il y a un sous-menu ?)]
		<BOUCLE_sous_menu(MENUS){id_menus_entree}>
			#INCLURE{fond=formulaires/inc-menus_entrees, env, id_menu, sous_menu=oui}
		</BOUCLE_sous_menu>
	</li>
	#SET{rang_suivant,(#RANG|plus{1})}
	</BOUCLE_entrees>
	<li class="editer_texte">
		#SET{id_menu_nouvelle_entree, (#ENV{erreurs}|table_valeur{id_menu_nouvelle_entree})}
		#SET{type_entree, (#ENV{erreurs}|table_valeur{type_entree})}

		[(#GET{id_menu_nouvelle_entree}|=={#ENV{id_menu}}|non)
			<span class='image_loading'></span>
			<button type="submit" class="submit" name="demander_nouvelle_entree" value="#ENV{id_menu}">
				[<img src="(#CHEMIN{images/menus_action_ajouter.png})" />]
				<:menus:formulaire_ajouter_entree:>
			</button>
			[(#ENV{sous_menu}|oui)
			<button type="submit" class="submit" name="supprimer_sous_menu" value="#ENV{id_menu}">
				[<img src="(#CHEMIN{images/menus_action_supprimer.png})" />]
				<:menus:formulaire_supprimer_sous_menu:>
			</button>
			]
		]
		[(#GET{id_menu_nouvelle_entree}|=={#ENV{id_menu}}|oui)
			[(#GET{type_entree}|non)
				#INCLURE{fond=formulaires/inc-nouvelle_entree-1, env, id_menu_nouvelle_entree=#GET{id_menu_nouvelle_entree}}
			]
			[(#GET{type_entree}|oui)
				#INCLURE{fond=formulaires/inc-nouvelle_entree-2, env, id_menu_nouvelle_entree=#GET{id_menu_nouvelle_entree}, rang_suivant=#GET{rang_suivant}}
			]
		]
	</li>
</ul>
