[(#REM) titre=Configuration du plugin «&nbsp;Autorit&#233;&nbsp;»]

[(#REM) descriptif=
<div id="message"></div>
<a href="http://www.spip-contrib.net/-Autorite-" class="spip_out">Cf. documentation</a>

]
#CACHE{0}

<form method="post" action="#SELF"><div>[(#ENV{_cfg_}|form_hidden)]</div>

<div style="float:#LANG_RIGHT;"><img src='#DOSSIER_SQUELETTE/../illuminati.png' width='64' height='64' alt='Logo rigolo' /></div>


[(#REM) ------------------------ AFFICHER LES ERREURS ------------------------ ]
[(#CONFIG{autorite_erreurs}|?{#CONFIG{autorite_erreurs}|unserialize|count|>{0}|?{' '}})

	<div class="cadre-info verdana1">
	[(#REM|sinon{warning.gif}|http_img_pack{<:avis_attention:>,width='48' height='48' style='float: #LANG_RIGHT; padding-#LANG_LEFT: 10px;'})]
	<strong><:avis_attention:></strong> Les autorisations suivantes sont d&#233;j&#224; d&#233;finies par ailleurs&nbsp;:
	<ul><li>
	<tt>
	[(#CONFIG{autorite_erreurs}|unserialize|join{'</tt></li><li><tt>'})]
	</tt>
	</li></ul>
	Le plugin &#171;&nbsp;Autorit&#233;&nbsp;&#187; ne peut pas les modifier&nbsp;; certains des r&#233;glages ci-dessous risquent par cons&#233;quent de ne pas fonctionner.
	<br />Pour r&#233;gler ce probl&#232;me, vous devrez v&#233;rifier si votre fichier <tt>mes_options.php</tt> (ou un autre plugin actif) a d&#233;fini ces fonctions.
	</div>

]
<?php

	// Comment gerer ca proprement ?
	$autorite_erreurs_version = array();
	if ($GLOBALS['spip_version_code'] < '1.9251') {
		$autorite_erreurs_version[] = 'auteur modere forum';
		$autorite_erreurs_version[] = 'auteur modere petition';
		$autorite_erreurs_version[] = 'auteur modifie email';
		$autorite_erreurs_version[] = 'redacteur voit stats';
		$autorite_erreurs_version[] = 'redacteur modifie mots';
	}

	if ($autorite_erreurs_version) {
		echo "Attention les choix suivants peuvent ne pas fonctionner avec votre version de SPIP&nbsp;:\n"
		. "<ul><li>\n"
		. join ("</li><li>", $autorite_erreurs_version)
		. "</li></ul>\n";
	}
?>


[(#REM) ------------------------ DROITS D'EDITION ------------------------ ]
<fieldset>
<legend>
	Droits d'&#233;dition
</legend>
<p>
<label><input type="checkbox" name="auteur_mod_article" [checked="(#ENV{auteur_mod_article}?{checked})"] />
	<strong>Auteur modifie article</strong>&nbsp;: chaque r&#233;dacteur peut modifier les articles dont il est l'auteur (et, par conséquent, mod&#233;rer le forum et la p&#233;tition associ&#233;s).
</label>

<br />

<label><input type="checkbox" name="auteur_modere_forum" [checked="(#ENV{auteur_modere_forum}|?{checked})"] [(#ENV{auteur_mod_article}|?{' disabled="disabled"'})]
/>
	<strong>Auteur mod&#232;re forum</strong>&nbsp;: chaque r&#233;dacteur peut mod&#233;rer le forum des articles dont il est l'auteur.
</label>

<br />

<label><input type="checkbox" name="auteur_modere_petition" [checked="(#ENV{auteur_modere_petition}|?{checked})"] [(#ENV{auteur_mod_article}|?{' disabled="disabled"'})]
/>
	<strong>Auteur mod&#232;re p&#233;tition</strong>&nbsp;: chaque r&#233;dacteur peut mod&#233;rer la p&#233;tition des articles dont il est l'auteur.
</label>

<br />

<label><input type="checkbox" name="auteur_mod_email" [checked="(#ENV{auteur_mod_email}|?{checked})"] />
	<strong>Auteur modifie email</strong>&nbsp;: chaque r&#233;dacteur peut modifier son email sur sa fiche d'informations personnelles.
</label>

</p>


<label><strong>Mots-cl&#233;s&nbsp;:</strong> qui peut cr&#233;er et &#233;diter les mots-cl&#233;s&nbsp;:
<br />
<select name="editer_mots">
	<option value="0">Les administrateurs complets</option>
	<option value="1"[ selected="(#ENV{editer_mots}|=={1}|?{selected})"]>Tous les administrateurs (y compris restreints)</option>
	<option value="2"[ selected="(#ENV{editer_mots}|=={2}|?{selected})"]>Tous les r&#233;dacteurs</option>
</select>
</label>

<br />
<br />

<fieldset>
	<legend>Crayons</legend>
	<small><strong>Attention.</strong> Les r&#233;glages ci-dessous ne peuvent fonctionner que si vous utilisez un plugin proposant une interface d'&#233;dition (comme par exemple <a href="http://www.spip-contrib.net/Les-Crayons">les Crayons</a>).
	</small>

[(#REM)
	L'auteur d'un forum caracterise par son id_auteur, c'est deja pas mal ;
	pour des auteurs anonymes, il faudrait leur poser un cookie qui leur
	ouvrirait ce droit tant que le cookie vit (donc, TODO).
]
	<p>
	<label><strong>Forums&nbsp;:</strong> qui peut modifier le contenu des forums&nbsp;:
	<br />
	<select name="editer_forums">
	<option value="0">Personne (valeur par d&#233;faut)</option>
	<option value="1"[ selected="(#ENV{editer_forums}|=={1}|?{selected})"]>Le webmestre</option>
	<option value="2"[ selected="(#ENV{editer_forums}|=={2}|?{selected})"]>Les administrateurs</option>
	<option value="3"[ selected="(#ENV{editer_forums}|=={3}|?{selected})"]>L'auteur du message, pendant une heure [s'il s'est enregistr&#233;]</option>
	<option value="4"[ selected="(#ENV{editer_forums}|=={4}|?{selected})"]>L'auteur du message, ad vitam [s'il s'est enregistr&#233;]</option>
	</select>
	</p>

[(#REM)
	Pour les signataires c'est plus dur, car a priori pas d'id_auteur :
	il faudra absolument un cookie specialise
]
	<p>
	<label><strong>Forums&nbsp;:</strong> qui peut modifier les signatures des p&#233;titions&nbsp;:
	<br />
	<select name="editer_forums">
	<option value="0">Personne (valeur par d&#233;faut)</option>
	<option value="1"[ selected="(#ENV{editer_forums}|=={1}|?{selected})"]>Le webmestre</option>
	<option value="2"[ selected="(#ENV{editer_forums}|=={2}|?{selected})"]>Les administrateurs</option>
<!--
	<option value="2"[ selected="(#ENV{editer_signatures}|=={2}|?{selected})"]>Le signataire, pendant une heure [s'il s'est enregistr&#233;]</option>
	<option value="3"[ selected="(#ENV{editer_signatures}|=={3}|?{selected})"]>le signataire, ad vitam</option>
-->
	</select>
	</label>
	</p>

</fieldset>

</fieldset>

[(#REM) ------------------------ DROITS DE LECTURE ------------------------ ]
<fieldset>
<legend>
	Droits de consultation
</legend>
<p>
<label><input type="checkbox" name="redacteurs_voirstats" [checked="(#ENV{redacteurs_lire_stats}?{checked})"] />
	<strong>R&#233;dacteur voit stats</strong>&nbsp;: les r&#233;dacteurs peuvent visualiser les statistiques.
</label>

</p>
</fieldset>


[(#REM) ------------------------ ESPACE WIKI ------------------------ ]
<fieldset>
<legend>
	Espace wiki
</legend>

<p>
<label>
Choisissez ci-dessous un secteur &#224; traiter comme un wiki, c'est-&#224;-dire &#233;ditable par tous depuis l'espace public (&#224; condition d'avoir une interface, par exemple les crayons)&nbsp;:

<br />


#SET{selected,#CONFIG{autorite/espace_wiki,'',''}}
<select name="espace_wiki[]" multiple="multiple" size="5" id="espace_wiki">
<BOUCLE_rmul(RUBRIQUES){racine}{tout}{par num titre, titre}>
	<option value="#ID_RUBRIQUE"[(#ID_RUBRIQUE|in_array{#GET{selected}}|?{' selected="selected"'})]>
	#TITRE
	</option>
</BOUCLE_rmul>
</select>

<small><br />(vous pouvez s&#233;lectionner plusieurs secteurs avec la touche shift)
<br /><a onclick="$('#espace_wiki').find('option').attr('selected', false).end().trigger('change');">x</a> tout d&#233;selectionner</small>

</label>
</p>

<p id="espace_wiki_qui">
Voulez-vous ouvrir ce wiki &mdash; au-del&#224; des administrateurs&nbsp;:
<br />
<label><input type="checkbox" name="espace_wiki_redacteurs" [checked="(#ENV{espace_wiki_redacteurs}|?{checked})"] /> aux r&#233;dacteurs du site&nbsp;;
</label>
<br />
<label><input type="checkbox" name="espace_wiki_visiteurs" [checked="(#ENV{espace_wiki_visiteurs}|?{checked})"] /> aux visiteurs enregistr&#233;s&nbsp;;
</label>
<br />

<label><input type="checkbox" name="espace_wiki_anonyme" [checked="(#ENV{espace_wiki_anonyme}|?{checked})"] /> &#224; tous les visiteurs du site.
</label>

<label><small><br />&nbsp; &nbsp; <input type="checkbox" name="espace_wiki_rubrique_anonyme" [checked="(#ENV{espace_wiki_anonyme}|?{#ENV{espace_wiki_rubrique_anonyme}|?{checked}})"] /> les visiteurs anonymes peuvent cr&#233;er de nouvelles pages.
</small></label>

</p>

</fieldset>

[(#REM) Code jQuery de l'espace wiki ; plier/deplier la moderation ]
<script type="text/javascript"><!--
	$('#espace_wiki')
	.bind('change', function() {
		if (parseInt(this.value))
			$('#espace_wiki_qui:hidden').slideDown('slow');
		else
			$('#espace_wiki_qui:visible').slideUp('slow');
	})
	if ($('#espace_wiki option[@selected]').length == 0)
		$('#espace_wiki_qui').hide();
// --></script>



[(#REM) ------------------------ BOUTON OK ------------------------ ]
<div>
<input style="float:#LANG_RIGHT;" type="submit" name="_cfg_ok" value="<:OK:>" class="fondo" />
<!--
<input type="reset" value="<:Reset:>" class="fondo" />
<input type="submit" name="_cfg_delete" value="<:Supprimer:>" class="fondo" />
-->
</div>
</form>



[(#REM)

Hack de la mort pour povuoir mettre ce que je veux dans la div de la marge ; a l'aide !

]
<div id="message2">
#EVAL{MESSAGE_CONFIG_AUTORISER}
</div>
<script type='text/javascript'><!--
	$('#message').html($('#message2').html());
	$('#message2').empty();
//--></script>
