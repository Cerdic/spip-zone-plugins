[(#REM) titre=Configuration du plugin «&nbsp;Autorit&#233;&nbsp;»]

[(#REM) presentation= ]

[(#REM) autoriser=webmestre ]

[(#REM) refus=Seuls les webmestres du site sont autoris&#233;s &#224; modifier ces param&#232;tres. Pour en savoir plus, voir <a href="http://www.spip-contrib.net/-Autorite-">la documentation</a>.]
[(#REM)
	TODO:

	Dommage qu'ici je ne puisse pas mettre le resultat du $message calcule
	par cfg_autorite_fonctions.php ; mais pour cela il faudrait calculer
	le squelette, or l'autoriser n'est base que sur l'analyse rapide.

	Par ailleurs comment faire multilingue si on n'evalue pas ce squelette ?
]

<!-- descriptif=

<img src='#DOSSIER_SQUELETTE/../illuminati.png' width='64' height='64' alt='Logo rigolo' style="float:#LANG_RIGHT;" />
<html>#EVAL{MESSAGE_CONFIG_AUTORISER}</html>

<a href="http://www.spip-contrib.net/-Autorite-" class="spip_out">Cf. documentation</a>
-->
#CACHE{0}


<:titre_page_config_fonctions|gros_titre{'',''}:>

[(#REM|sinon{configuration}|barre_onglets{cfg_autorite})]

<form method="post" action="#SELF"><div>[(#ENV{_cfg_}|form_hidden)]</div>



[(#REM) ------------------------ AFFICHER LES ERREURS ------------------------ ]
[(#CONFIG{autorite_erreurs}|?{#CONFIG{autorite_erreurs}|unserialize|count|>{0}|?{' '}})

	<br />

	[(#REM|debut_boite_alerte)]
	<strong><:avis_attention:></strong> Les autorisations suivantes sont d&#233;j&#224; d&#233;finies par ailleurs&nbsp;:
	<ul><li>
	<tt>
	[(#CONFIG{autorite_erreurs}|unserialize|join{'</tt></li><li><tt>'})]
	</tt>
	</li></ul>
	Le plugin &#171;&nbsp;Autorit&#233;&nbsp;&#187; ne peut pas les modifier&nbsp;; certains des r&#233;glages ci-dessous risquent par cons&#233;quent de ne pas fonctionner.
	<br />Pour r&#233;gler ce probl&#232;me, vous devrez v&#233;rifier si votre fichier <tt>mes_options.php</tt> (ou un autre plugin actif) a d&#233;fini ces fonctions.

	[(#REM|fin_boite_alerte)]

]
<?php

	// Comment gerer ca proprement ?
	$autorite_erreurs_version = array();
	if ($GLOBALS['spip_version_code'] < '1.9251') {
		$autorite_erreurs_version[] = 'auteur modere forum';
		$autorite_erreurs_version[] = 'auteur modere petition';
		$autorite_erreurs_version[] = 'auteur modifie email';
		$autorite_erreurs_version[] = 'redacteur voit stats';
		$autorite_erreurs_version[] = 'redacteur modifie mots';
	}
	if ($GLOBALS['spip_version_code'] < '1.9252') {
		// autoriser(configurer)
		$autorite_erreurs_version[] = 'configurer';
		// autoriser(backup)
		$autorite_erreurs_version[] = 'faire des sauvegardes';
		// autoriser(destroy)
		$autorite_erreurs_version[] = 'effacer la base';
	}
	if ($autorite_erreurs_version) {
		echo "Attention les choix suivants peuvent ne pas fonctionner avec votre version de SPIP&nbsp;:\n"
		. "<ul><li>\n"
		. join ("</li><li>", $autorite_erreurs_version)
		. "</li></ul>\n";
	}
?>


<br />

[(#REM|debut_cadre_trait_couleur{1,'xxx','R&#233;glage des autorisations'})]


[(#REM) ------------------------ DROITS DES AUTEURS ------------------------ ]
<fieldset>
<legend>
	Droits des auteurs
</legend>
<p>
<label><input type="checkbox" name="auteur_mod_article" [checked="(#ENV{auteur_mod_article}?{checked})"] id="auteur_mod_article" />
	<strong>Auteur modifie article</strong>&nbsp;: chaque r&#233;dacteur peut modifier les articles publi&#233;s dont il est l'auteur (et, par conséquent, mod&#233;rer le forum et la p&#233;tition associ&#233;s).
</label>

<br />

<small>
<label><input type="checkbox" name="auteur_modere_forum" [checked="(#ENV{auteur_modere_forum}|?{checked})"] [(#ENV{auteur_mod_article}|?{' disabled="disabled"'})]
/>
	<strong>Auteur mod&#232;re forum</strong>&nbsp;: chaque r&#233;dacteur peut mod&#233;rer le forum des articles dont il est l'auteur.
</label>

<br />

<label><input type="checkbox" name="auteur_modere_petition" [checked="(#ENV{auteur_modere_petition}|?{checked})"] [(#ENV{auteur_mod_article}|?{' disabled="disabled"'})]
/>
	<strong>Auteur mod&#232;re p&#233;tition</strong>&nbsp;: chaque r&#233;dacteur peut mod&#233;rer la p&#233;tition des articles dont il est l'auteur.
</label>
</small>

</fieldset>
[(#REM) Code jQuery de l'espace auteurs ; activer/desactiver le choix secondaire ]
<script type="text/javascript"><!--
	$('#auteur_mod_article')
	.bind('change', function() {
		var on = $(this).is(':checked');
		$(this)
		.parents('fieldset')
		.find('input')
			.not(this)
			.attr('disabled', on ? 'disabled' : '')
		.end();
	})
	if ($('#espace_wiki option[@selected]').length == 0)
		$('#espace_wiki_qui').hide();
// --></script>



[(#REM) ---------------------- DROITS DES REDACTEURS -------------------- ]

<fieldset>
<legend>
	Droits des r&#233;dacteurs
</legend>
<p>

<label><input type="checkbox" name="auteur_mod_email" [checked="(#ENV{auteur_mod_email}|?{checked})"] />
	<strong>R&#233;dacteur modifie email</strong>&nbsp;: chaque r&#233;dacteur peut modifier son email sur sa fiche d'informations personnelles.
</label>

<br />

<label><input type="checkbox" name="redacteur_mod_article" [checked="(#ENV{redacteur_mod_article}|?{checked})"] />
	<strong>R&#233;dacteur modifie propos&#233;s</strong>&nbsp;: chaque r&#233;dacteur peut modifier un article propos&eacute; &#224; la publication, m&ecirc;me s'il n'en est pas auteur.
</label>


</p>


<label><strong>Mots-cl&#233;s&nbsp;:</strong> qui peut cr&#233;er et &#233;diter les mots-cl&#233;s&nbsp;:
<br />
<select name="editer_mots">
	<option value="0">Les administrateurs complets</option>
	<option value="1"[ selected="(#ENV{editer_mots}|=={1}|?{selected})"]>Tous les administrateurs (y compris restreints)</option>
	<option value="2"[ selected="(#ENV{editer_mots}|=={2}|?{selected})"]>Tous les r&#233;dacteurs</option>
</select>
</label>


<p>
<label><input type="checkbox" name="redacteurs_voirstats" [checked="(#ENV{redacteurs_lire_stats}?{checked})"] />
	<strong>R&#233;dacteur voit stats</strong>&nbsp;: les r&#233;dacteurs peuvent visualiser les statistiques.
</label>

</p>

</fieldset>


[(#REM) -------------------- CRAYONS -------------------------]
<fieldset>
	<legend>Crayons</legend>
	<small><strong>Attention.</strong> Les r&#233;glages ci-dessous ne peuvent fonctionner que si vous utilisez un plugin proposant une interface d'&#233;dition (comme par exemple <a href="http://www.spip-contrib.net/Les-Crayons">les Crayons</a>).
	</small>

[(#REM)
	L'auteur d'un forum caracterise par son id_auteur, c'est deja pas mal ;
	pour des auteurs anonymes, il faudrait leur poser un cookie qui leur
	ouvrirait ce droit tant que le cookie vit (donc, TODO).
]
	<p>
	<label><strong>Forums&nbsp;:</strong> qui peut modifier le contenu des forums&nbsp;:
	<br />
	<select name="editer_forums">
	<option value="0">Personne (valeur par d&#233;faut)</option>
	<option value="1"[ selected="(#ENV{editer_forums}|=={1}|?{selected})"]>Le webmestre</option>
	<option value="2"[ selected="(#ENV{editer_forums}|=={2}|?{selected})"]>Les administrateurs</option>
	<option value="3"[ selected="(#ENV{editer_forums}|=={3}|?{selected})"]>L'auteur du message, pendant une heure [s'il s'est enregistr&#233;]</option>
	<option value="4"[ selected="(#ENV{editer_forums}|=={4}|?{selected})"]>L'auteur du message, ad vitam [s'il s'est enregistr&#233;]</option>
	</select>
	</p>

[(#REM)
	Pour les signataires c'est plus dur, car a priori pas d'id_auteur :
	il faudra absolument un cookie specialise
]
	<p>
	<label><strong>Signatures&nbsp;:</strong> qui peut modifier les signatures des p&#233;titions&nbsp;:
	<br />
	<select name="editer_forums">
	<option value="0">Personne (valeur par d&#233;faut)</option>
	<option value="1"[ selected="(#ENV{editer_forums}|=={1}|?{selected})"]>Le webmestre</option>
	<option value="2"[ selected="(#ENV{editer_forums}|=={2}|?{selected})"]>Les administrateurs</option>
<!--
	<option value="2"[ selected="(#ENV{editer_signatures}|=={2}|?{selected})"]>Le signataire, pendant une heure [s'il s'est enregistr&#233;]</option>
	<option value="3"[ selected="(#ENV{editer_signatures}|=={3}|?{selected})"]>le signataire, ad vitam</option>
-->
	</select>
	</label>
	</p>

</fieldset>


[(#REM) ------------------------ ESPACE WIKI ------------------------ ]
<fieldset>
<legend>
	Espace wiki
</legend>

<p>
<label>
Choisissez ci-dessous un secteur &#224; traiter comme un wiki, c'est-&#224;-dire &#233;ditable par tous depuis l'espace public (&#224; condition d'avoir une interface, par exemple les crayons)&nbsp;:

<br />


#SET{selected,#CONFIG{autorite/espace_wiki,'',''}}
<select name="espace_wiki[]" multiple="multiple" size="5" id="espace_wiki">
<BOUCLE_rmul(RUBRIQUES){racine}{tout}{par num titre, titre}>
	<option value="#ID_RUBRIQUE"[(#ID_RUBRIQUE|in_array{#GET{selected}}|?{' selected="selected"'})]>
	#TITRE
	</option>
</BOUCLE_rmul>
</select>

<small><br />(vous pouvez s&#233;lectionner plusieurs secteurs avec la touche shift)
<br /><a onclick="$('#espace_wiki').find('option').attr('selected', false).end().trigger('change');">x</a> tout d&#233;selectionner</small>

</label>
</p>

<p id="espace_wiki_qui">
Voulez-vous ouvrir ce wiki &mdash; au-del&#224; des administrateurs&nbsp;:
<br />
<label><input type="checkbox" name="espace_wiki_redacteurs" [checked="(#ENV{espace_wiki_redacteurs}|?{checked})"] /> aux r&#233;dacteurs du site&nbsp;;
</label>
<br />
<label><input type="checkbox" name="espace_wiki_visiteurs" [checked="(#ENV{espace_wiki_visiteurs}|?{checked})"] /> aux visiteurs enregistr&#233;s&nbsp;;
</label>
<br />

<label><input type="checkbox" name="espace_wiki_anonyme" [checked="(#ENV{espace_wiki_anonyme}|?{checked})"] /> &#224; tous les visiteurs du site.
</label>

<label><small><br />&nbsp; &nbsp; <input type="checkbox" name="espace_wiki_rubrique_anonyme" [checked="(#ENV{espace_wiki_anonyme}|?{#ENV{espace_wiki_rubrique_anonyme}|?{checked}})"] /> les visiteurs anonymes peuvent cr&#233;er de nouvelles pages.
</small></label>

</p>

</fieldset>

[(#REM) Code jQuery de l'espace wiki ; plier/deplier la moderation ]
<script type="text/javascript"><!--
	$('#espace_wiki')
	.bind('change', function() {
		if (parseInt(this.value))
			$('#espace_wiki_qui:hidden').slideDown('slow');
		else
			$('#espace_wiki_qui:visible').slideUp('slow');
	})
	if ($('#espace_wiki option[@selected]').length == 0)
		$('#espace_wiki_qui').hide();
// --></script>


[(#REM) ---------------------- CONFUGURATION DU SITE -------------------- ]

<fieldset>
<legend>
	Configuration du site
</legend>
<p>
<label>Qui peut <strong>modifier la configuration</strong> du site&nbsp;?
<select name="configurer">
	<option value=""[ selected="(#ENV{configurer}|?{'',selected})"]>Tous les administrateurs</option>
	<option value="webmestre"[ selected="(#ENV{configurer}|=={webmestre}|?{selected})"]>Le webmestre</option>
</select>
</label>
</p>


<p>
<label>Qui peut effectuer des <strong>sauvegardes</strong>&nbsp;?
<select name="backup">
	<option value=""[ selected="(#ENV{backup}|=={''}|?{selected})"]>Tous les administrateurs (y compris restreints)</option>
	<option value="admin"[ selected="(#ENV{backup}|=={admin}|?{selected})"]>Les administrateurs</option>
	<option value="webmestre"[ selected="(#ENV{backup}|=={webmestre}|?{selected})"]>Le webmestre</option>
	<option value="non"[ selected="(#ENV{backup}|=={non}|?{selected})"]>Personne</option>
</select>
</p>

<p>
<label>Qui peut <strong>effacer</strong> la base de donn&#233;es du site&nbsp;?
<select name="destroy">
	<option value=""[ selected="(#ENV{destroy}|?{'',selected})"]>Les administrateurs</option>
	<option value="webmestre"[ selected="(#ENV{destroy}|=={webmestre}|?{selected})"]>Le webmestre</option>
	<option value="non"[ selected="(#ENV{destroy}|=={non}|?{selected})"]>Personne</option>
</select>
<br /><small>L'option recommand&#233;e est &#171;&nbsp;personne&nbsp;&#187;, l'option standard de SPIP est &#171;&nbsp;les administrateurs&nbsp;&#187; (mais avec une v&#233;rification par FTP).</small>
</p>

</fieldset>


[(#REM) ------------------------ BOUTON OK ------------------------ ]
<div>
<input style="float:#LANG_RIGHT;" type="submit" name="_cfg_ok" value="<:OK:>" class="fondo" />
<!--
<input type="reset" value="<:Reset:>" class="fondo" />
<input type="submit" name="_cfg_delete" value="<:Supprimer:>" class="fondo" />
-->
</div>


[(#REM|sinon{1}|fin_cadre_trait_couleur)]

</form>


