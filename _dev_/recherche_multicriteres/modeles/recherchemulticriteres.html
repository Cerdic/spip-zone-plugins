######################################################################
# RECHERCHE MULTI-CRITERES                                           #
# Auteur: Dominique (Dom) Lepaisant - Stephanie De Nadaï - Fev 2008  #
# Adaptation de la contrib de Paul Sanchez - Netdeveloppeur          #
# http://www.netdeveloppeur.com                                      #
# Ce programme est un logiciel libre distribue sous licence GNU/GPL. #
# Pour plus de details voir le fichier COPYING.txt                   #
######################################################################
[(#REM) #INSERT_HEAD n'est pas utile]

[(#REM) On recupere l'id rubrique et on lui attribue 0 s'il n'existe pas ]
<B_rmc_rubrique><BOUCLE_rmc_rubrique(RUBRIQUES){id_rubrique}> </BOUCLE_rmc_rubrique>
	#SET{idrub,#ID_RUBRIQUE}
</B_rmc_rubrique>
	#SET{idrub,0}
<//B_rmc_rubrique>

<BOUCLE_principale(SPIP_RMC_RUBS_GROUPES){id_rubrique=#GET{idrub}}{0,1}>

<BOUCLE_format(SPIP_RMC_RUBS_GROUPES_CONF)>
	[(#GET{idrub}|!={0}|?{#SET{nbcol,#COLONNE_RUB},#SET{nbcol,#COLONNE}})]
	[(#GET{idrub}|!={0}|?{#SET{taille,#TAILLE_POLICE_RUB},#SET{taille,#TAILLE_POLICE}})]
	[(#GET{idrub}|!={0}|?{#SET{coul,#COULEUR_POLICE_RUB},#SET{coul,#COULEUR_POLICE}})]
	[(#GET{idrub}|!={0}|?{#SET{bord,#COULEUR_BORDURE_RUB},#SET{bord,#COULEUR_BORDURE}})]
</BOUCLE_format>

<form action="spip.php?page=rec_mc_result" method="post" id="form_mc" name="form_mc">
	<input type="hidden" name="id_rubrique" value="#GET{idrub}" />
	<div class="multicriteres" style="color:[(#GET{coul})]">
		<h2><:rmc:titre_page_admin:></h2>
	</div>
	<fieldset>
		<legend><:rmc:liste_mots:></legend>
		<p><em><:rmc:aide_select_multi:></em></p>
		<div class="liste_mc" style="color:#GET{coul}; background-color:#GET{bord}">

			[(#REM) On recherche les groupes de mots attribues à la rubrique en cours ou au secteur]
			<BOUCLE_rmc_groupesparrubrique(SPIP_RMC_RUBS_GROUPES){id_rubrique=#GET{idrub}}>
				<div> 
					<p>
					<BOUCLE_groupes(GROUPES_MOTS){id_groupe}{par titre}>
					<label for="#TITRE">#TITRE</label>
					</p>
					<select name="idmot[]" id="#TITRE" multiple="multiple" class="sel_mc">
						[(#REM) On boucle sur les mots du groupe]
						<BOUCLE_mots(MOTS){id_groupe}{par titre}>
						[(#REM) on cherche si le mot est exclu]
						<B_mots_exclus><BOUCLE_mots_exclus(SPIP_RMC_MOTS_EXCLUS){id_rubrique=#GET{idrub}}{id_mot_exclu=#ID_MOT}>
						</BOUCLE_mots_exclus></B_mots_exclus>
						[(#REM) titre du mot]
						<option value="#_mots:ID_MOT">#_mots:TITRE </option>
						<//B_mots_exclus>
						</BOUCLE_mots>
					</select>
					</BOUCLE_groupes>
				</div>
				[(#REM)ici, on peut ajouter un <br avec un style "clear:both;" conditionné au nb de colonnes]
			</BOUCLE_rmc_groupesparrubrique>
		</div>
	</fieldset>
	<fieldset class="options_mc">
		<legend><:rmc:options_recherche:></legend>
		<p>
			<label for="nbjour"><:rmc:articles_date:></label>
			<select id="nbjour" name="nbjour">
				<option value="0" selected="selected">- <:rmc:tous:></option>
				<option value="7">- 7 <:rmc:jours:></option>
				<option value="30">- 1 <:rmc:mois:></option>
				<option value="9O">- 3 <:rmc:mois:></option>
				<option value="365">- 12 <:rmc:mois:></option>
			</select>
		</p>
			
		[(#GET{idrub}|!={0}|?{<p><label for="onlyrub"><:rmc:limiter_recherche_rub:><input type="checkbox" value="1" name="onlyrub" id="onlyrub" /></label></p>,''})]
				
		<p>
			<label for="allword"><:rmc:mots_tous_presents:>
			<input type="checkbox" value="1" id="allword" name="allword" /></label>
		</p>	
	</fieldset>
	<p>
		<input type="hidden" value="#GET{idrub}" name="rubnum" />
		<input type="submit" value="Envoyer" class="button_mc" />
		<input type="reset" name="annuler" value="Annuler" class="submit button_mc" />
	</p>
</form>
</BOUCLE_principale>