<div class = "affichage">
<?php 
	$aux = "";
	$var_user = array();
	$auteur = array();
	//liste d'elements a afficher
	foreach(lire_config('inscription2') as $cle => $val) {
		//Si la $cle est marqué pour être affichée mais pas modifiable
		if($val!='' and ereg("^.+_fiche$", $cle)){ 
			$aux = str_replace("_fiche", "", $cle);
			if($aux == 'username' or $aux == 'nom' or $aux == 'email')
				if($aux == 'username')
					$auteur['login'] = "0";
				else
					$auteur[$aux] = "0";
			else
				$var_user[$aux] = "0";
		}elseif($val!='' and ereg("^.+_fiche_mod$", $cle)){ //champ modifiable
			$aux = str_replace("_fiche_mod", "", $cle);
			if($aux == 'username' or $aux == 'nom'or $aux == 'email'){
				if($aux == 'username')
					$auteur['login'] = "1";
				else
					$auteur[$aux] = "1";
			}else
				$var_user[$aux] = "1";
		}
	}
	if(is_array($var_user)){
		$aux = join(', ',array_keys($var_user));
		$aux = spip_query("SELECT $aux FROM spip_auteurs_elargis WHERE id_auteur = ".$GLOBALS['auteur_session']['id_auteur'] );
		$aux = spip_fetch_array($aux);
	}
	if(is_array($auteur)){
		$aux2 = join(', ',array_keys($auteur));
		$aux2 = spip_query("SELECT $aux2 FROM spip_auteurs WHERE id_auteur = ".$GLOBALS['auteur_session']['id_auteur'] );
		$aux2 = spip_fetch_array($aux2);
	}
	if(!is_array($aux) and !is_array($aux2)){
		echo _T('inscription2:erreur_user_not_found');
		return;
	}
	$id = $GLOBALS['auteur_session']['id_auteur'];
	if(is_array($aux2)){
		foreach($aux2 as $cle => $val){
			echo '<div><strong>'._T('inscription2:'.$cle).' : </strong>';
			if($auteur[$cle]=="1")
				echo '<span class="crayon spip_auteurs-'.$cle.'-'.$id.' ">'.$val.'</span></div>';  
			else 
				echo '<span>'.$val.'</span></div>';  
		}
	}
	if(is_array($aux)){
		foreach($aux as $cle => $val){
			echo '<div><strong>'._T('inscription2:'.$cle).' : </strong>';
			if($var_user[$cle]=="1")
				echo '<span class="crayon spip_auteurs_elargis-'.$cle.'-'.$id.' ">'.$val.'</span></div>';  
			else 
				echo '<span>'.$val.'</span></div>';  
		}
	}
?>
</div>