#CACHE{0}
#HTTP_HEADER{Content-Type: text/plain; charset=#CHARSET}
[(#REM)

	Menu de selection d'auteurs

	La reponse est en text simple, elle sera exploitee par jquery.autocomplete.js

]
[(#REM)
	Eliminer d'abord les auteurs deja lies a l'article
]
<BOUCLE_e(AUTEURS spip_auteurs_liens){id_objet}{objet}{tout}{doublons} />
#SET{resultats, #ARRAY}
[(#REM) Chercher les auteurs correspondant a la requete ]
<BOUCLE_s(AUTEURS){tout}{nom LIKE %(#ENV{q})%}{0,20}{par nom}{doublons}>
[(#SET{resultats, [(#GET{resultats}|push{[(#ARRAY{label,[(#NOM*|textebrut|entites_html)],value,[(#ID_AUTEUR)]})]})]})]
</BOUCLE_s>[(#REM) 
Si aucun, on recherche dans le login
]<BOUCLE_s1(AUTEURS){tout}{login LIKE (#ENV{q})%}{0,20}{par nom}{doublons}>
[(#SET{resultats, [(#GET{resultats}|push{[(#ARRAY{label,[(#NOM*|textebrut|entites_html)],value,[(#ID_AUTEUR)]})]})]})]
</BOUCLE_s1>
<//B_s1>
<//B_s>
[(#GET{resultats}|json_encode)]
#FILTRE{trim}