#CACHE{0}
#HTTP_HEADER{Content-Type: text/plain; charset=#CHARSET}
[(#REM)

	Menu de selection d'auteurs

	La reponse est en json, elle sera exploitee par jquery.autocomplete.js
	
	On élimine d'abors les auteurs liés à l'objet
	Puis on cherche les auteurs restants correspondant à la requète
	Si pas d'auteurs, on recherche dans le login
	
	On encode la réponse en json

]<BOUCLE_e(AUTEURS spip_auteurs_liens){id_objet}{objet}{tout}{doublons} />
[(#SET{resultats, #ARRAY})]
<BOUCLE_s(AUTEURS){tout}{nom LIKE %(#ENV{q})%}{0,20}{par nom}{doublons}>
[(#SET{resultats, [(#GET{resultats}|push{[(#ARRAY{label,[(#NOM*|textebrut|entites_html)],value,[(#ID_AUTEUR)]})]})]})]
</BOUCLE_s><BOUCLE_s1(AUTEURS){tout}{login LIKE (#ENV{q})%}{0,20}{par nom}{doublons}>
[(#SET{resultats, [(#GET{resultats}|push{[(#ARRAY{label,[(#NOM*|textebrut|entites_html)],value,[(#ID_AUTEUR)]})]})]})]
</BOUCLE_s1>
<//B_s1>
<//B_s>
[(#GET{resultats}|json_encode)]
#FILTRE{trim}