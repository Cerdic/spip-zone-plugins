[(#REM)
	Permet de modifier le statut des albums
	Paramètres d'inclusion :
		objet = album
		id_objet = id_album
		statut
		exclus = liste des statuts à ne pas afficher
		retour = url de retour après validation
][(#REM)
	inclus dans /prive/objets/liste/albums.html
]
#CACHE{0} 

#SET{statuts_tous,#ARRAY{
	prepa,preparer, 
	prop,proposer,
	publie,publier,
	refuse,refuser,
	poubelle,supprimer}}								[(#REM) tous les statuts et leur actions associées ]
#SET{statuts_objet, #ENV{objet}|objet_info{statut_textes_instituer}|array_keys}		[(#REM) statuts de l'objet déclarés en base ]
[(#ENV{exclus}|?{
	#SET{statuts, #GET{statuts_objet}|array_flip|array_diff_key{#ENV{exclus}|array_flip}|array_flip},
	#SET{statuts, #GET{statuts_objet}}
})]											[(#REM) statuts de l'objet moins éventuellement ceux exclus ]
#SET{statuts_coord, #ARRAY}								[(#REM) indice attribué à chaque statut ]
<BOUCLE_coord(DATA){source table, #GET{statuts}}>
#SET{statuts_coord, #GET{statuts_coord}|array_merge{#ARRAY{#VALEUR,#COMPTEUR_BOUCLE|moins{1}}}}
</BOUCLE_coord>

[(#REM) calcul des tailles et positions des puces
        repris de /ecrire/inc/puce-statut.php ]

#SET{unit,	12}	[(#REM) 8->largeur image + 4->padding ]
#SET{margin,	4}	[(#REM) marge gauche + droite ]
#SET{zero,	3}	[(#REM) 1->bordure + margin/2 + 2->padding ][(#REM) réajusté au pifomètre ! ]

#SET{nb_statuts, #GET{statuts}|count}
#SET{decalage, #GET{zero}|plus{#GET{unit}|mult{#GET{statuts_coord}|table_valeur{#STATUT}}}}
#SET{width, #GET{unit}|mult{#GET{nb_statuts}}|plus{#GET{margin}}}

<span class='puce_objet albums'>

	<BOUCLE_autorisation(CONDITION){si #AUTORISER{modifier,#OBJET,#ID_OBJET}}>

	<span class='puce_objet_fixe'>
	[(#CHEMIN_IMAGE{#VAL{puce-}|concat{#GET{statuts_tous}|table_valeur{#STATUT}}|concat{-8.png}}|balise_img{'','statut'})]
	</span>

	<span class='puce_objet_popup' style="[width: (#GET{width})px;][ margin-left: -(#GET{decalage})px;]">
	<BOUCLE_statuts_popup(DATA){source table, #GET{statuts}}>
	[(#SET{message,#CLE|!={publie}|et{#EVAL{_request('message')}|!={statut}}|?{#VAL{<:confirm_changer_statut:>},''}})]
	#SET{action, #GET{statuts_tous}|table_valeur{#VALEUR}}
	#SET{titre, #ENV{objet}|objet_info{statut_textes_instituer}|table_valeur{#VALEUR}|_T}
	[(#BOUTON_ACTION{
		[(#CHEMIN_IMAGE{#VAL{puce-}|concat{#GET{statuts_tous}|table_valeur{#VALEUR}}|concat{-8.png}}|balise_img{#GET{titre}})],
		[(#URL_ACTION_AUTEUR{edition_albums, #GET{action}/#VALEUR/[(#ENV{id_objet})], #ENV{retour,#SELF}|parametre_url{clic,oui}})], link button ajax,
		#GET{message}})]
	</BOUCLE_statuts_popup>
	</span>

	</BOUCLE_autorisation>

	<span class='puce_objet_fixe'>
	[(#CHEMIN_IMAGE{#VAL{puce-}|concat{#GET{statuts_tous}|table_valeur{#STATUT}}|concat{-8.png}}|balise_img{'','statut'})]
	</span>
	<//B_autorisation>

</span>
