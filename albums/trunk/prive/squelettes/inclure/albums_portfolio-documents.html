[(#REM) 
	Formulaire d'ajout de documents
	Fork du squelette du plugin 'medias',
	-> Ajout d'un identifiant unique aux blocs illustrations, portfolio et documents (+script)
][(#REM)
	inclus dans le squelette /prive/objets/liste/albums_lies.html
]

#SET{nbdocs,0}
#SET{suffixe,#ENV{objet}#ENV{id_objet}}
<div id="portfolios" class="[(#GET{suffixe})]">
[(#REM) D'abord les images illustration]
<B_illustrations>
<h3><span class="image_loading"></span><:medias:info_illustrations:></h3>
<div class="liste_items documents" id="illustrations[_(#GET{suffixe})]">
[<p class="pagination">(#PAGINATION)</p>]
<BOUCLE_illustrations(DOCUMENTS documents_liens types_documents){inclus=image}{mode=image}{id_objet}{objet}{par num titre,date,id_document}{pagination 50}{statut?}>
	#MODELE{document_desc,id_document,id_objet,objet}
</BOUCLE_illustrations>
[(#TOTAL_BOUCLE|>{20}|oui)<p class="pagination">#PAGINATION</p>]
[(#BOUTON_ACTION{<:medias:lien_tout_enlever:>,#URL_ACTION_AUTEUR{dissocier_document,#ID_OBJET-#OBJET-I/image,#SELF|ancre_url{illustrations}},'ajax tout_supprimer'})]
</div>
#SET{nbdocs,#GET{nbdocs}|plus{#GRAND_TOTAL}}
</B_illustrations>

[(#REM) puis les images du portfolio]
<B_portfolio>
<h3><:medias:info_portfolio:></h3>
<div class="liste_items documents" id="portfolio[_(#GET{suffixe})]">
[<p class="pagination">(#PAGINATION)</p>]
<BOUCLE_portfolio(DOCUMENTS documents_liens types_documents){inclus=image}{mode=document}{id_objet}{objet}{par num titre,date,id_document}{pagination 50}{statut?}>
	#MODELE{document_desc,id_document,id_objet,objet}
</BOUCLE_portfolio>
[(#TOTAL_BOUCLE|>{20}|oui)<p class="pagination">#PAGINATION</p>]
[(#BOUTON_ACTION{<:medias:lien_tout_enlever:>,#URL_ACTION_AUTEUR{dissocier_document,#ID_OBJET-#OBJET-I/document,#SELF|ancre_url{portfolio}},'ajax tout_supprimer'})]
</div>
#SET{nbdocs,#GET{nbdocs}|plus{#GRAND_TOTAL}}
</B_portfolio>

[(#REM) puis les documents]
<B_documents>
<h3><:medias:info_documents:></h3>
<div class="liste_items documents" id="documents[_(#GET{suffixe})]">
[<p class="pagination">(#PAGINATION)</p>]
<BOUCLE_documents(DOCUMENTS documents_liens types_documents){inclus!=image}{mode!=vignette}{id_objet}{objet}{par num titre,date,id_document}{pagination 50}{statut?}>
	#MODELE{document_desc,id_document,id_objet,objet}
</BOUCLE_documents>
[(#TOTAL_BOUCLE|>{20}|oui)<p class="pagination">#PAGINATION</p>]
[(#BOUTON_ACTION{<:medias:lien_tout_enlever:>,#URL_ACTION_AUTEUR{dissocier_document,#ID_OBJET-#OBJET-D/document,#SELF|ancre_url{documents}},'ajax tout_supprimer'})]
</div>
#SET{nbdocs,#GET{nbdocs}|plus{#GRAND_TOTAL}}
</B_documents>

<script type="text/javascript">/*<![CDATA[*/
[(#REM) var multifile='[(#CHEMIN{javascript/jquery.multifile.js}|texte_script)]'; ]
[(#REM) [(#INCLURE{javascript/medias_edit.js}|compacte{js})] ]
[(#OBJET|=={rubrique}|et{#EVAL{_AJAX}}|et{#GET{nbdocs}|=={1}}|oui)
if (window.jQuery) jQuery('#navigation .box.info').ajaxReload();]
function check_reload_page(){
	var reload = false;
	if($('#illustrations[_(#GET{suffixe})]').length && !$('#illustrations[_(#GET{suffixe})] .item').length){
		$('#illustrations[_(#GET{suffixe})]').remove();reload = true;
	}
	if($('#portfolio[_(#GET{suffixe})]').length && !$('#portfolio[_(#GET{suffixe})] .item').length){
		$('#portfolio[_(#GET{suffixe})]').remove();reload = true;
	}
	if($('#documents[_(#GET{suffixe})]').length && !$('#documents[_(#GET{suffixe})] .item').length){
		$('#documents[_(#GET{suffixe})]').remove();reload = true;
	}
	if (reload) {
		jQuery('[#portfolios.(#GET{suffixe})]').ajaxReload();
		jQuery('[#nb_documents_(#GET{suffixe})]').ajaxReload();
		jQuery('#navigation .box.info').ajaxReload();
	}
}
if (window.jQuery) jQuery(function(){onAjaxLoad(check_reload_page);});
/*]]>*/</script>
</div>
