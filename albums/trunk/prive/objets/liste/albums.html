[(#REM)
	Affiche une liste d'albums
	Paramètres d'inclusion :
		liste (texte)		associer ou galerie ou selecteur
		exclus (tableau d'ids)
		statut (texte)		prepa|publie|poubelle
		navigation (liste)	parents, divers, contenus
		header (liste)		tri, thead
		colonnes (liste)	statut, logo, id, titre, infos, descriptif, contenu
		actions (liste)		associer, dissocier, choisir
][(#REM)
	inclus dans /prive/squelettes/contenu/albums_afficher_complement_objet.html
	inclus dans /prive/squelettes/inclure/albums_navigation_listes.html
]

[(#SET{defaut_tri,#ARRAY{
	date,-1,
	id_album,1,
	multi titre,1
}})
]
[(#REM) Variables indiquant les éléments à afficher ]
<BOUCLE_header(DATA){liste #ENV{header}}>
#SET{#VAL{header_}|concat{#VALEUR},oui}
</BOUCLE_header>
<BOUCLE_colonnes(DATA){liste #ENV{colonnes}}>
#SET{#VAL{colonne_}|concat{#VALEUR},oui}
</BOUCLE_colonnes>
<BOUCLE_actions(DATA){liste #ENV{actions}}>
#SET{#VAL{action_}|concat{#VALEUR},oui}
</BOUCLE_actions>
#SET{liste, #ENV{liste,galerie}}


<B_albums>
#ANCRE_PAGINATION

<div class='entete clearfix[ (#GET{liste})]'>
	[<h2>(#ENV{recherche}|?{
		[(#GRAND_TOTAL|singulier_ou_pluriel{album:info_resultat_recherche_un,album:info_resultat_recherche_plus})],
		[(#GRAND_TOTAL|objet_afficher_nb{album})]
	})</h2>]
	[(#GRAND_TOTAL|>{#ENV{nb}}|ou{#ENV{recherche}}|ou{#GET{header_recherche}}|oui)
		#FORMULAIRE_RECHERCHE_ECRIRE{#SELF,ajax}
	]
</div>

<div class="[(#GET{liste}|!={galerie}|oui)liste-objets ][(#GET{liste})]">

	[(#ENV{liste}|=={galerie}|ou{#GET{header_tri}}|oui)
	<navigation>
	[(#GET{header_tri}|oui)
	<div class='pagination tri'>
		[(#TRI{'>', #CHEMIN_IMAGE{tri-asc-16.png}|balise_img{<:par_tri_croissant:>}})]
		[(#TRI{'<', #CHEMIN_IMAGE{tri-desc-16.png}|balise_img{<:par_tri_decroissant:>}})]
		[(#TRI{id_album, <:medias:par_id:>})]
		[(#TRI{date, <:medias:par_date:>})]
		[(#TRI{titre, <:medias:par_titre:>})]
	</div>
	]
	[(#ENV{liste}|=={galerie}|oui) [<div class='pagination'>(#PAGINATION{prive})</div>] ]
	</navigation>
	]

	<table class="[(#GET{liste}|!={galerie}|oui)spip liste]">

		[(#GET{header_thead}|oui)
		<thead>
			[(#GET{colonne_statut}|oui)		<th></th> ]
			[(#GET{colonne_logo}|oui)		<th><:album:heading_logo:></th> ]
			[(#GET{colonne_id}|oui)			<th class='id'><:album:heading_id:></th> ]
			[(#GET{colonne_titre}|oui)		<th><:album:heading_titre:></th> ]
			[(#GET{colonne_infos}|oui)		<th><:album:heading_infos:></th> ]
			[(#GET{colonne_descriptif}|oui)		<th><:album:heading_descriptif:></th> ]
			[(#GET{colonne_contenu}|oui)		<th><:album:heading_contenu:></th> ]
			[(#GET{colonne_liaison}|oui)		<th><:album:heading_liaison:></th> ]
			[(#ENV{actions}|oui)			<th></th> ]
		</thead>
		]

		<tbody>
		<BOUCLE_albums(ALBUMS liens){contenu?}{orphelins?}{id_album !IN #ENV{exclus}}{auteurs_liens.id_auteur?}{id_mot?}{objet?}{statut ?== #ENV{statut}}{vu?}{recherche?}{tri #ENV{par,date},#GET{defaut_tri}}{pagination #ENV{nb,10}}>
		<tr>

			[(#REM) STATUT ]
			[(#GET{colonne_statut}|oui)
			<td class='statut'>[(#STATUT|puce_statut{album,#ID_ALBUM})]</td>
			]

			[(#REM) LOGO ]
			[(#GET{colonne_logo}|oui)
			<td class='logo'>
			[(#INCLURE{fond=prive/squelettes/inclure/inc-albums_logo, id_album, taille=#ENV{logo,48}})]
			</td>
			]

			[(#REM) ID ]
			[(#GET{colonne_id}|oui)
			<td class='id'>
			[(#ID_ALBUM)]
			</td>
			]

			[(#REM) TITRE ]
			[(#GET{colonne_titre}|oui)
			<td class='titre principale'>
				[<a href="[(#ID_ALBUM|generer_url_entite{album})]">(#TITRE)</a>]
			</td>
			]

			[(#REM) INFOS (vue compacte : titre, statut, numéro  et nb documents) ]
			[(#GET{colonne_infos}|oui)
			<td class='infos'>
			<ul>
				[<li>
				[(#GET{vu}|=={oui}|oui)
					[(#CHEMIN_IMAGE{vu-16-10.png}|balise_img{<:medias:document_vu:>}|inserer_attribut{title,<:medias:document_vu:>})]
				]
				<strong>(#TITRE)</strong>
				</li>]
				[<li>
					(#STATUT|puce_statut{album,#ID_ALBUM})
					[&nbsp;N°(#ID_ALBUM)]
				</li>]
				[<li>
					(#GET{colonne_contenu}|non)
					[(#INCLURE{fond=prive/squelettes/inclure/inc-albums_nb_documents, id_album})]
				</li>]
			</ul>
			</td>
			]

			[(#REM) DESCRIPTIF ]
			[(#GET{colonne_descriptif}|oui)
			<td class='descriptif'>
				[(#ENV{liste}|=={associer}|?{
					#DESCRIPTIF|couper{60},
					#DESCRIPTIF|couper{100}
				})]
			</td>
			]

			[(#REM) CONTENU détaillé ]
			[(#GET{colonne_contenu}|oui)
			<td class='contenu'>
			[(#ID_ALBUM|album_contenu{liste_detaillee})]
			</td>
			]

			[(#REM) LIAISON ]
			[(#GET{colonne_liaison}|oui)
			<td class='liaison'>
			[(#ID_ALBUM|album_liaison{liste_compacte_icone})]
			</td>
			]

			[(#REM) ACTIONS : associer, choisir ]
			[(#ENV{actions}|oui)
			<td class='action'>
			[(#GET{action_associer}|oui)
				[(#INCLURE{fond=prive/squelettes/inclure/inc-albums_boutons_actions,
					bouton=associer,
					id_album=#ID_ALBUM}{env})]
			]
			[(#GET{action_choisir}|oui)
				[(#SAISIE{radio,[radio(#ID_ALBUM)]})]
			]
			</td>
			]

		</tr>
		</BOUCLE_albums>
		</tbody>
	</table>

	[<p class='pagination'>(#PAGINATION{prive})</p>]

</div>
</B_albums>

<div class='entete bas clearfix[ (#GET{liste})]'>
	[(#ENV{recherche}|oui)
		<:album:info_resultat_recherche_aucun:>
	]
	[(#ENV{recherche}|non)
		#SET{nb_albums_total,#VAL{album}|table_objet_sql|sql_countsel{#ARRAY{objet=album}}}
		[(#GET{nb_albums_total}=={0}|oui)
			<:album:info_aucun_album:>
		]
		[(#GET{nb_albums_total}=={0}|non)
			[(#ENV{liste}|=={associer}|oui) <:album:info_aucun_album_supplementaire:> ]
			[(#ENV{liste}|=={galerie}|oui) <:album:info_aucun_album_criteres:> ]
		]
	]
	[(#GRAND_TOTAL|>{#ENV{nb}}|ou{#ENV{recherche}}|ou{#GET{afficher_recherche}}|oui)
		#FORMULAIRE_RECHERCHE_ECRIRE{#SELF,ajax}
	]
</div>

<//B_albums>
