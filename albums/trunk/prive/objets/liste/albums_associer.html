#SET{nb_pagination,#ENV{nb_pagination,10}}
[(#ENV{exclus}|!={non}|oui)
#SET{exclus,#ENV{objet_source}|lister_objets_lies{#ENV{objet},#ENV{id_objet},#ENV{_objet_lien}}}
]

<div class="liste[ (#ENV{classe})][ albums-(#ENV{objet,''})]">
	<B_liste_albums>

	#ANCRE_PAGINATION
	
	[(#GRAND_TOTAL|>={#ENV{nb_pagination}}|ou{#RECHERCHE}|oui)
	#FORMULAIRE_RECHERCHE_ECRIRE{#SELF,ajax}
	]
	
	[<h2>(#ENV*{titre,#GRAND_TOTAL|singulier_ou_pluriel{album:info_1_album,album:info_nb_albums}})</h2>]
	
	[(#ENV{cacher_tri}|!={oui}|oui)
	<div class='pagination tri'>
		[(#TRI{'>',#CHEMIN_IMAGE{tri-asc-16.png}|balise_img{<:par_tri_croissant:>}})]
		[(#TRI{'<',#CHEMIN_IMAGE{tri-desc-16.png}|balise_img{<:par_tri_decroissant:>}})]
		[(#TRI{id_album,<:medias:par_id:>})]
		[(#TRI{date,<:medias:par_date:>})]
		[(#TRI{titre,<:medias:par_titre:>})]
		[(#CONFIG{albums/afficher_champ_categorie}|oui)[(#TRI{categorie,<:album:label_categorie:>})]]
	</div>
	]
	
	[<div class='pagination'>(#PAGINATION{prive})</div>]

	<table>
	
		[(#ENV{cacher_thead}|!={oui}|oui)
		<thead>
			[(#ENV{cacher_statut}|!={oui}|oui) <th></th> ]
			<th><:album:heading_logo:></th>
			[(#ENV{cacher_id}|!={oui}|oui) <th class='id_album'><:album:heading_id:></th> ]
			<th><:album:heading_infos:></th>
			[(#CONFIG{albums/afficher_champ_descriptif}|oui)<th><:album:heading_descriptif:></th>]
			[(#CONFIG{albums/afficher_champ_categorie}|oui)<th><:album:heading_categorie:></th>]
			<th><:album:heading_contenu:></th>
			[(#ENV{afficher_action_associer}|=={oui}|oui) <th></th> ]
		</thead>
		]
	
		<BOUCLE_liste_albums(ALBUMS){recherche?}{tri id_album,inverse}{vu?}{statut==#ENV{statut,.*}}{orphelins?}{id_album IN #ENV{selection}}{!id_album IN #GET{exclus}}{pagination #GET{nb_pagination}}>
		[<!--(#REM) HEADER -->]
		<tr>
			
			[<!--(#REM) statut -->]
			[(#ENV{cacher_statut}|!={oui}|oui)
			<td class='statut' scope='col'>
			[(#STATUT|puce_statut{album})]
			</td>
			]
	
			[<!--(#REM) logo -->]
			<td class='logo' scope='col'>
			[(#MODELE{logo_album}{taille=50})]
			</td>
	
			[<!--(#REM) id -->]
			[(#ENV{cacher_id}|!={oui}|oui)
			<td class='id' scope='col'>
			#ID_ALBUM
			</td>
			]
	
			[<!--(#REM) informations (titre, nb documents etc.) -->]
			[(#ENV{afficher_infos_compactes}|!={oui}|oui)
			<td class='infos' scope='col'>
			<h3><a href="#URL_ECRIRE{album,id_album=#ID_ALBUM}">
			[(#RANG). ][(#TITRE|sinon{<em><:album:texte_sans_titre:></em>})]
			</a></h3>
			</td>
			]
			[(#ENV{afficher_infos_compactes}|=={oui}|oui)
			<td class='infos' scope='col'>
			<h3><a href="#URL_ECRIRE{album,id_album=#ID_ALBUM}">
			[(#RANG). ][(#TITRE|sinon{<em><:album:texte_sans_titre:></em>})]
			</a></h3>
			<h4>[(#STATUT|puce_statut{album})][ NÂ°(#ID_ALBUM)]</h4>
			</td>
			]
	
			[<!--(#REM) descriptif -->]
			[(#CONFIG{albums/afficher_champ_descriptif}|oui)
			<td class='descriptif' scope='col'>
			[(#DESCRIPTIF|couper{200})]
			[(#DESCRIPTIF|non) - ]
			</td>
			]
		
			[<!--(#REM) categorie -->]
			[(#CONFIG{albums/afficher_champ_categorie}|oui)
			<td class='categorie' scope='col'>
			[(#CATEGORIE)]
			[(#CATEGORIE|non) - ]
			</td>
			]
	
			[<!--(#REM) contenu -->]
			<td class='contenu' scope='col'>
			#SET{medias,#ARRAY}
			<BOUCLE_documents(DOCUMENTS){id_album}{tout}>
			[(#GET{medias}|find{#MEDIA}|non) #SET{medias,#GET{medias}|push{#MEDIA}} ]
			</BOUCLE_documents>
			[(#CHEMIN_IMAGE{icone-vide-16.png}|balise_img{album:info_album_vide})]
			<//B_documents>
			<ul>
			<BOUCLE_medias(DATA){liste #GET{medias}}>
			<BOUCLE_compteur(DOCUMENTS){id_album}{tout}{media=#VALEUR} />
			<li>
			[(#SET{fichier_image, [media-(#VALEUR|strtolower)-16.png]})]
			[(#VALEUR|=={'file'}|oui) #SET{fichier_image,'document-16.png'}]
			[(#CHEMIN_IMAGE{#GET{fichier_image}}|balise_img{#VALEUR})]
			[(#GRAND_TOTAL|singulier_ou_pluriel{[(#VAL{medias:un_}|concat{#VALEUR})],[(#VAL{medias:des_}|concat{#VALEUR}|concat{s})]})]
			</li>
			<//B_compteur>
			</BOUCLE_medias>
			</ul>
			</td>
	
			[(#ENV{afficher_action_associer}|=={oui}|oui)
			<td class='action'>
			[(#BOUTON_ACTION{
				[(#CHEMIN_IMAGE{ajouter-16.png}|balise_img{'+'})],
				#URL_ACTION_AUTEUR{editer_liens_albums,lier/#ID_ALBUM/#OBJET/#ID_OBJET,#ENV{redirect}},
				'ajax associer link'
			})]
			</td>
			]
	
		</tr>

		</BOUCLE_liste_albums>
		
	</table>
	
	<div class='nettoyeur'></div>

	[<div class='pagination'>(#PAGINATION{prive})</div>]
	</B_liste_albums>
	
	<div class='nettoyeur'></div>
	
	#BOITE_OUVRIR
	<BOUCLE_test_albums(ALBUMS){!id_album IN #GET{exclus}}{tout}{0,1}>
	<:album:info_aucun_album_criteres:>
	</BOUCLE_test_albums>
	<:album:info_aucun_album_supplementaire:>
	<//B_test_albums>
	#BOITE_FERMER
	
	<//B_liste_albums>
</div>
