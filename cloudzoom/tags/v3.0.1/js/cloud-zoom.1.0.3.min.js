(function(b){function t(b){for(var d=1;d<arguments.length;d++)b=b.replace("%"+(d-1),arguments[d]);return b}function J(e,d){var c=b("img",e),g=null,l=null,h=null,m=null,n=null,q=null,u,E=0,x,y,F=0,G=0,A=0,B=0,H=0,C,D,p=this,I;setTimeout(function(){if(null===l){var c=e.width();e.parent().append(t('<div style="width:%0px;position:absolute;top:75%;left:%1px;text-align:center" class="cloud-zoom-loading" >Loading...</div>',c/3,c/2-c/6));b("cloud-zoom-loading",e.parent()).css("opacity",.5)}},200);this.removeBits=
function(){h&&(h.remove(),h=null);m&&(m.remove(),m=null);n&&(n.remove(),n=null);null!==q&&(q.remove(),q=null);b(".cloud-zoom-loading",e.parent()).remove()};this.destroy=function(){e.data("zoom",null);l&&(l.unbind(),l.remove(),l=null);g&&(g.remove(),g=null);this.removeBits()};this.fadedOut=function(){g&&(g.remove(),g=null);this.removeBits()};this.controlLoop=function(){if(h){var b=C-c.offset().left-.5*x>>0,f=D-c.offset().top-.5*y>>0;0>b?b=0:b>c.outerWidth()-x&&(b=c.outerWidth()-x);0>f?f=0:f>c.outerHeight()-
y&&(f=c.outerHeight()-y);h.css({left:b,top:f});h.css("background-position",-b+"px "+-f+"px");F=b/c.outerWidth()*u.width>>0;G=f/c.outerHeight()*u.height>>0;B+=(F-B)/d.smoothMove;A+=(G-A)/d.smoothMove;g.css("background-position",-(B>>0)+"px "+(-(A>>0)+"px"))}E=setTimeout(function(){p.controlLoop()},30)};this.init2=function(b,c){H++;1===c&&(u=b);2===H&&this.init()};this.init=function(){b(".cloud-zoom-loading",e.parent()).remove();var k=b("<div class='mousetrap' style='background-image:url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)'></div>");
l=e.parent().append(k).find(":last");l=b(".mousetrap",e.parent());l.css({width:c.outerWidth(),height:c.outerHeight(),top:0,left:0,position:"absolute",zIndex:9999});l.bind("mousemove",this,function(b){C=b.pageX;D=b.pageY});l.bind("mouseleave",this,function(b){clearTimeout(E);h&&h.fadeOut(299);m&&m.fadeOut(299);n&&n.fadeOut(299);g.fadeOut(300,function(){p.fadedOut()});return!1});l.bind("mouseenter",this,function(f){C=f.pageX;D=f.pageY;I=f.data;g&&(g.stop(!0,!1),g.remove());f=d.adjustX;var k=d.adjustY,
p=c.outerWidth(),z=c.outerHeight(),v=d.zoomWidth,w=d.zoomHeight;"auto"==d.zoomWidth&&(v=p);"auto"==d.zoomHeight&&(w=z);var r=e.parent();switch(d.position){case "top":k-=w;break;case "right":f+=p;break;case "bottom":k+=z;break;case "left":f-=v;break;case "inside":v=p;w=z;break;default:r=b("#"+d.position),r.length?(v=r.innerWidth(),w=r.innerHeight()):(r=e,f+=p,k+=z)}g=r.append(t('<div id="cloud-zoom-big" class="cloud-zoom-big" style="display:none;position:absolute;left:%0px;top:%1px;width:%2px;height:%3px;background-image:url(\'%4\');z-index:99;"></div>',
f,k,v,w,u.src)).find(":last");g=b(".cloud-zoom-big",r);c.attr("title")&&d.showTitle&&(g.append(t('<div class="cloud-zoom-title">%0</div>',c.attr("title"))),b(".cloud-zoom-title",g).css("opacity",d.titleOpacity));b.browser.msie&&7>b.browser.version&&(q=b('<iframe frameborder="0" src="#"></iframe>').css({position:"absolute",left:f,top:k,zIndex:99,width:v,height:w}).insertBefore(g));g.fadeIn(500);h&&(h.remove(),h=null);x=c.outerWidth()/u.width*g.width();y=c.outerHeight()/u.height*g.height();h=e.append(t("<div class = 'cloud-zoom-lens' style='display:none;z-index:98;position:absolute;width:%0px;height:%1px;'></div>",
x,y)).find(":last");h=b(".cloud-zoom-lens",e);l.css("cursor",h.css("cursor"));f=!1;d.tint&&(h.css("background",'url("'+c.attr("src")+'")'),m=e.append(t('<div class="cloud-zoom-tint" style="display:none;position:absolute; left:0px; top:0px; width:%0px; height:%1px; background-color:%2;" />',c.outerWidth(),c.outerHeight(),d.tint)).find(":last"),m=b(".cloud-zoom-tint",e),m.css("opacity",d.tintOpacity),f=!0,m.fadeIn(500));d.softFocus&&(h.css("background",'url("'+c.attr("src")+'")'),e.append(t('<div class="cloud-zoom-soft" style="position:absolute;display:none;top:2px; left:2px; width:%0px; height:%1px;" />',
c.outerWidth()-2,c.outerHeight()-2,d.tint)),n=b(".cloud-zoom-soft",e),n.css("background",'url("'+c.attr("src")+'")'),n.css("opacity",.5),f=!0,n.fadeIn(500));f||h.css("opacity",d.lensOpacity);"inside"!==d.position&&h.fadeIn(500);I.controlLoop()})};var k=new Image;b(k).load(function(){p.init2(this,0)});k.src=c.attr("src");k=new Image;b(k).load(function(){p.init2(this,1)});k.src=e.attr("href")}var q=document.getElementsByTagName("script"),K=q[q.length-1].src.lastIndexOf("/");q[q.length-1].src.slice(0,
K);b(document).ready(function(){b(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()});b.fn.CloudZoom=function(e){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(d){}this.each(function(){eval("var\ta = {"+b(this).attr("rel")+"}");var d=a;if(b(this).is(".cloud-zoom")){b(this).css({position:"relative",display:"block"});b("img",b(this)).css({display:"block"});"wrap"!=b(this).parent().attr("id")&&b(this).wrap('<div id="wrap" style="top:0px;z-index:9999;position:relative;"></div>');var c=b.extend({},
b.fn.CloudZoom.defaults,e);c=b.extend({},c,d);b(this).data("zoom",new J(b(this),c))}else b(this).is(".cloud-zoom-gallery")&&(c=b.extend({},d,e),b(this).data("relOpts",c),b(this).bind("click",b(this),function(c){var d=c.data.data("relOpts");b("#"+d.useZoom).data("zoom").destroy();b("#"+d.useZoom).attr("href",c.data.attr("href"));b("#"+d.useZoom+" img").attr("src",c.data.data("relOpts").smallImage);b("#"+c.data.data("relOpts").useZoom).CloudZoom();return!1}))});return this};b.fn.CloudZoom.defaults=
{zoomWidth:"auto",zoomHeight:"auto",position:"right",tint:!1,tintOpacity:.5,lensOpacity:.5,softFocus:!1,smoothMove:3,showTitle:!0,titleOpacity:.5,adjustX:0,adjustY:0}})(jQuery);