<div class="ajax">
<div class='formulaire_spip formulaire_editer formulaire_#FORM formulaire_#FORM-#ENV{id_almanach,nouveau}'>
	[(#REM) titre pour un formulaire en plusieurs étapes
	<h3> Création d'un almanach et importation d'événements : étape #ENV{_etape}/#ENV{_etapes}</h3>]
	<h3> Création d'un almanach et importation d'événements</h3>
	[<p class="reponse_formulaire reponse_formulaire_ok">(#ENV**{message_ok})</p>]
	[<p class="reponse_formulaire reponse_formulaire_erreur">(#ENV*{message_erreur})</p>]

[(#REM) on définit un tableau vide, on rajoute dynamiquement les ensembles clé-valeur sortis de la boucle sur le groupe de mot-clés Type. On l'utilise ensuite pour la selection des mots clés par une saisie. on fait la même chose pour les ressources]
#SET{tableau_type_evenement, #ARRAY}

[(#REM)Attention astuce inside pour que les clés numériques ne soient pas réindexées, on inverse l'ordre d'intégration dasn le tableau et ensuite on flip le tableau]
<BOUCLE_groupe(GROUPES_MOTS){titre=Type}>
<BOUCLE_mots(MOTS){id_groupe}>
#SET{tableau_type_evenement, #GET{tableau_type_evenement}|array_merge{#ARRAY{#TITRE,#ID_MOT}}
</BOUCLE_mots>
</BOUCLE_groupe>
[(#SET{tableau_type_evenement, #GET{tableau_type_evenement}|array_flip})]

[(#REM)même chose avec les ressources mais on conditionne à la présence du plugin orr]
#SET{tableau_ressources,#ARRAY}
<BOUCLE_ressources(ORR_RESSOURCES){si #PLUGIN{orr}| }>
#SET{tableau_ressources, #GET{tableau_ressources}|array_merge{#ARRAY{#ORR_RESSOURCE_NOM,#ID_ORR_RESSOURCE}}
</BOUCLE_ressources>
[(#SET{tableau_ressources, #GET{tableau_ressources}|array_flip})]

	[<p class="reponse_formulaire reponse_formulaire_ok">(#ENV**{message_ok})</p>]
	[<p class="reponse_formulaire reponse_formulaire_erreur">(#ENV**{message_erreur})</p>]

	[(#ENV{editable})
	<form method='post' action='#ENV{action}' enctype='multipart/form-data'><div>
		#ACTION_FORMULAIRE{#ENV{action}}
		<input type='hidden' name='id_almanach' value='#ENV{id_almanach}' />
		<input type='hidden' name='id_article' value='#ENV{id_article}' />
		<ul>

			[(#SAISIE{input, titre, obligatoire=oui,
				label=<:almanach:label_titre:>,
				explication=<:almanach:explication_titre:> })]

			[(#SAISIE{url, url, obligatoire=oui,
				label=<:almanach:label_url:>,
				explication=<:almanach:explication_url:>,
				verifier => array('type' => 'url',),
			})]

			[(#SAISIE{input, id_article, obligatoire=oui,
				label=<:agenda:evenement_article:>,
				explication=<:almanach:explication_id_article:>
			})]

			[(#SAISIE{selection, id_mot, obligatoire=oui,
				label=<:seminaire:choix_mot:>,
				explication=<:almanach:type_evenement:>,
				datas=#GET{tableau_type_evenement}	
			})]

			[(#SAISIE{selection, id_orr_ressource, obligatoire=non,
				afficher_si='@resa_auto@=="on"',
				label=<:almanach:resa_auto:>,
				explication=<:almanach:choix_salle:>,
				datas=#GET{tableau_ressources}	
			})]
		</ul>
		[(#REM) ajouter les saisies supplementaires : extra et autre, a cet endroit ]
		<!--extra-->
		[(#REM)<p class="boutons"><input type='submit' class='submit' value='Suivant' /></p> ça ce sera quand le formulaire en deux parties sera correct pour l'instant on fait un formulaire en une partie]
		<p class="boutons"><input type='submit' class='submit' value='<:bouton_enregistrer:>' /></p>
	</div></form>
	]
</div>
</div>
