<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Siou:  Fichier source de odb_commun/inc-pdf-table.php</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Page&nbsp;principale</span></a></li>
    <li class="current"><a href="files.html"><span>Fichiers</span></a></li>
    <li><a href="dirs.html"><span>Répertoires</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;Rechercher&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_d85a68ddeac050d85549308ca402191f.html">odb_commun</a></div>
<h1>inc-pdf-table.php</h1><a href="inc-pdf-table_8php.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 session_start();
<a name="l00003"></a>00003 <span class="keywordflow">if</span>(isset($_GET['reset'])) session_destroy();
<a name="l00004"></a>00004 <span class="comment">//on rcupere le tableau  afficher, $data, dans la session</span>
<a name="l00005"></a>00005 <span class="comment">//tableau de la forme $data[$num_row]=$row</span>
<a name="l00006"></a><a class="code" href="inc-pdf-table_8php.html#bda6e620e7f5d772657555a6b23ed449">00006</a> <a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>=$_GET['pdf'];
<a name="l00007"></a><a class="code" href="inc-pdf-table_8php.html#3f1f14bbce42f11ded67b8b79ead3941">00007</a> <span class="keywordflow">if</span>(<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>=='') die('Veuillez pr&amp;<a class="code" href="inc-pdf-table_8php.html#1c3d7fb9d2f4e0216017175154061426">eacute</a>;ciser le nom du tableau pdf &amp;<a class="code" href="inc-pdf-table_8php.html#6d44afa8f0dc1b03e9806f207b06180c">agrave</a>; g&amp;<a class="code" href="inc-pdf-table_8php.html#1c3d7fb9d2f4e0216017175154061426">eacute</a>;n&amp;eacute;rer');
<a name="l00008"></a>00008 <a class="code" href="inc-ezpdf_8php.html#6efc15b5a2314dd4b5aaa556a375c6d6">$data</a>=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['data'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];
<a name="l00009"></a>00009 <a class="code" href="inc-pdf-convocation_8php.html#da57e7bb7c152edad18fe2f166188691">$title</a>=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['titre'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];       <span class="comment">// titre au-dessus du tableau</span>
<a name="l00010"></a>00010 $pied=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['pied'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];         <span class="comment">// pied de page, rpt en bas de chaque page</span>
<a name="l00011"></a>00011 <span class="keywordflow">if</span>($pied=='') $pied=<a class="code" href="inc-pdf-convocation_8php.html#da57e7bb7c152edad18fe2f166188691">$title</a>;
<a name="l00012"></a>00012 <a class="code" href="inc-pdf-resultats_8php.html#a0acedd535e0b46a4fffc4b147d3f545">$cols</a>=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['cols'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];         <span class="comment">// colonnes  inclure dans la table</span>
<a name="l00013"></a>00013 $format=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['format'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];     <span class="comment">// format du fichier pdf (par dfaut A3 paysage)</span>
<a name="l00014"></a>00014 <span class="keywordflow">if</span>(!is_array($format)) $format=array('taille'=&gt;'A3', 'orientation'=&gt;'landscape');
<a name="l00015"></a>00015 <a class="code" href="inc-pdf-attestations_8php.html#011800c63ece4cbbfa77136a20607023">$options</a>=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['options'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];   <span class="comment">// options (facultatives) du tableau </span>
<a name="l00016"></a>00016 <span class="keywordflow">if</span>(!is_array($option))
<a name="l00017"></a>00017         <span class="keywordflow">if</span>($format['taille']=='A4' &amp;&amp; $format['orientation']!='landscape')
<a name="l00018"></a>00018                 <a class="code" href="inc-pdf-attestations_8php.html#011800c63ece4cbbfa77136a20607023">$options</a>=array('maxWidth'=&gt;575);
<a name="l00019"></a>00019 <a class="code" href="inc-pdf-attestations_8php.html#f24aefa35fa703a1521c8145fe8fa082">$infos</a>=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['infos'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];       <span class="comment">// informations du fichier pdf (titre, auteur, date creation...)</span>
<a name="l00020"></a>00020 <span class="keywordflow">if</span>(!is_array(<a class="code" href="inc-pdf-attestations_8php.html#f24aefa35fa703a1521c8145fe8fa082">$infos</a>)) <a class="code" href="inc-pdf-attestations_8php.html#f24aefa35fa703a1521c8145fe8fa082">$infos</a>=array('Title'=&gt;<a class="code" href="inc-pdf-convocation_8php.html#da57e7bb7c152edad18fe2f166188691">$title</a>,'Author'=&gt;'SIS/DOB via SIOU<span class="charliteral">','</span>CreationDate'=&gt;date(<span class="stringliteral">"d/m/Y"</span>));
<a name="l00021"></a>00021 $encryption=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['encryption'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];     <span class="comment">// protection par mot de passe </span>
<a name="l00022"></a>00022 $post=<a class="code" href="resultats__ajournes__par__centre_8php.html#082ba331d3cc45e8443c96d1131d5599">$_SESSION</a>['post'][<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>];         <span class="comment">// texte a afficher a la fin du document pdf</span>
<a name="l00023"></a>00023 
<a name="l00024"></a>00024 <span class="comment">//error_reporting(E_WARNING);</span>
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="comment">//echo "&lt;pre&gt;";print_r($_SESSION);die('&lt;/pre&gt;');</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <a class="code" href="inc-fichiers_8php.html#58f5fd0b9d70bc87295be959c7bc176a">$debug</a>=<span class="keyword">false</span>;
<a name="l00029"></a>00029 <span class="keywordflow">if</span>(<a class="code" href="inc-fichiers_8php.html#58f5fd0b9d70bc87295be959c7bc176a">$debug</a>) {
<a name="l00030"></a>00030         echo(<a class="code" href="inc-pdf-attestations_8php.html#bda6e620e7f5d772657555a6b23ed449">$pdfG</a>);
<a name="l00031"></a>00031         <span class="comment">//print_r($_SESSION);</span>
<a name="l00032"></a>00032         <span class="keywordflow">foreach</span>(array('title<span class="charliteral">','</span>pied<span class="charliteral">','</span>cols<span class="charliteral">','</span>options<span class="charliteral">','</span>infos<span class="charliteral">','</span>format<span class="charliteral">','</span>encryption<span class="charliteral">','</span>data') as $var) {
<a name="l00033"></a>00033                 echo <span class="stringliteral">"&lt;hr size='1'/&gt;&lt;pre&gt;&lt;b&gt;$var&lt;/b&gt; "</span>;print_r($$var);echo <span class="stringliteral">"&lt;/pre&gt;\n"</span>;
<a name="l00034"></a>00034         }
<a name="l00035"></a>00035         die(<a class="code" href="odb__ref_8php.html#509f04652b5e1b2d2b9e6bc121a87e50">OK</a>.' - fin du debug');
<a name="l00036"></a>00036 }
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <a class="code" href="inc-ezpdf_8php.html#4dbe106434277d49b9fac7b1dc8602eb">$pdf_dir</a>='../odb_contrib/ezpdf/';
<a name="l00039"></a>00039 include <a class="code" href="inc-ezpdf_8php.html#4dbe106434277d49b9fac7b1dc8602eb">$pdf_dir</a>.'<span class="keyword">class</span>.ezpdf.php';     <span class="comment">// inclusion du code de la bibliothque</span>
<a name="l00040"></a>00040 <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a> =&amp; <span class="keyword">new</span> Cezpdf($format['taille'],$format['orientation']);
<a name="l00041"></a>00041 <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;selectFont(<a class="code" href="inc-ezpdf_8php.html#4dbe106434277d49b9fac7b1dc8602eb">$pdf_dir</a>.'fonts/Helvetica');
<a name="l00042"></a>00042 <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;ezStartPageNumbers(12, 12, 8, 'right', <span class="stringliteral">"$pied - Page {PAGENUM}/{TOTALPAGENUM} - SIS/DOB"</span>);
<a name="l00043"></a>00043 <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;addInfo(<a class="code" href="inc-pdf-attestations_8php.html#f24aefa35fa703a1521c8145fe8fa082">$infos</a>);
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">// make the table</span>
<a name="l00046"></a>00046 <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;ezTable($data,<a class="code" href="inc-pdf-resultats_8php.html#a0acedd535e0b46a4fffc4b147d3f545">$cols</a>,<a class="code" href="inc-pdf-convocation_8php.html#da57e7bb7c152edad18fe2f166188691">$title</a>,<a class="code" href="inc-pdf-attestations_8php.html#011800c63ece4cbbfa77136a20607023">$options</a>);
<a name="l00047"></a>00047 <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;ezSetDy(-10);
<a name="l00048"></a>00048 <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;ezText($post);
<a name="l00049"></a>00049 <span class="comment">// do the output, this is my standard testing output code, adding ?d=1</span>
<a name="l00050"></a>00050 <span class="comment">// to the url puts the pdf code to the screen in raw form, good for</span>
<a name="l00051"></a>00051 <span class="comment">// checking</span>
<a name="l00052"></a>00052 <span class="comment">// for parse errors before you actually try to generate the pdf file.</span>
<a name="l00053"></a>00053 <span class="keywordflow">if</span>(isset($_GET[<span class="charliteral">'d'</span>])) <a class="code" href="inc-ezpdf_8php.html#0cf5dd496d9f5ff1edf00d234771dcfe">$d</a>=$_GET[<span class="charliteral">'d'</span>];
<a name="l00054"></a>00054 <span class="keywordflow">if</span> (isset(<a class="code" href="inc-ezpdf_8php.html#0cf5dd496d9f5ff1edf00d234771dcfe">$d</a>) &amp;&amp; <a class="code" href="inc-ezpdf_8php.html#0cf5dd496d9f5ff1edf00d234771dcfe">$d</a>){
<a name="l00055"></a>00055    <a class="code" href="inc-ezpdf_8php.html#6b9aead899bafbd080a6faef6b5650ad">$pdfcode</a> = <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;output(1);
<a name="l00056"></a>00056    <a class="code" href="inc-ezpdf_8php.html#6b9aead899bafbd080a6faef6b5650ad">$pdfcode</a> = str_replace(<span class="stringliteral">"\n"</span>,<span class="stringliteral">"\n&lt;br&gt;"</span>,htmlspecialchars(<a class="code" href="inc-ezpdf_8php.html#6b9aead899bafbd080a6faef6b5650ad">$pdfcode</a>));
<a name="l00057"></a>00057    echo '&lt;html&gt;&lt;body&gt;';
<a name="l00058"></a>00058    echo trim(<a class="code" href="inc-ezpdf_8php.html#6b9aead899bafbd080a6faef6b5650ad">$pdfcode</a>);
<a name="l00059"></a>00059    echo '&lt;/body&gt;&lt;/html&gt;';
<a name="l00060"></a>00060 } <span class="keywordflow">else</span> {
<a name="l00061"></a>00061    <span class="keywordflow">if</span>(is_array($encryption)) <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;setEncryption($encryption['user'], $encryption['owner'], $encryption['action']);
<a name="l00062"></a>00062 <span class="comment">//   $pdf-&gt;ezStream();</span>
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 
<a name="l00065"></a>00065    <a class="code" href="inc-ezpdf_8php.html#6b9aead899bafbd080a6faef6b5650ad">$pdfcode</a> = <a class="code" href="inc-ezpdf_8php.html#964ee5ee597c515cbb4dad2f14054cb4">$pdf</a>-&gt;ezOutput();
<a name="l00066"></a>00066    $pdf_fic=<span class="stringliteral">"pdf/siou-"</span>.date(<span class="charliteral">'Y'</span>).<span class="stringliteral">"_$pdfG.pdf"</span>;
<a name="l00067"></a>00067    $fp=fopen($pdf_fic,'wb');
<a name="l00068"></a>00068    fwrite($fp,<a class="code" href="inc-ezpdf_8php.html#6b9aead899bafbd080a6faef6b5650ad">$pdfcode</a>);
<a name="l00069"></a>00069    fclose($fp);
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         echo <span class="stringliteral">"&lt;A HREF='$pdf_fic'&gt;Cliquez ici pour lire le fichier $pdf_fic&lt;/a&gt;\n"</span>;
<a name="l00072"></a>00072         echo <span class="stringliteral">"&lt;script&gt;document.location='$pdf_fic'&lt;/script&gt;"</span>;
<a name="l00073"></a>00073    <span class="comment">//session_destroy();</span>
<a name="l00074"></a>00074 }
<a name="l00075"></a>00075 
<a name="l00076"></a>00076 ?&gt;
</pre></div><hr size="1"><address style="text-align: right;"><small>Généré le Mon Mar 17 22:53:00 2008 pour Siou par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
