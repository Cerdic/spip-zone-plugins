<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Siou:  Fichier source de odb_notes/exec/odb_notes2.php</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Généré par Doxygen 1.5.3 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Page&nbsp;principale</span></a></li>
    <li class="current"><a href="files.html"><span>Fichiers</span></a></li>
    <li><a href="dirs.html"><span>Répertoires</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;Rechercher&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
  </ul>
</div>
<div class="nav">
<a class="el" href="dir_8304c97eecfdedd1018accbc24201d58.html">odb_notes</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_944f8b8909d831464407f99f29c5403f.html">exec</a></div>
<h1>odb_notes2.php</h1><a href="odb__notes2_8php.html">Aller à la documentation de ce fichier.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 session_start ();
<a name="l00003"></a>00003 include_spip ('inc/presentation');
<a name="l00004"></a>00004 include_spip ('inc/config');
<a name="l00005"></a>00005 include_spip ('inc/charsets');
<a name="l00006"></a>00006 
<a name="l00007"></a><a class="code" href="odb__notes2_8php.html#c24ff0f08fb134ed2d43c99826787bc2">00007</a> define ('<a class="code" href="odb__affiche__csv_8php.html#c24ff0f08fb134ed2d43c99826787bc2">DIR_ODB_COMMUN</a>', _DIR_PLUGINS.<span class="stringliteral">"odb/odb_commun/"</span>);
<a name="l00008"></a>00008 include_once (<a class="code" href="odb__affiche__csv_8php.html#c24ff0f08fb134ed2d43c99826787bc2">DIR_ODB_COMMUN</a>.'inc-odb.php');
<a name="l00009"></a>00009 <span class="comment">//include_once(DIR_ODB_COMMUN.'inc-html.php');</span>
<a name="l00010"></a>00010 include_once (<a class="code" href="odb__affiche__csv_8php.html#c24ff0f08fb134ed2d43c99826787bc2">DIR_ODB_COMMUN</a>.'inc-referentiel.php');
<a name="l00011"></a>00011 include_once ('inc-bdd.php');
<a name="l00012"></a>00012 include_once ('inc-traitements.php');
<a name="l00013"></a><a class="code" href="odb__notes2_8php.html#6ba61f298a687e8e6095795392b1c95b">00013</a> define ('<a class="code" href="odb__notes_8php.html#6ba61f298a687e8e6095795392b1c95b">ODB_BIO_OPERATEUR</a>', 'Operateur de saisie');
<a name="l00014"></a><a class="code" href="odb__notes2_8php.html#97b8c6303969d0488dd928447cf9fa13">00014</a> define ('<a class="code" href="odb__notes_8php.html#97b8c6303969d0488dd928447cf9fa13">ID_MATIERE_EF1</a>', -1);
<a name="l00015"></a><a class="code" href="odb__notes2_8php.html#da2834629114affadacc37cdf87c3dde">00015</a> define ('<a class="code" href="odb__notes_8php.html#da2834629114affadacc37cdf87c3dde">ID_MATIERE_EF2</a>', -2);
<a name="l00016"></a><a class="code" href="odb__notes2_8php.html#f29ef43f72bda613ccc526c3881f2434">00016</a> define ('<a class="code" href="odb__notes_8php.html#f29ef43f72bda613ccc526c3881f2434">ID_MATIERE_EPS</a>', -3);
<a name="l00017"></a><a class="code" href="odb__notes2_8php.html#14b1ddd5185370cebc79b413fe982f91">00017</a> define ('<a class="code" href="odb__notes_8php.html#14b1ddd5185370cebc79b413fe982f91">LIB_MATIERE_EF1</a>', '&amp;Eacute;preuve Faculative 1');
<a name="l00018"></a><a class="code" href="odb__notes2_8php.html#44bb74f0b10b6ea05ff85ecaf145c8ea">00018</a> define ('<a class="code" href="odb__notes_8php.html#44bb74f0b10b6ea05ff85ecaf145c8ea">LIB_MATIERE_EF2</a>', '&amp;Eacute;preuve Faculative 2');
<a name="l00019"></a><a class="code" href="odb__notes2_8php.html#9ca1ed191fcdd936b992ce72239444f1">00019</a> define ('<a class="code" href="odb__notes_8php.html#9ca1ed191fcdd936b992ce72239444f1">LIB_MATIERE_EPS</a>', '&amp;Eacute;ducation Physique et Sportive');
<a name="l00020"></a>00020 
<a name="l00021"></a>00021 setlocale (LC_TIME, <span class="stringliteral">"fr_FR"</span>);
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="odb__notes2_8php.html#76943fe274cc25e0034e2847e5c5c667">00023</a> global <a class="code" href="inc-fichiers_8php.html#58f5fd0b9d70bc87295be959c7bc176a">$debug</a>, <a class="code" href="odb__notes_8php.html#08287d6c1cec513971047d1fcf674a86">$PDF_A3_PAYSAGE</a>, <a class="code" href="odb__notes_8php.html#76943fe274cc25e0034e2847e5c5c667">$PDF_A3_PORTRAIT</a>;
<a name="l00024"></a><a class="code" href="odb__notes2_8php.html#85ae3e64cd40e9564adceb010085e9dd">00024</a> $debug = <span class="keyword">false</span>;
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 define (<a class="code" href="odb__ref_8php.html#509f04652b5e1b2d2b9e6bc121a87e50">OK</a>, <span class="stringliteral">"&lt;SPAN style='color:#3C3;font-weight:bold;'&gt;[OK]&lt;/SPAN&gt;"</span>);
<a name="l00027"></a>00027 define (<a class="code" href="odb__ref_8php.html#e56b96c4dfcced36887ba02c496c40a3">KO</a>, <span class="stringliteral">"&lt;SPAN style='color:#C33;font-weight:bold;'&gt;[KO]&lt;/SPAN&gt;"</span>);
<a name="l00028"></a>00028 
<a name="l00029"></a><a class="code" href="odb__notes2_8php.html#1cbfdf9e5b7c1865870fc4785736076c">00029</a> $PDF_A3_PAYSAGE=array(
<a name="l00030"></a>00030     'rowgap' = &gt;125,    <span class="comment">//taille de l'espace entre le texte et les traits du tableau</span>
<a name="l00031"></a>00031     'width' = &gt;1150,
<a name="l00032"></a>00032     'maxWidth' = &gt;1150);
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 $PDF_A3_PORTRAIT = array (
<a name="l00035"></a>00035 <span class="comment">//'shadecol' =&gt; array(0.1,0.8,0.5),</span>
<a name="l00036"></a>00036                            'rowgap' = &gt;125,     <span class="comment">//taille de l'espace entre le texte et les traits du tableau</span>
<a name="l00037"></a>00037                            'width' = &gt;575, 'maxWidth' = &gt;575);
<a name="l00038"></a>00038 
<a name="l00044"></a>00044 function
<a name="l00045"></a><a class="code" href="odb__notes2_8php.html#477841e21bacf8c8b922a082b668fb2d">00045</a> <a class="code" href="odb__notes_8php.html#477841e21bacf8c8b922a082b668fb2d" title="exécuté automatiquement par le plugin au chargement de la page ?exec=odb_notes">exec_odb_notes</a> ()
<a name="l00046"></a>00046 {
<a name="l00047"></a>00047   $pass = <a class="code" href="inc-odb_8php.html#43f6ce2d81c74dfbf4c8ea6c54cf321b" title="Recupere les parametres ODB.">getParametresODB</a> ('code');
<a name="l00048"></a>00048   global $connect_statut, $connect_toutes_rubriques, $debug, <a class="code" href="odb__import_8php.html#73292a99bd31040ba09df650515015d1">$txt_gauche</a>,
<a name="l00049"></a>00049     $txt_droite, <a class="code" href="odb__affiche__csv_8php.html#0a3ebee356c79fa7521c28283a372f76">$txt_debug</a>, $tab_referentiel, <a class="code" href="inc-referentiel_8php.html#32f56aa14be3aa7fa481441d26b8bca5">$odb_referentiel</a>, <a class="code" href="inc-referentiel_8php.html#b3984efda359cc31d6cfe267131a7ff9">$odb_mapping</a>;
<a name="l00050"></a>00050   <span class="keywordflow">if</span> (isset ($_REQUEST['reset']))
<a name="l00051"></a>00051     session_destroy ();
<a name="l00052"></a>00052 
<a name="l00053"></a>00053   include_once (<a class="code" href="odb__affiche__csv_8php.html#c24ff0f08fb134ed2d43c99826787bc2">DIR_ODB_COMMUN</a>.<span class="stringliteral">"inc-referentiel.php"</span>);
<a name="l00054"></a>00054   include_once (<a class="code" href="odb__affiche__csv_8php.html#c24ff0f08fb134ed2d43c99826787bc2">DIR_ODB_COMMUN</a>.<span class="stringliteral">"inc-regles_gestion.php"</span>);
<a name="l00055"></a>00055 
<a name="l00056"></a>00056   $tParam = <a class="code" href="inc-odb_8php.html#43f6ce2d81c74dfbf4c8ea6c54cf321b" title="Recupere les parametres ODB.">getParametresODB</a> ();
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   $tab_auteur = $GLOBALS[<span class="stringliteral">"auteur_session"</span>];
<a name="l00059"></a>00059   <a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a> = isset ($_REQUEST['annee']) ? $_REQUEST['annee'] : date (<span class="stringliteral">"Y"</span>);
<a name="l00060"></a>00060 
<a name="l00061"></a>00061   echo <span class="stringliteral">"&lt;SCRIPT SRC='"</span>.DIR_ODB_COMMUN.
<a name="l00062"></a>00062     <span class="stringliteral">"contrib/boxover/boxover.js'&gt;&lt;/SCRIPT&gt;\n"</span>;
<a name="l00063"></a>00063   $imgInfo =
<a name="l00064"></a>00064     <span class="stringliteral">"&lt;img src='"</span>.DIR_ODB_COMMUN.
<a name="l00065"></a>00065     <span class="stringliteral">"contrib/boxover/info.gif' style='vertical-align:middle'&gt;"</span>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   $r_jury = $_REQUEST['jury'];
<a name="l00068"></a>00068 
<a name="l00069"></a>00069   debut_page (_T ('Saisie des notes'), <span class="stringliteral">""</span>, <span class="stringliteral">""</span>);
<a name="l00070"></a>00070   echo <span class="stringliteral">"&lt;br /&gt;\n"</span>;
<a name="l00071"></a>00071   gros_titre (_T ('Office Du Baccalaur&amp;<a class="code" href="inc-pdf-table_8php.html#1c3d7fb9d2f4e0216017175154061426">eacute</a>;at'));
<a name="l00072"></a>00072   $tab_auteur = $GLOBALS[<span class="stringliteral">"auteur_session"</span>];
<a name="l00073"></a>00073 
<a name="l00074"></a>00074   <span class="keywordflow">if</span> ($debug)
<a name="l00075"></a>00075     {
<a name="l00076"></a>00076       echo <span class="stringliteral">"&lt;A HREF='#fin_debug'&gt;Sauter les infos de debug&lt;/A&gt;\n"</span>;
<a name="l00077"></a>00077       echo <span class="stringliteral">"_POST&lt;pre style='text-align:left;'&gt;"</span>;
<a name="l00078"></a>00078       print_r ($_POST);
<a name="l00079"></a>00079       echo <span class="stringliteral">"&lt;/pre&gt;&lt;hr/&gt;"</span>;
<a name="l00080"></a>00080       echo <span class="stringliteral">"&lt;A NAME='fin_debug'&gt;&lt;/A&gt;\n"</span>;
<a name="l00081"></a>00081     }
<a name="l00082"></a>00082 
<a name="l00083"></a>00083   debut_cadre_relief (<span class="stringliteral">""</span>, <span class="keyword">false</span>, <span class="stringliteral">""</span>, <a class="code" href="inc-pdf-attestations_8php.html#43e5b5a819fedbd12b8cf5421ba6985e">$titre</a> = _T (<span class="stringliteral">"Saisie des notes $annee"</span>));
<a name="l00084"></a>00084   <span class="comment">//debut_boite_info();</span>
<a name="l00085"></a>00085   <span class="comment">//echo '&lt;br&gt;';</span>
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   $REFERER = $_SERVER['HTTP_REFERER'];
<a name="l00088"></a>00088   $REMOTE_ADDR = $_SERVER['REMOTE_ADDR'];
<a name="l00089"></a>00089   $isPleinEcran = <span class="keyword">false</span>;
<a name="l00090"></a>00090   $isDessineCadrePrincipal = <span class="keyword">true</span>;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092   $gauche =
<a name="l00093"></a>00093     <span class="stringliteral">"&lt;IMG SRC='"</span>._DIR_PLUGIN_ODB_NOTES.
<a name="l00094"></a>00094     <span class="stringliteral">"/img_pack/logo_odb_150.png' alt='Office du bac' ALIGN='absmiddle'&gt;&lt;br/&gt;&lt;br/&gt;\n"</span>;
<a name="l00095"></a>00095   <a class="code" href="inc-odb_8php.html#bbbb7d83cb4d809eae2b31b2a3b1f556" title="Interdit l&amp;#39;acces a un utilisateur qui n&amp;#39;est pas dans le tableau $tOK.">isAutorise</a> (array ('Admin', 'Notes'));
<a name="l00096"></a>00096 
<a name="l00097"></a>00097   $tJurys = <a class="code" href="odb__notes_2exec_2inc-bdd_8php.html#2bbd012fce7c005628269134b0046665" title="Recupere un tableau de jury.">getJurys</a> ($tab_auteur['login'], <a class="code" href="inc-odb_8php.html#147d380870b3247e67b18fd9d7adf910" title="Determine le type d&amp;#39;utilisateur.">getStatutUtilisateur</a> (), <a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>);
<a name="l00098"></a>00098   <span class="keywordflow">if</span> (<a class="code" href="inc-regles__gestion_8php.html#abf23b66cd362adaa508de5bfb22706a" title="l&amp;#39;utilisateur est il admin ?">isAdmin</a> ())
<a name="l00099"></a>00099     {
<a name="l00100"></a>00100       $isAdmin = <span class="keyword">true</span>;
<a name="l00101"></a>00101       $isOperateur = <span class="keyword">false</span>;
<a name="l00102"></a>00102     }
<a name="l00103"></a>00103   <span class="keywordflow">else</span>
<a name="l00104"></a>00104     {
<a name="l00105"></a>00105       $isAdmin = <span class="keyword">false</span>;
<a name="l00106"></a>00106       $isOperateur = <span class="keyword">false</span>;
<a name="l00107"></a>00107     }
<a name="l00108"></a>00108 
<a name="l00110"></a>00110   <span class="keywordflow">if</span> ($r_jury != '' &amp;&amp; !in_array ($r_jury, $tJurys))
<a name="l00111"></a>00111     die (<a class="code" href="odb__ref_8php.html#e56b96c4dfcced36887ba02c496c40a3">KO</a>.
<a name="l00112"></a>00112          ' - Vous n\'&amp;ecirc;tes pas autoris&amp;eacute;(e) &amp;<a class="code" href="inc-pdf-table_8php.html#6d44afa8f0dc1b03e9806f207b06180c">agrave</a>; saisir le jury '.
<a name="l00113"></a>00113          $r_jury.', veuillez &lt;A HREF=<span class="stringliteral">"'.generer_url_ecrire ('odb_notes').</span>
<a name="l00114"></a>00114 <span class="stringliteral">         '"</span>&gt;recommencer&lt;/A&gt;');
<a name="l00115"></a>00115   <span class="keywordflow">if</span> (isset ($_REQUEST['imprimer']))
<a name="l00116"></a>00116     {
<a name="l00117"></a>00117       $tRefSerie = <a class="code" href="inc-referentiel_8php.html#8da6b5d71b8b85a4443092e825841479">getReferentiel</a> ('serie');
<a name="l00118"></a>00118       <span class="keywordflow">foreach</span> (array ('jury', 'serie', 'id_serie') as $col)
<a name="l00119"></a>00119         $$col = $_REQUEST[$col];
<a name="l00120"></a>00120       <span class="keywordflow">if</span> ($id_serie == '')
<a name="l00121"></a>00121         {
<a name="l00122"></a>00122           $id_serie = $tRefSerie[$serie];
<a name="l00123"></a>00123         }
<a name="l00124"></a>00124       elseif ($serie == '')
<a name="l00125"></a>00125       {
<a name="l00126"></a>00126         $serie = $tRefSerie[$id_serie];
<a name="l00127"></a>00127       }
<a name="l00128"></a>00128       $isPleinEcran = <span class="keyword">false</span>;
<a name="l00129"></a>00129       $titrePrincipal =
<a name="l00130"></a>00130         <span class="stringliteral">"Impressions pour le jury $jury s&amp;eacute;rie $serie $annee"</span>;
<a name="l00131"></a>00131       $selectJury =
<a name="l00132"></a>00132         <span class="stringliteral">"&lt;SELECT NAME='jury' class='fondo' onChange=\"document.forms['form_resultats'].submit();\"&gt;\n"</span>;
<a name="l00133"></a>00133       <span class="keywordflow">foreach</span> ($tJurys as $sJury)
<a name="l00134"></a>00134       {
<a name="l00135"></a>00135         <span class="keywordflow">if</span> (<a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a> == $sJury)
<a name="l00136"></a>00136           $selected = 'selected';
<a name="l00137"></a>00137         <span class="keywordflow">else</span>
<a name="l00138"></a>00138           $selected = '';
<a name="l00139"></a>00139         $selectJury. = <span class="stringliteral">"\t&lt;OPTION VALUE='$sJury' $selected&gt;$sJury&lt;/OPTION&gt;\n"</span>;
<a name="l00140"></a>00140       }
<a name="l00141"></a>00141       $selectJury. = <span class="stringliteral">"&lt;/SELECT&gt;\n"</span>;
<a name="l00142"></a>00142       $tSeries = <a class="code" href="odb__notes_2exec_2inc-bdd_8php.html#6c6066c6c35429378e06930dd848253c" title="Recupere le tableau des series (idSerie=&amp;gt;serie) d&amp;#39;un jury.">getSeriesFromJury</a> (<a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a>, <a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>);
<a name="l00143"></a>00143       <span class="keywordflow">if</span> (!is_array ($tSeries[<a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a>]))
<a name="l00144"></a>00144         die (<a class="code" href="odb__ref_8php.html#e56b96c4dfcced36887ba02c496c40a3">KO</a>.<span class="stringliteral">" - Aucun jury d&amp;eacute;fini pour vous en $annee"</span>);
<a name="l00145"></a>00145       $selectSerie =
<a name="l00146"></a>00146         <span class="stringliteral">"&lt;SELECT NAME='id_serie' class='fondo' onChange=\"document.forms['form_resultats'].submit();\"&gt;\n\t&lt;OPTION VALUE=''&gt;-=[S&amp;eacute;rie]=-&lt;/OPTION&gt;\n"</span>;
<a name="l00147"></a>00147       <span class="keywordflow">foreach</span> ($tSeries as $iIdSerie = &gt;$sSerie)
<a name="l00148"></a>00148       {
<a name="l00149"></a>00149         <span class="keywordflow">if</span> ($id_serie == $iIdSerie)
<a name="l00150"></a>00150           $selected = 'selected';
<a name="l00151"></a>00151         <span class="keywordflow">else</span>
<a name="l00152"></a>00152           $selected = '';
<a name="l00153"></a>00153         $selectSerie. =
<a name="l00154"></a>00154           <span class="stringliteral">"\t&lt;OPTION VALUE='$iIdSerie' $selected&gt;$sSerie&lt;/OPTION&gt;\n"</span>;
<a name="l00155"></a>00155       }
<a name="l00156"></a>00156       $selectSerie. = <span class="stringliteral">"&lt;/SELECT&gt;\n"</span>;
<a name="l00157"></a>00157       <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a> =
<a name="l00158"></a>00158         <span class="stringliteral">"&lt;table class='spip'&gt;\n&lt;form name='form_resultats' action='"</span>.
<a name="l00159"></a>00159         generer_url_ecrire ('odb_notes').
<a name="l00160"></a>00160         <span class="stringliteral">"' method='get' class='spip_xx-small'/&gt;\n"</span>.
<a name="l00161"></a>00161         <span class="stringliteral">"&lt;tr&gt;&lt;th&gt;Jury&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;\n"</span>.
<a name="l00162"></a>00162         <span class="stringliteral">"&lt;tr&gt;&lt;th&gt;$selectJury&lt;/th&gt;&lt;td&gt;&lt;input type='submit' name='ok' value='ok' class='fondo'/&gt;&lt;/td&gt;&lt;/tr&gt;\n"</span>.
<a name="l00163"></a>00163         <span class="stringliteral">"&lt;input type='hidden' name='exec' value='odb_notes'/&gt;\n"</span>.
<a name="l00164"></a>00164         <span class="stringliteral">"&lt;input type='hidden' name='imprimer' value='auto'/&gt;\n&lt;/FORM&gt;\n"</span>;
<a name="l00165"></a>00165       <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00166"></a>00166         <span class="stringliteral">"&lt;tr&gt;&lt;th colspan=2&gt;Retour aux &lt;A HREF='"</span>.
<a name="l00167"></a>00167         generer_url_ecrire ('odb_notes').
<a name="l00168"></a>00168         <span class="stringliteral">"&amp;jury=$jury&amp;annee=$annee&amp;resultats'&gt;r&amp;eacute;sultats&lt;/A&gt;&lt;/th&gt;&lt;/tr&gt;\n"</span>;
<a name="l00169"></a>00169       <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;/TABLE&gt;\n"</span>;
<a name="l00170"></a>00170       <span class="keywordflow">if</span> (isset ($tParam[<span class="stringliteral">"_delib1_$annee"</span>][$r_jury]))
<a name="l00171"></a>00171         {
<a name="l00172"></a>00172           <a class="code" href="inc-pdf-attestations_8php.html#dd57477ad14361f5834629e405ff5478">$deliberation</a> = 2;
<a name="l00173"></a>00173           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <a class="code" href="odb__notes_2exec_2inc-traitements_8php.html#99a781952cafb10b8cb8a0adda4baa6d" title="Permet aux operateurs de saisie d&amp;#39;acceder aux listes de resultat en fonction...">afficherImpressions</a> ($jury, $serie, <a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>, $tSeries);
<a name="l00174"></a>00174         }
<a name="l00175"></a>00175       <span class="keywordflow">else</span>
<a name="l00176"></a>00176         {
<a name="l00177"></a>00177           <a class="code" href="inc-pdf-attestations_8php.html#dd57477ad14361f5834629e405ff5478">$deliberation</a> = 1;
<a name="l00178"></a>00178           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00179"></a>00179             <span class="stringliteral">"Vous n'avez pas acc&amp;egrave;s aux impressions du jury $jury, veuillez choisir un autre jury svp."</span>;
<a name="l00180"></a>00180         }
<a name="l00181"></a>00181     }
<a name="l00182"></a>00182   elseif (isset ($_REQUEST['historique']))
<a name="l00183"></a>00183   {
<a name="l00185"></a>00185     $isPleinEcran = <span class="keyword">false</span>;
<a name="l00186"></a>00186     $isDessineCadrePrincipal = <span class="keyword">false</span>;
<a name="l00187"></a>00187     $titrePrincipal = <span class="stringliteral">"Historique du candidat $id"</span>;
<a name="l00188"></a>00188     <span class="keywordflow">foreach</span> (array ('<span class="keywordtype">id</span>', 'annee', 'urlRetour', 'msgRetour') as $col)
<a name="l00189"></a>00189       $$col = $_REQUEST[$col];
<a name="l00190"></a>00190     $urlRetour = urldecode ($urlRetour);
<a name="l00191"></a>00191     <span class="keywordflow">if</span> ($id != '')
<a name="l00192"></a>00192       {
<a name="l00193"></a>00193         <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <a class="code" href="odb__notes_2exec_2inc-traitements_8php.html#25aee0267595ba3fbc7413ba12e14b2e" title="Affiche l&amp;#39;historique du candidat passé en param.">afficherHistorique</a> ($id, <a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>);
<a name="l00194"></a>00194       }
<a name="l00195"></a>00195     <span class="keywordflow">else</span>
<a name="l00196"></a>00196       <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <a class="code" href="odb__ref_8php.html#e56b96c4dfcced36887ba02c496c40a3">KO</a>.<span class="stringliteral">" - Erreur inconnue - ne peut afficher l'historique\n"</span>;
<a name="l00197"></a>00197     <span class="keywordflow">if</span> ($msgRetour != '')
<a name="l00198"></a>00198       {
<a name="l00199"></a>00199         <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00200"></a>00200           <span class="stringliteral">"Navigation rapide : &lt;b&gt;&lt;A HREF='$urlRetour'&gt;$msgRetour&lt;/A&gt;&lt;/b&gt;\n&lt;br/&gt;\n"</span>;
<a name="l00201"></a>00201       }
<a name="l00202"></a>00202   }
<a name="l00203"></a>00203   elseif (isset ($_REQUEST['resultats']))
<a name="l00204"></a>00204   {
<a name="l00206"></a>00206     $tRefSerie = <a class="code" href="inc-referentiel_8php.html#8da6b5d71b8b85a4443092e825841479">getReferentiel</a> ('serie');
<a name="l00207"></a>00207     <span class="keywordflow">foreach</span> (array ('jury', 'serie', 'id_serie') as $col)
<a name="l00208"></a>00208       $$col = $_REQUEST[$col];
<a name="l00209"></a>00209     <span class="keywordflow">if</span> ($id_serie == '')
<a name="l00210"></a>00210       {
<a name="l00211"></a>00211         $id_serie = $tRefSerie[$serie];
<a name="l00212"></a>00212       }
<a name="l00213"></a>00213     elseif ($serie == '')
<a name="l00214"></a>00214     {
<a name="l00215"></a>00215       $serie = $tRefSerie[$id_serie];
<a name="l00216"></a>00216     }
<a name="l00217"></a>00217     $isPleinEcran = <span class="keyword">true</span>;
<a name="l00218"></a>00218     $titrePrincipal =
<a name="l00219"></a>00219       <span class="stringliteral">"R&amp;eacute;sultats des notes du jury $jury s&amp;eacute;rie $serie"</span>;
<a name="l00220"></a>00220     $selectJury =
<a name="l00221"></a>00221       <span class="stringliteral">"&lt;SELECT NAME='jury' class='fondo' onChange=\"document.forms['form_resultats'].id_serie.value='';document.forms['form_resultats'].submit();\"&gt;\n"</span>;
<a name="l00222"></a>00222     <span class="keywordflow">foreach</span> ($tJurys as $sJury)
<a name="l00223"></a>00223     {
<a name="l00224"></a>00224       <span class="keywordflow">if</span> (<a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a> == $sJury)
<a name="l00225"></a>00225         $selected = 'selected';
<a name="l00226"></a>00226       <span class="keywordflow">else</span>
<a name="l00227"></a>00227         $selected = '';
<a name="l00228"></a>00228       $selectJury. = <span class="stringliteral">"\t&lt;OPTION VALUE='$sJury' $selected&gt;$sJury&lt;/OPTION&gt;\n"</span>;
<a name="l00229"></a>00229     }
<a name="l00230"></a>00230     $selectJury. = <span class="stringliteral">"&lt;/SELECT&gt;\n"</span>;
<a name="l00231"></a>00231     $tSeries = <a class="code" href="odb__notes_2exec_2inc-bdd_8php.html#6c6066c6c35429378e06930dd848253c" title="Recupere le tableau des series (idSerie=&amp;gt;serie) d&amp;#39;un jury.">getSeriesFromJury</a> (<a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a>, <a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>);
<a name="l00232"></a>00232     $selectSerie =
<a name="l00233"></a>00233       <span class="stringliteral">"&lt;SELECT NAME='id_serie' class='fondo' onChange=\"document.forms['form_resultats'].submit();\"&gt;\n\t&lt;OPTION VALUE=''&gt;-=[S&amp;eacute;rie]=-&lt;/OPTION&gt;\n"</span>;
<a name="l00234"></a>00234     <span class="keywordflow">foreach</span> ($tSeries as $iIdSerie = &gt;$sSerie)
<a name="l00235"></a>00235     {
<a name="l00236"></a>00236       <span class="keywordflow">if</span> ($id_serie == $iIdSerie)
<a name="l00237"></a>00237         $selected = 'selected';
<a name="l00238"></a>00238       <span class="keywordflow">else</span>
<a name="l00239"></a>00239         $selected = '';
<a name="l00240"></a>00240       $selectSerie. =
<a name="l00241"></a>00241         <span class="stringliteral">"\t&lt;OPTION VALUE='$iIdSerie' $selected&gt;$sSerie&lt;/OPTION&gt;\n"</span>;
<a name="l00242"></a>00242     }
<a name="l00243"></a>00243     $selectSerie. = <span class="stringliteral">"&lt;/SELECT&gt;\n"</span>;
<a name="l00244"></a>00244     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a> =
<a name="l00245"></a>00245       <span class="stringliteral">"&lt;table class='spip' width='300'&gt;\n&lt;form name='form_resultats' action='"</span>.
<a name="l00246"></a>00246       generer_url_ecrire ('odb_notes').
<a name="l00247"></a>00247       <span class="stringliteral">"' method='get' class='spip_xx-small'/&gt;\n"</span>.
<a name="l00248"></a>00248       <span class="stringliteral">"&lt;tr&gt;&lt;th&gt;Jury&lt;/th&gt;&lt;th&gt;S&amp;eacute;rie&lt;/th&gt;&lt;th&gt;&amp;nbsp;&lt;/th&gt;&lt;/tr&gt;\n"</span>.
<a name="l00249"></a>00249       <span class="stringliteral">"&lt;tr&gt;&lt;th&gt;$selectJury&lt;/th&gt;&lt;td&gt;$selectSerie&lt;/td&gt;&lt;td&gt;&lt;input type='submit' name='ok' value='ok' class='fondo'/&gt;&lt;/td&gt;&lt;/tr&gt;\n"</span>.
<a name="l00250"></a>00250       <span class="stringliteral">"&lt;input type='hidden' name='exec' value='odb_notes'/&gt;\n"</span>.
<a name="l00251"></a>00251       <span class="stringliteral">"&lt;input type='hidden' name='resultats' value='auto'/&gt;\n&lt;/FORM&gt;\n"</span>;
<a name="l00252"></a>00252     <span class="keywordflow">if</span> (isset ($tParam[<span class="stringliteral">"_delib1_$annee"</span>][$r_jury]))
<a name="l00253"></a>00253       {
<a name="l00254"></a>00254         <span class="keywordflow">if</span> (isset ($_REQUEST['total']))
<a name="l00255"></a>00255           {
<a name="l00256"></a>00256             <a class="code" href="inc-pdf-attestations_8php.html#dd57477ad14361f5834629e405ff5478">$deliberation</a> = 0;
<a name="l00257"></a>00257             <span class="keywordflow">if</span> ($id_serie != '')
<a name="l00258"></a>00258               <a class="code" href="inc-pdf-attestations_8php.html#6bcaf0e2f3a66b7da57696c4e02eac7d">$extra</a> =
<a name="l00259"></a>00259                 <span class="stringliteral">"&lt;hr size=1/&gt;&lt;A HREF='"</span>.generer_url_ecrire ('odb_notes').
<a name="l00260"></a>00260                 <span class="stringliteral">"&amp;jury=$jury&amp;serie=$serie&amp;resultats'&gt;&lt;b&gt;Filtrer les notes&lt;/b&gt; &amp;agrave; la d&amp;eacute;lib&amp;eacute;ration en cours&lt;/A&gt;\n"</span>;
<a name="l00261"></a>00261           }
<a name="l00262"></a>00262         <span class="keywordflow">else</span>
<a name="l00263"></a>00263           {
<a name="l00264"></a>00264             $nbCandidatsOral = <a class="code" href="odb__notes_2exec_2inc-bdd_8php.html#000899dd9da7cf04c35abc6e440d6ed3" title="Recupere le nombre de candidats selon divers criteres.">getNbCandidats</a> (<a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>, $r_jury, 'Oral');
<a name="l00265"></a>00265             <span class="keywordflow">if</span> ($nbCandidatsOral &gt; 1)
<a name="l00266"></a>00266               <a class="code" href="inc-pdf-attestations_8php.html#dd57477ad14361f5834629e405ff5478">$deliberation</a> = 3;
<a name="l00267"></a>00267             <span class="keywordflow">else</span>
<a name="l00268"></a>00268               <a class="code" href="inc-pdf-attestations_8php.html#dd57477ad14361f5834629e405ff5478">$deliberation</a> = 2;
<a name="l00269"></a>00269             <span class="keywordflow">if</span> ($id_serie != '')
<a name="l00270"></a>00270               <a class="code" href="inc-pdf-attestations_8php.html#6bcaf0e2f3a66b7da57696c4e02eac7d">$extra</a> =
<a name="l00271"></a>00271                 <span class="stringliteral">"&lt;hr size=1/&gt;&lt;A HREF='"</span>.generer_url_ecrire ('odb_notes').
<a name="l00272"></a>00272                 <span class="stringliteral">"&amp;jury=$jury&amp;serie=$serie&amp;resultats&amp;total'&gt;Afficher &lt;b&gt;toutes&lt;/b&gt; les notes&lt;/A&gt;\n"</span>;
<a name="l00273"></a>00273           }
<a name="l00274"></a>00274         include_once (<a class="code" href="odb__affiche__csv_8php.html#c24ff0f08fb134ed2d43c99826787bc2">DIR_ODB_COMMUN</a>.'inc-html.php');
<a name="l00275"></a>00275         <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00276"></a>00276           <span class="stringliteral">"&lt;tr&gt;&lt;td&gt;"</span>.vignette ('pdf').
<a name="l00277"></a>00277           <span class="stringliteral">"&lt;/td&gt;&lt;td colspan='2'&gt;Vous &amp;ecirc;tes autoris&amp;eacute;(e) &amp;agrave; &lt;b&gt;&lt;A HREF='"</span>.
<a name="l00278"></a>00278           generer_url_ecrire ('odb_notes').
<a name="l00279"></a>00279           <span class="stringliteral">"&amp;jury=$r_jury&amp;serie=$serie&amp;annee=$annee&amp;imprimer'&gt;acc&amp;eacute;der aux impressions PDF&lt;/A&gt;&lt;/b&gt;&lt;br/&gt;&lt;b&gt;Note :&lt;/b&gt; acc&amp;eacute;dez &amp;agrave; ce module si les r&amp;eacute;sultats vous semblent incorrects$extra&lt;/td&gt;&lt;/tr&gt;\n"</span>;
<a name="l00280"></a>00280       }
<a name="l00281"></a>00281     <span class="keywordflow">else</span>
<a name="l00282"></a>00282       {
<a name="l00283"></a>00283         <a class="code" href="inc-pdf-attestations_8php.html#dd57477ad14361f5834629e405ff5478">$deliberation</a> = 1;
<a name="l00284"></a>00284       }
<a name="l00285"></a>00285     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;/TABLE&gt;\n"</span>;
<a name="l00286"></a>00286     <span class="keywordflow">if</span> ($id_serie != '')
<a name="l00287"></a>00287       {
<a name="l00288"></a>00288         <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00289"></a>00289           <a class="code" href="odb__notes_2exec_2inc-traitements_8php.html#33a267718e90ba67c7a694d64441663b" title="Affiche les notes d&amp;#39;un candidat.">afficherNotes</a> (<a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a>, $id_serie, <a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>, '', <a class="code" href="inc-pdf-attestations_8php.html#dd57477ad14361f5834629e405ff5478">$deliberation</a>, <span class="keyword">true</span>);
<a name="l00290"></a>00290         <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00291"></a>00291           <span class="stringliteral">"Navigation rapide : &lt;b&gt;&lt;A HREF='"</span>.generer_url_ecrire ('odb_notes').
<a name="l00292"></a>00292           <span class="stringliteral">"&amp;jury=$jury&amp;serie=$serie'&gt;mati&amp;egrave;res du jury $jury, s&amp;eacute;rie $serie&lt;/A&gt;&lt;/b&gt;\n"</span>;
<a name="l00293"></a>00293       }
<a name="l00294"></a>00294     <span class="keywordflow">else</span>
<a name="l00295"></a>00295       <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"Veuillez choisir une s&amp;eacute;rie pour le jury $jury\n"</span>;
<a name="l00296"></a>00296   }
<a name="l00297"></a>00297   elseif (isset ($_REQUEST['step3']) || isset ($_REQUEST['step4']))
<a name="l00298"></a>00298   {
<a name="l00300"></a>00300     <span class="keywordflow">foreach</span> (array
<a name="l00301"></a>00301              ('type', 'id_anonyme', 'note', 'jury', 'serie', 'id_serie',
<a name="l00302"></a>00302               'coeff', 'matiere', 'id_matiere') as $col) $$col =
<a name="l00303"></a>00303       urldecode ($_REQUEST[$col]);
<a name="l00304"></a>00304     $r_type = $type;
<a name="l00305"></a>00305     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a> = '';
<a name="l00306"></a>00306 
<a name="l00307"></a>00307     $gauche. =
<a name="l00308"></a>00308       <span class="stringliteral">"&lt;br/&gt;&lt;br/&gt;\nNavigation rapide\n&lt;ul class='tout-site'&gt;\n&lt;li class='sec'&gt;&lt;A class='titre' href='"</span>.
<a name="l00309"></a>00309       generer_url_ecrire ('odb_notes').
<a name="l00310"></a>00310       <span class="stringliteral">"&amp;jury=$jury&amp;serie=$serie&amp;id_serie=$id_serie&amp;step2=manuel'&gt;Mati&amp;egrave;re&lt;/A&gt;&lt;/li&gt;\n"</span>.
<a name="l00311"></a>00311       <span class="stringliteral">"&lt;li class='sec'&gt;&lt;A class='titre' href='"</span>.
<a name="l00312"></a>00312       generer_url_ecrire ('odb_notes').
<a name="l00313"></a>00313       <span class="stringliteral">"&amp;jury=$jury&amp;serie=$serie&amp;id_serie=$id_serie&amp;resultats=manuel'&gt;R&amp;eacute;sultats jury $jury&lt;/A&gt;&lt;/li&gt;\n"</span>.
<a name="l00314"></a>00314       <span class="stringliteral">"&lt;br/&gt;&lt;li class='sec'&gt;&lt;b&gt;&lt;A class='titre' href='../spip.php?action=logout&amp;logout=prive'&gt;Se d&amp;eacute;connecter&lt;/A&gt;&lt;/B&gt;&lt;/li&gt;\n&lt;/ul&gt;\n"</span>;
<a name="l00315"></a>00315     $gauche2 =
<a name="l00316"></a>00316       <span class="stringliteral">"- Pour enregistrer une note, tapez [&lt;b&gt;Entr&amp;eacute;e&lt;/b&gt;] au lieu de cliquer sur le bouton pour gagner du temps&lt;br/&gt;&lt;br/&gt;- Saisissez un tiret [&lt;b&gt;-&lt;/b&gt;] comme note pour signifier qu'un candidat n'a pas compos&amp;eacute;"</span>;
<a name="l00317"></a>00317     <span class="comment">//echo $id_anonyme;</span>
<a name="l00318"></a>00318     <span class="keywordflow">if</span> (isset ($_REQUEST['step4']))
<a name="l00319"></a>00319       {
<a name="l00321"></a>00321         $id = $id_anonyme;
<a name="l00322"></a>00322         $idTableOuRien = <span class="stringliteral">"''"</span>;
<a name="l00323"></a>00323         <span class="keywordflow">if</span> (substr_count ($id, <span class="charliteral">'-'</span>) &gt; 0)
<a name="l00324"></a>00324           {
<a name="l00325"></a>00325             <span class="comment">//TODO mon dieu quelle horreur</span>
<a name="l00326"></a>00326             <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> =
<a name="l00327"></a>00327               <span class="stringliteral">"SELECT DECODE(id_anonyme,'$pass') id_anonyme from odb_repartition where id_table='$id'"</span>;
<a name="l00328"></a>00328             <a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code" href="inc-odb_8php.html#cc73cdf19f49ae7162c99fd07a614e88" title="Execute une requete sql.">odb_query</a> (<a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a>, __FILE__, __LINE__);
<a name="l00329"></a>00329             $row = mysql_fetch_array (<a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a>);
<a name="l00330"></a>00330             $id_anonyme = $row['id_anonyme'];
<a name="l00331"></a>00331             $idTableOuRien =
<a name="l00332"></a>00332               <span class="stringliteral">"(SELECT id_table from odb_repartition where DECODE(id_anonyme,'$pass')='$id_anonyme' and annee=$annee)"</span>;
<a name="l00333"></a>00333             <span class="comment">//print_r($row);</span>
<a name="l00334"></a>00334           }
<a name="l00335"></a>00335         <span class="comment">//FIXME supprimer ligne suivante pour ne plus enregistrer les id_table dans la base</span>
<a name="l00336"></a>00336         $idTableOuRien =
<a name="l00337"></a>00337           <span class="stringliteral">"(SELECT id_table from odb_repartition where DECODE(id_anonyme,'$pass')='$id_anonyme' and annee=$annee)"</span>;
<a name="l00338"></a>00338 
<a name="l00339"></a>00339         $sql1 =
<a name="l00340"></a>00340           <span class="stringliteral">"INSERT into odb_histo_notes (id_table, id_anonyme, annee, id_matiere, note, type, coeff, operateur, maj)  \n"</span>.
<a name="l00341"></a>00341           <span class="stringliteral">"\t(SELECT id_table, id_anonyme, annee, id_matiere, note, type, coeff, operateur, maj from odb_notes \n\twhere id_anonyme='$id_anonyme' and annee=$annee and id_matiere=$id_matiere and type='$type')"</span>;
<a name="l00342"></a>00342         <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> =
<a name="l00343"></a>00343           <span class="stringliteral">"REPLACE into odb_notes (id_table, id_anonyme, annee, id_matiere, note, type, coeff, operateur, maj) VALUES (\n"</span>.
<a name="l00344"></a>00344           <span class="stringliteral">"\t$idTableOuRien, $id_anonyme, $annee, $id_matiere, $note, '$type', $coeff,'"</span>.
<a name="l00345"></a>00345           $GLOBALS['auteur_session']['login'].<span class="stringliteral">"',NOW()\n)"</span>;
<a name="l00346"></a>00346         <span class="comment">//echo "&lt;pre&gt;$sql&lt;/pre&gt;";</span>
<a name="l00347"></a>00347         <span class="keywordflow">if</span> ($note != '')
<a name="l00348"></a>00348           {
<a name="l00349"></a>00349             <span class="keywordflow">if</span> ($note &gt; 20)
<a name="l00350"></a>00350               <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00351"></a>00351                 '&lt;small&gt;'.KO.
<a name="l00352"></a>00352                 <span class="stringliteral">" - Vous avez essay&amp;eacute; de saisir la note &lt;b&gt;$note&lt;/b&gt;, qui est sup&amp;eacute;rieure &amp;agrave; 20. &lt;b&gt;Saisie ignor&amp;eacute;e&lt;/b&gt;&lt;/small&gt;&lt;br/&gt;\n"</span>;
<a name="l00353"></a>00353             elseif ($note == '') <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00354"></a>00354               '&lt;small&gt;'.KO.
<a name="l00355"></a>00355               <span class="stringliteral">" - Note inconnue. &lt;b&gt;Saisie ignor&amp;eacute;e&lt;/b&gt;&lt;/small&gt;&lt;br/&gt;\n"</span>;
<a name="l00356"></a>00356             <span class="keywordflow">else</span>
<a name="l00357"></a>00357             {
<a name="l00358"></a>00358               <a class="code" href="inc-odb_8php.html#cc73cdf19f49ae7162c99fd07a614e88" title="Execute une requete sql.">odb_query</a> ($sql1, __FILE__, __LINE__);
<a name="l00359"></a>00359               <a class="code" href="inc-odb_8php.html#cc73cdf19f49ae7162c99fd07a614e88" title="Execute une requete sql.">odb_query</a> (<a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a>, __FILE__, __LINE__);
<a name="l00360"></a>00360               <span class="comment">//echo "&lt;pre&gt;$sql&lt;/pre&gt;";</span>
<a name="l00361"></a>00361               <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00362"></a>00362                 '&lt;small&gt;'.OK.<span class="stringliteral">" - Le candidat &lt;b&gt;$id&lt;/b&gt; a eu "</span>.($coeff ==
<a name="l00363"></a>00363                                                                 0 ?
<a name="l00364"></a>00364                                                                 <span class="stringliteral">"+&lt;b&gt;$note&lt;/b&gt;"</span>
<a name="l00365"></a>00365                                                                 :
<a name="l00366"></a>00366                                                                 <span class="stringliteral">"&lt;b&gt;$note&lt;/b&gt;&lt;small&gt;/20&lt;/small&gt; &lt;small&gt;(soit "</span>.
<a name="l00367"></a>00367                                                                 ($note *
<a name="l00368"></a>00368                                                                  $coeff).
<a name="l00369"></a>00369                                                                 <span class="charliteral">'/'</span>.(20 *
<a name="l00370"></a>00370                                                                      $coeff).
<a name="l00371"></a>00371                                                                 <span class="stringliteral">")&lt;/small&gt;"</span>).
<a name="l00372"></a>00372                 <span class="stringliteral">" en &lt;b&gt;$matiere&lt;/b&gt; &lt;small&gt;($type)&lt;/small&gt;&lt;/small&gt;&lt;br/&gt;\n"</span>;
<a name="l00373"></a>00373             }
<a name="l00374"></a>00374           }
<a name="l00375"></a>00375       }
<a name="l00377"></a>00377     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;TABLE class='spip' width='100%'&gt;\n&lt;tr class='row_even'&gt;\n"</span>.
<a name="l00378"></a>00378       <span class="stringliteral">"&lt;th&gt;Jury $jury"</span>;
<a name="l00379"></a>00379     <span class="keywordflow">if</span> ($isOperateur)
<a name="l00380"></a>00380       <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">" (Centre $deliberationCentre)"</span>;
<a name="l00381"></a>00381     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00382"></a>00382       <span class="stringliteral">"&lt;/th&gt;&lt;th&gt;S&amp;eacute;rie $serie&lt;/th&gt;&lt;th style='text-align:right;'&gt;Mati&amp;egrave;re : $matiere&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;\n"</span>;
<a name="l00383"></a>00383     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00384"></a>00384       <span class="stringliteral">"&lt;A NAME='saisie'&gt;&lt;/A&gt;\n&lt;table class='spip' width='100%'&gt;\n&lt;tr&gt;\n"</span>;
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <span class="keywordflow">foreach</span> (array ('Ecrit', 'Pratique', 'Oral', 'Divers') as $type)
<a name="l00387"></a>00387     {
<a name="l00388"></a>00388       $
<a name="l00389"></a>00389       {
<a name="l00390"></a>00390       <span class="stringliteral">"is$type"</span>}
<a name="l00391"></a>00391       = <span class="keyword">false</span>;
<a name="l00392"></a>00392       <span class="keywordflow">if</span> ($id_matiere &gt; 0)
<a name="l00393"></a>00393         {
<a name="l00394"></a>00394           <span class="keywordflow">if</span> ($type == 'Oral')
<a name="l00395"></a>00395             {
<a name="l00396"></a>00396               <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> =
<a name="l00397"></a>00397                 <span class="stringliteral">"SELECT rep.jury, dep.departement, eta.etablissement centre, ser.serie, rep.id_table, DECODE(rep.id_anonyme,'$pass') id_anonyme, notes.note, exa.coeff\n"</span>.
<a name="l00398"></a>00398                 <span class="stringliteral">" from odb_ref_examen exa, odb_candidats can, odb_ref_etablissement eta, odb_ref_serie ser, odb_ref_departement dep, odb_decisions decis, odb_repartition rep\n left join odb_notes notes on (rep.id_table=notes.id_table and notes.annee=$annee and notes.id_matiere=$id_matiere and notes.type='$type') \n"</span>.
<a name="l00399"></a>00399                 <span class="stringliteral">" where exa.id_matiere=$id_matiere and exa.annee=$annee and exa.id_serie=$id_serie and notes.type='$type'\n"</span>.
<a name="l00400"></a>00400                 <span class="stringliteral">" and eta.id=rep.id_etablissement and dep.id= eta.id_departement and ser.id=can.serie "</span>.
<a name="l00401"></a>00401                 <span class="stringliteral">" and can.id_saisie=rep.id_saisie AND can.annee=$annee and rep.annee=$annee and can.serie=$id_serie and rep.jury=$jury\n"</span>.
<a name="l00402"></a>00402                 <span class="stringliteral">" and decis.id_table=rep.id_table and decis.annee=$annee and decis.delib1='Admissible' and (decis.delib2='Oral' or decis.delib2='Reserve')\n"</span>.
<a name="l00403"></a>00403                 <span class="stringliteral">" ORDER BY jury, departement, centre, ser.serie, id_anonyme, duree, examen"</span>;
<a name="l00404"></a>00404               <span class="comment">//echo "&lt;pre&gt;$sql&lt;/pre&gt;\n";</span>
<a name="l00405"></a>00405             }
<a name="l00406"></a>00406           <span class="keywordflow">else</span>
<a name="l00407"></a>00407             <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> =
<a name="l00408"></a>00408               <span class="stringliteral">"SELECT rep.jury, dep.departement, eta.etablissement centre, ser.serie, rep.id_table, DECODE(rep.id_anonyme,'$pass') id_anonyme, notes.note, exa.coeff\n"</span>.
<a name="l00409"></a>00409               <span class="stringliteral">" from odb_ref_examen exa, odb_candidats can, odb_ref_etablissement eta, odb_ref_serie ser, odb_ref_departement dep, odb_repartition rep\n left join odb_notes notes on (rep.id_table=notes.id_table and notes.annee=$annee and notes.id_matiere=$id_matiere and notes.type='$type') \n"</span>.
<a name="l00410"></a>00410               <span class="stringliteral">" where exa.id_matiere=$id_matiere and exa.annee=$annee and exa.id_serie=$id_serie and notes.type='$type'\n"</span>.
<a name="l00411"></a>00411               <span class="stringliteral">" and eta.id=rep.id_etablissement and dep.id= eta.id_departement and ser.id=can.serie "</span>.
<a name="l00412"></a>00412               <span class="stringliteral">" and can.id_saisie=rep.id_saisie AND can.annee=$annee and rep.annee=$annee and can.serie=$id_serie and rep.jury=$jury\n"</span>.
<a name="l00413"></a>00413               <span class="stringliteral">" ORDER BY jury, departement, centre, ser.serie, id_anonyme, duree, examen"</span>;
<a name="l00414"></a>00414         }
<a name="l00415"></a>00415       elseif ($id_matiere &lt; 0)
<a name="l00416"></a>00416       {
<a name="l00417"></a>00417         <span class="keywordflow">if</span> ($type == 'Divers')
<a name="l00418"></a>00418           {
<a name="l00419"></a>00419             <span class="keywordflow">switch</span> ($id_matiere)
<a name="l00420"></a>00420               {
<a name="l00421"></a>00421               <span class="keywordflow">case</span> <a class="code" href="odb__notes_8php.html#97b8c6303969d0488dd928447cf9fa13">ID_MATIERE_EF1</a>:
<a name="l00422"></a>00422                 $champ = 'ef.ef,';
<a name="l00423"></a>00423                 $from = <span class="stringliteral">"odb_ref_ef ef, odb_decisions decis,"</span>;
<a name="l00424"></a>00424                 <a class="code" href="inc-pdf-attestations_8php.html#d4a3e16ae571f7498eedad9de246faf7">$where</a> =
<a name="l00425"></a>00425                   <span class="stringliteral">"and can.ef1 = ef.id and decis.id_table=rep.id_table and decis.delib1='Admissible' and decis.annee=$annee"</span>;
<a name="l00426"></a>00426                 <span class="keywordflow">break</span>;
<a name="l00427"></a>00427               <span class="keywordflow">case</span> <a class="code" href="odb__notes_8php.html#da2834629114affadacc37cdf87c3dde">ID_MATIERE_EF2</a>:
<a name="l00428"></a>00428                 $champ = 'ef.ef,';
<a name="l00429"></a>00429                 $from = <span class="stringliteral">"odb_ref_ef ef, odb_decisions decis,"</span>;
<a name="l00430"></a>00430                 <a class="code" href="inc-pdf-attestations_8php.html#d4a3e16ae571f7498eedad9de246faf7">$where</a> =
<a name="l00431"></a>00431                   <span class="stringliteral">"and can.ef2 = ef.id and decis.id_table=rep.id_table and decis.delib1='Admissible' and decis.annee=$annee"</span>;
<a name="l00432"></a>00432                 <span class="keywordflow">break</span>;
<a name="l00433"></a>00433               <span class="keywordflow">case</span> <a class="code" href="odb__notes_8php.html#f29ef43f72bda613ccc526c3881f2434">ID_MATIERE_EPS</a>:
<a name="l00434"></a>00434                 $champ = 'eps.eps,';
<a name="l00435"></a>00435                 $from = <span class="stringliteral">"odb_ref_eps eps, odb_decisions decis,"</span>;
<a name="l00436"></a>00436                 <a class="code" href="inc-pdf-attestations_8php.html#d4a3e16ae571f7498eedad9de246faf7">$where</a> =
<a name="l00437"></a>00437                   <span class="stringliteral">"and can.eps=eps.id and eps.eps='Apte' and decis.id_table=rep.id_table and decis.delib1='Admissible' and decis.annee=$annee"</span>;
<a name="l00438"></a>00438                 <span class="keywordflow">break</span>;
<a name="l00439"></a>00439               <span class="keywordflow">default</span>:
<a name="l00440"></a>00440                 die (<a class="code" href="odb__ref_8php.html#e56b96c4dfcced36887ba02c496c40a3">KO</a>.
<a name="l00441"></a>00441                      <span class="stringliteral">" - Cas impr&amp;eacute;vu : id_matiere=$id_matiere dans les divers"</span>);
<a name="l00442"></a>00442               }
<a name="l00443"></a>00443             <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> =
<a name="l00444"></a>00444               <span class="stringliteral">"SELECT $champ rep.jury, dep.departement, eta.etablissement centre, ser.serie, rep.id_table, DECODE(rep.id_anonyme,'$pass') id_anonyme, notes.note, 1 coeff\n"</span>.
<a name="l00445"></a>00445               <span class="stringliteral">" from $from odb_candidats can, odb_ref_etablissement eta, odb_ref_serie ser, odb_ref_departement dep, odb_repartition rep\n"</span>.
<a name="l00446"></a>00446               <span class="stringliteral">"  left join odb_notes notes on (rep.id_table=notes.id_table and notes.annee=$annee and notes.id_matiere=$id_matiere and notes.type='$type') \n"</span>.
<a name="l00447"></a>00447               <span class="stringliteral">" where can.serie=$id_serie $where \n"</span>.
<a name="l00448"></a>00448               <span class="stringliteral">" and eta.id=rep.id_etablissement and dep.id= eta.id_departement and ser.id=can.serie "</span>.
<a name="l00449"></a>00449               <span class="stringliteral">" and can.id_saisie=rep.id_saisie AND can.annee=$annee and rep.annee=$annee and can.serie=$id_serie and rep.jury=$jury\n"</span>.
<a name="l00450"></a>00450               <span class="stringliteral">" ORDER BY jury, departement, centre, ser.serie, id_anonyme"</span>;
<a name="l00451"></a>00451             <span class="comment">//echo "&lt;pre&gt;$sql&lt;/pre&gt;";</span>
<a name="l00452"></a>00452           }
<a name="l00453"></a>00453         <span class="keywordflow">else</span>
<a name="l00454"></a>00454           <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> = <span class="stringliteral">"SELECT 1 from odb_param where 1=0"</span>;
<a name="l00455"></a>00455       }
<a name="l00456"></a>00456       <a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code" href="inc-odb_8php.html#cc73cdf19f49ae7162c99fd07a614e88" title="Execute une requete sql.">odb_query</a> (<a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a>, __FILE__, __LINE__);
<a name="l00457"></a>00457       <span class="comment">//echo "&lt;hr/&gt;$type&lt;br/&gt;&lt;pre&gt;$sql&lt;/pre&gt;&lt;br/&gt;";</span>
<a name="l00458"></a>00458       <span class="keywordflow">while</span> ($row = mysql_fetch_array (<a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a>))
<a name="l00459"></a>00459         {
<a name="l00460"></a>00460           <span class="keywordflow">foreach</span> (array ('ef', 'id_anonyme', 'id_table', 'note', 'coeff') as
<a name="l00461"></a>00461                    $col)
<a name="l00462"></a>00462           {
<a name="l00463"></a>00463             $$col = $row[$col];
<a name="l00464"></a>00464           }
<a name="l00465"></a>00465           <a class="code" href="inc-pdf-convocation_8php.html#295929cd9243ffe88a7c63fc065d7e9e">$id_table</a> = <a class="code" href="inc-odb_8php.html#50e3b190a166aaf85cb237405cf56be2" title="affiche un numero de table de facon lisible pour un humain">getIdTableHumain</a> (<a class="code" href="inc-pdf-convocation_8php.html#295929cd9243ffe88a7c63fc065d7e9e">$id_table</a>);
<a name="l00466"></a>00466           <span class="keywordflow">if</span> ($type == 'Oral' || $type == 'Divers')
<a name="l00467"></a>00467             {
<a name="l00468"></a>00468               $id = <a class="code" href="inc-pdf-convocation_8php.html#295929cd9243ffe88a7c63fc065d7e9e">$id_table</a>;
<a name="l00469"></a>00469               $tIdAnonyme[<a class="code" href="inc-pdf-convocation_8php.html#295929cd9243ffe88a7c63fc065d7e9e">$id_table</a>] = $id_anonyme;
<a name="l00470"></a>00470             }
<a name="l00471"></a>00471           <span class="keywordflow">else</span>
<a name="l00472"></a>00472             $id = $id_anonyme;
<a name="l00473"></a>00473           $
<a name="l00474"></a>00474           {
<a name="l00475"></a>00475           <span class="stringliteral">"is$type"</span>}
<a name="l00476"></a>00476           = <span class="keyword">true</span>;
<a name="l00477"></a>00477           $
<a name="l00478"></a>00478           {
<a name="l00479"></a>00479           <span class="stringliteral">"t$type"</span>}
<a name="l00480"></a>00480           [$id] = $note;
<a name="l00481"></a>00481           <span class="keywordflow">if</span> ($id_matiere == <a class="code" href="odb__notes_8php.html#97b8c6303969d0488dd928447cf9fa13">ID_MATIERE_EF1</a> || $id_matiere == <a class="code" href="odb__notes_8php.html#da2834629114affadacc37cdf87c3dde">ID_MATIERE_EF2</a>)
<a name="l00482"></a>00482             {
<a name="l00483"></a>00483               $tCoeff[$type] = 0;
<a name="l00484"></a>00484               $tEf[$id] = $ef;
<a name="l00485"></a>00485               $isEf = <span class="keyword">true</span>;
<a name="l00486"></a>00486             }
<a name="l00487"></a>00487           <span class="keywordflow">else</span>
<a name="l00488"></a>00488             {
<a name="l00489"></a>00489               $tCoeff[$type] = $coeff;
<a name="l00490"></a>00490               $isEf = <span class="keyword">false</span>;
<a name="l00491"></a>00491             }
<a name="l00492"></a>00492         }
<a name="l00493"></a>00493       <span class="keywordflow">if</span> ($
<a name="l00494"></a>00494           {
<a name="l00495"></a>00495           <span class="stringliteral">"is$type"</span>}
<a name="l00496"></a>00496       )
<a name="l00497"></a>00497         {
<a name="l00498"></a>00498           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"\t&lt;th&gt;$type "</span>;
<a name="l00499"></a>00499           <span class="keywordflow">if</span> ($isEf)
<a name="l00500"></a>00500             {
<a name="l00501"></a>00501               <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = '(bonus)';
<a name="l00502"></a>00502             }
<a name="l00503"></a>00503           <span class="keywordflow">else</span>
<a name="l00504"></a>00504             {
<a name="l00505"></a>00505               <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"(coeff $tCoeff[$type])"</span>;
<a name="l00506"></a>00506             }
<a name="l00507"></a>00507           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;/th&gt;\n"</span>;
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509       <span class="comment">//print_r(${"t$type"});</span>
<a name="l00510"></a>00510     }
<a name="l00511"></a>00511     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;/tr&gt;\n&lt;tr&gt;\n"</span>;
<a name="l00512"></a>00512     <a class="code" href="resultats__ajournes__par__centre_8php.html#ea5d1e230cf3df250120025d801dc7c3">$cpt</a> = 0;
<a name="l00513"></a>00513     <span class="keywordflow">foreach</span> (array ('Ecrit', 'Pratique', 'Oral', 'Divers') as $type)
<a name="l00514"></a>00514     {
<a name="l00515"></a>00515       <span class="comment">//$cpt++;echo "&lt;br/&gt;$type $cpt";</span>
<a name="l00516"></a>00516       <span class="keywordflow">if</span> ($
<a name="l00517"></a>00517           {
<a name="l00518"></a>00518           <span class="stringliteral">"is$type"</span>}
<a name="l00519"></a>00519       )
<a name="l00520"></a>00520         {
<a name="l00521"></a>00521           $isSelected = <span class="keyword">false</span>;
<a name="l00522"></a>00522           $
<a name="l00523"></a>00523           {
<a name="l00524"></a>00524           <span class="stringliteral">"select$type"</span>}
<a name="l00525"></a>00525           = <span class="stringliteral">"&lt;SELECT name='id_anonyme' class='fondo' onChange=\"document.forms['form_$type'].note.value='';document.forms['form_$type'].note.focus();\"&gt;"</span>.<span class="stringliteral">"&lt;OPTION value=''&gt;-=[Candidat]=-&lt;/OPTION&gt;"</span>;
<a name="l00526"></a>00526           <span class="keywordflow">foreach</span> ($
<a name="l00527"></a>00527                    {
<a name="l00528"></a>00528                    <span class="stringliteral">"t$type"</span>}
<a name="l00529"></a>00529                    as $id_anonyme = &gt;$note)
<a name="l00530"></a>00530           {
<a name="l00531"></a>00531             <span class="keywordflow">if</span> (!$isSelected &amp;&amp; $note == '')
<a name="l00532"></a>00532               {                 <span class="comment">// n'a pas deja ete selected</span>
<a name="l00533"></a>00533                 $selected = 'selected';
<a name="l00534"></a>00534                 $id_anonyme_selected[$type] = $id_anonyme;
<a name="l00535"></a>00535                 $isSelected = <span class="keyword">true</span>;
<a name="l00536"></a>00536               }
<a name="l00537"></a>00537             <span class="keywordflow">else</span>
<a name="l00538"></a>00538               $selected = '';
<a name="l00539"></a>00539             <span class="keywordflow">if</span> ($note != '')
<a name="l00540"></a>00540               {
<a name="l00541"></a>00541                 <span class="keywordflow">if</span> ($note &lt; 0)
<a name="l00542"></a>00542                   $aff_note = ' -&amp;gt; N/C &amp;lt;- ';
<a name="l00543"></a>00543                 elseif ($isEf) $aff_note = <span class="stringliteral">" (+$note)"</span>;
<a name="l00544"></a>00544                 <span class="keywordflow">else</span>
<a name="l00545"></a>00545                 $aff_note = <span class="stringliteral">" ($note/20)"</span>;
<a name="l00546"></a>00546               }
<a name="l00547"></a>00547             <span class="keywordflow">else</span>
<a name="l00548"></a>00548               $aff_note = '';
<a name="l00549"></a>00549             $
<a name="l00550"></a>00550             {
<a name="l00551"></a>00551             <span class="stringliteral">"select$type"</span>}
<a name="l00552"></a>00552             . =
<a name="l00553"></a>00553               <span class="stringliteral">"&lt;OPTION $selected value='$id_anonyme'&gt;$id_anonyme $tEf[$id_anonyme] $aff_note&lt;/OPTION&gt;\n"</span>;
<a name="l00554"></a>00554           }
<a name="l00555"></a>00555           $
<a name="l00556"></a>00556           {
<a name="l00557"></a>00557           <span class="stringliteral">"select$type"</span>}
<a name="l00558"></a>00558           . = <span class="stringliteral">"&lt;/SELECT&gt;\n"</span>;
<a name="l00559"></a>00559           <span class="keywordflow">if</span> ($isEf)
<a name="l00560"></a>00560             {
<a name="l00561"></a>00561               $inputNote =
<a name="l00562"></a>00562                 <span class="stringliteral">"&lt;INPUT name='note' size=2 maxlength=2 onKeyUp=\"if(isNaN(parseInt(this.value))) this.value='';if(this.value&gt;5) {alert('Un candidat ne peut avoir plus de 5 points de bonus par EF, veuillez saisir cette note de nouveau');this.value='';}document.forms['form_$type'].note_coeff.value='+'+this.value\" value='$note_selected[$type]' class='fondo'/&gt;\n"</span>;
<a name="l00563"></a>00563               $inputNoteCoeff =
<a name="l00564"></a>00564                 <span class="stringliteral">"&lt;INPUT name='note_coeff' size=2 maxlength=2 value='+"</span>.((int)
<a name="l00565"></a>00565                                                                         $note_selected
<a name="l00566"></a>00566                                                                         [$type]).
<a name="l00567"></a>00567                 <span class="stringliteral">"' style='text-align:right;border:0px;none;#fff;' onFocus='blur();'/&gt;\n"</span>;
<a name="l00568"></a>00568             }
<a name="l00569"></a>00569           <span class="keywordflow">else</span>
<a name="l00570"></a>00570             {
<a name="l00571"></a>00571               $inputNote =
<a name="l00572"></a>00572                 <span class="stringliteral">"&lt;INPUT name='note' size=2 maxlength=2 onKeyUp=\"if(this.value!='-' &amp;&amp; isNaN(parseInt(this.value))) this.value='';if(this.value&gt;20) {alert('Un candidat ne peut avoir plus de 20/20, veuillez saisir cette note de nouveau');this.value='';}document.forms['form_$type'].note_coeff.value=this.value*$tCoeff[$type]\" value='$note_selected[$type]' class='fondo'/&gt;\n"</span>;
<a name="l00573"></a>00573               $inputNoteCoeff =
<a name="l00574"></a>00574                 <span class="stringliteral">"&lt;INPUT name='note_coeff' size=2 maxlength=3 value='"</span>.((int)
<a name="l00575"></a>00575                                                                        $note_selected
<a name="l00576"></a>00576                                                                        [$type]
<a name="l00577"></a>00577                                                                        *
<a name="l00578"></a>00578                                                                        $tCoeff
<a name="l00579"></a>00579                                                                        [$type]).
<a name="l00580"></a>00580                 <span class="stringliteral">"' style='text-align:right;border:0px;none;#fff;' onFocus='blur();'/&gt;\n"</span>;
<a name="l00581"></a>00581             }
<a name="l00582"></a>00582           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"\t&lt;td style='vertical-align:top;'&gt;"</span>.
<a name="l00583"></a>00583             <span class="stringliteral">"&lt;form name='form_$type' class='spip_xx-small' method='post' action='"</span>.
<a name="l00584"></a>00584             generer_url_ecrire ('odb_notes').<span class="stringliteral">"' "</span>.
<a name="l00585"></a>00585             <span class="stringliteral">"onSubmit=\"if(document.forms['form_$type'].id_anonyme.value=='') {alert('Veuillez choisir le candidat dont vous souhaitez modifier la note ($type)\\navant de valider');return false;} else if(document.forms['form_$type'].note.value=='-') {document.forms['form_$type'].note.value='-1';return true;} else if(document.forms['form_$type'].note.value=='') {alert('Veuillez saisir une note dans le champ adequat');document.forms['form_$type'].note.focus();return false;} else if(isNaN(document.forms['form_$type'].note_coeff.value)) {alert('Veuillez saisir une note correcte ($type)\\navant de valider');return false;document.forms['form_$type'].note_coeff.value='';document.forms['form_$type'].note_coeff.focus();} "</span>.
<a name="l00586"></a>00586             ($type !=
<a name="l00587"></a>00587              'Divers' ?
<a name="l00588"></a>00588              <span class="stringliteral">"else if(document.forms['form_$type'].note.value=='0' || document.forms['form_$type'].note.value=='00' || document.forms['form_$type'].note.value=='0.') {return confirm('Vous avez mis 0 au candidat en $type, ce qui est eliminatoire\\nEtes-vous sur(e) de vous ?');}"</span>
<a name="l00589"></a>00589              : '').<span class="stringliteral">"\"&gt;\n"</span>.<span class="stringliteral">"&lt;table class='spip' width='90%'&gt;\n&lt;tr&gt;\n"</span>.
<a name="l00590"></a>00590             <span class="stringliteral">"\t&lt;td&gt;Candidat&lt;/td&gt;\n\t&lt;td&gt;"</span>.$
<a name="l00591"></a>00591           {
<a name="l00592"></a>00592           <span class="stringliteral">"select$type"</span>}.<span class="stringliteral">"&lt;/td&gt;\n"</span>.
<a name="l00593"></a>00593             <span class="stringliteral">"\t&lt;td rowspan=2&gt;&lt;INPUT TYPE='submit' name='step4' value='Ok\n$type' class='fondo'/&gt;&lt;/td&gt;\n&lt;/tr&gt;\n"</span>.
<a name="l00594"></a>00594             <span class="stringliteral">"&lt;tr&gt;\n\t&lt;td&gt;Note&lt;/td&gt;\n\t&lt;td&gt;$inputNote"</span>.($isEf ? '' :
<a name="l00595"></a>00595                                                        '&lt;small&gt;/20&lt;/small&gt;').
<a name="l00596"></a>00596             $inputNoteCoeff.($isEf ? '' : <span class="stringliteral">"&lt;small&gt;/"</span>.($tCoeff[$type] * 20).
<a name="l00597"></a>00597                              <span class="stringliteral">"&lt;/small&gt;"</span>).<span class="stringliteral">"&lt;/td&gt;\n"</span>.<span class="stringliteral">"&lt;/tr&gt;\n&lt;/table&gt;\n"</span>;
<a name="l00598"></a>00598           <span class="comment">//"&lt;tr&gt;\n\t&lt;td colspan=2&gt;&lt;INPUT TYPE='submit' name='step4' value='Enregistrer $type' class='forml'/&gt;&lt;/td&gt;\n&lt;/tr&gt;\n&lt;/table&gt;\n";</span>
<a name="l00599"></a>00599           $
<a name="l00600"></a>00600           {
<a name="l00601"></a>00601           <span class="stringliteral">"t$type"</span>} = array_reverse ($
<a name="l00602"></a>00602                                      {
<a name="l00603"></a>00603                                      <span class="stringliteral">"t$type"</span>}, <span class="keyword">true</span>);
<a name="l00604"></a>00604           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;br/&gt;Notes $type (ordre invers&amp;eacute;)&lt;br/&gt;\n"</span>.
<a name="l00605"></a>00605             <span class="stringliteral">"&lt;table class='spip' width='90%'&gt;\n&lt;tr&gt;&lt;th&gt;Candidat&lt;/th&gt;&lt;th&gt;"</span>.
<a name="l00606"></a>00606             ($isEf ? 'Bonus' : 'Note &lt;small&gt;/20&lt;/small&gt;').
<a name="l00607"></a>00607             <span class="stringliteral">"&lt;/th&gt;&lt;th&gt;"</span>.($isEf ? '&amp;Eacute;p. Fac.' :
<a name="l00608"></a>00608                          <span class="stringliteral">"Note &lt;small&gt;/"</span>.(20 *
<a name="l00609"></a>00609                                           $tCoeff[$type]).<span class="stringliteral">"&lt;/small&gt;"</span>).
<a name="l00610"></a>00610             <span class="stringliteral">"&lt;/th&gt;\n&lt;/tr&gt;\n"</span>;
<a name="l00611"></a>00611           <span class="keywordflow">foreach</span> ($
<a name="l00612"></a>00612                    {
<a name="l00613"></a>00613                    <span class="stringliteral">"t$type"</span>} as $id_anonyme = &gt;$note)
<a name="l00614"></a>00614           {
<a name="l00615"></a>00615             <span class="keywordflow">if</span> ($note != '')
<a name="l00616"></a>00616               {
<a name="l00617"></a>00617                 <span class="keywordflow">if</span> ($note &lt; 0)
<a name="l00618"></a>00618                   {
<a name="l00619"></a>00619                     $note =
<a name="l00620"></a>00620                       '&lt;span style=<span class="stringliteral">"color:#f00;font-weight:bold;"</span> title=<span class="stringliteral">"Non Connue"</span>&gt;N/C&lt;/span&gt;';
<a name="l00621"></a>00621                     $note_coeff = '';
<a name="l00622"></a>00622                   }
<a name="l00623"></a>00623                 <span class="keywordflow">else</span>
<a name="l00624"></a>00624                   {
<a name="l00625"></a>00625                     $noteReelle = $note;
<a name="l00626"></a>00626                     <span class="keywordflow">if</span> ($isEf)
<a name="l00627"></a>00627                       {
<a name="l00628"></a>00628                         $note = <span class="stringliteral">"+&lt;b&gt;$note&lt;/b&gt;"</span>;
<a name="l00629"></a>00629                         $note_coeff = $tEf[$id_anonyme];
<a name="l00630"></a>00630                       }
<a name="l00631"></a>00631                     <span class="keywordflow">else</span>
<a name="l00632"></a>00632                       {
<a name="l00633"></a>00633                         $note_coeff =
<a name="l00634"></a>00634                           ($note * $tCoeff[$type]).<span class="stringliteral">"/"</span>.(20 * $tCoeff[$type]);
<a name="l00635"></a>00635                         $note = <span class="stringliteral">"&lt;b&gt;$note&lt;/b&gt;&lt;small&gt;/20&lt;/small&gt;"</span>;
<a name="l00636"></a>00636                       }
<a name="l00637"></a>00637                   }
<a name="l00638"></a>00638                 <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;tr&gt;&lt;td&gt;"</span>.
<a name="l00639"></a>00639                   <span class="stringliteral">"&lt;A href=\"javascript:;\" onclick=\"leForm=document.forms['form_$type'];leForm.id_anonyme.value='$id_anonyme';leForm.note.value='$noteReelle';leForm.note.select();\" title='Modifier la note du candidat $id_anonyme'&gt;"</span>.
<a name="l00640"></a>00640                   <span class="stringliteral">"$id_anonyme&lt;/A&gt;&lt;/td&gt;&lt;td&gt;$note&lt;/td&gt;&lt;td&gt;&lt;small&gt;$note_coeff&lt;/small&gt;&lt;/td&gt;&lt;/tr&gt;\n"</span>;
<a name="l00641"></a>00641               }
<a name="l00642"></a>00642           }
<a name="l00643"></a>00643           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;/table&gt;\n&lt;/td&gt;\n"</span>;
<a name="l00644"></a>00644           $exec = $_REQUEST['exec'];
<a name="l00645"></a>00645           $coeff = $tCoeff[$type];
<a name="l00646"></a>00646           <span class="keywordflow">foreach</span> (array
<a name="l00647"></a>00647                    ('matiere', 'id_matiere', 'jury', 'serie', 'id_serie',
<a name="l00648"></a>00648                     'type', 'coeff') as $var) <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. =
<a name="l00649"></a>00649             <span class="stringliteral">"&lt;input type='hidden' name='$var' value='"</span>.$$var.<span class="stringliteral">"'/&gt;\n"</span>;
<a name="l00650"></a>00650           <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;/form&gt;\n"</span>;
<a name="l00651"></a>00651         }
<a name="l00652"></a>00652     }
<a name="l00653"></a>00653     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>. = <span class="stringliteral">"&lt;/tr&gt;\n&lt;/table&gt;\n"</span>;
<a name="l00654"></a>00654   }
<a name="l00655"></a>00655   <span class="keywordflow">else</span>
<a name="l00656"></a>00656   {
<a name="l00658"></a>00658     $msgTmp = '';
<a name="l00659"></a>00659     <span class="keywordflow">if</span> ($r_jury == '')
<a name="l00660"></a>00660       {
<a name="l00661"></a>00661         $jury_aff = $tJurys[0];
<a name="l00662"></a>00662       }
<a name="l00663"></a>00663     <span class="keywordflow">else</span>
<a name="l00664"></a>00664       $jury_aff = $r_jury;
<a name="l00665"></a>00665     $msgTmp. = <span class="stringliteral">"jury $jury_aff "</span>;
<a name="l00666"></a>00666     $r_serie = $_REQUEST['serie'];
<a name="l00667"></a>00667     <span class="keywordflow">if</span> ($r_serie != '')
<a name="l00668"></a>00668       {
<a name="l00669"></a>00669         $msgTmp. = <span class="stringliteral">" ($r_serie)"</span>;
<a name="l00670"></a>00670       }
<a name="l00671"></a>00671     $gauche. = <span class="stringliteral">"&lt;br/&gt;&lt;br/&gt;\nNavigation rapide\n&lt;ul class='tout-site'&gt;\n"</span>.
<a name="l00672"></a>00672       <span class="stringliteral">"&lt;li class='sec'&gt;&lt;A class='titre' href='"</span>.
<a name="l00673"></a>00673       generer_url_ecrire ('odb_notes').
<a name="l00674"></a>00674       <span class="stringliteral">"&amp;jury=$jury_aff&amp;serie=$r_serie&amp;resultats=manuel'&gt;R&amp;eacute;sultats $msgTmp&lt;/A&gt;&lt;/li&gt;\n"</span>.
<a name="l00675"></a>00675       <span class="stringliteral">"&lt;br/&gt;&lt;li class='sec'&gt;&lt;b&gt;&lt;A class='titre' href='../spip.php?action=logout&amp;logout=prive'&gt;Se d&amp;eacute;connecter&lt;/A&gt;&lt;/B&gt;&lt;/li&gt;\n&lt;/ul&gt;\n"</span>;
<a name="l00676"></a>00676 
<a name="l00677"></a>00677     $tdJurys =
<a name="l00678"></a>00678       <span class="stringliteral">"&lt;INPUT type='hidden' name='jury' value='"</span>.$_REQUEST['jury'].<span class="stringliteral">"'/&gt;\n"</span>;
<a name="l00679"></a>00679     $styleBouton = 'font-weight:normal;border-width:1px;';
<a name="l00680"></a>00680     $styleBoutonActif = 'font-weight:bold;border-width:2px;';
<a name="l00681"></a>00681 
<a name="l00682"></a>00682     <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> =
<a name="l00683"></a>00683       <span class="stringliteral">"SELECT DISTINCT jury, ser.id id_serie, ser.serie\n FROM odb_ref_serie ser, odb_repartition rep, odb_candidats can\n"</span>.
<a name="l00684"></a>00684       <span class="stringliteral">" WHERE can.id_saisie = rep.id_saisie AND ser.id = can.serie and rep.annee=$annee and can.annee=$annee\n ORDER BY jury, ser.serie"</span>;
<a name="l00685"></a>00685     <a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code" href="inc-odb_8php.html#cc73cdf19f49ae7162c99fd07a614e88" title="Execute une requete sql.">odb_query</a> (<a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a>, __FILE__, __LINE__);
<a name="l00686"></a>00686     <span class="keywordflow">while</span> ($row = mysql_fetch_array (<a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a>))
<a name="l00687"></a>00687       {
<a name="l00688"></a>00688         <a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a> = $row['jury'];
<a name="l00689"></a>00689         $tSeries[<a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a>][] = $row['serie'];
<a name="l00690"></a>00690       }
<a name="l00691"></a>00691     <span class="keywordflow">if</span> ($_REQUEST['jury'] &gt; 0)
<a name="l00692"></a>00692       {
<a name="l00693"></a>00693         <span class="comment">// on commence par la pour pouvoir affiche la bulle des series au survol des jurys</span>
<a name="l00694"></a>00694         $r_jury = $_REQUEST['jury'];
<a name="l00695"></a>00695         $r_serie = $_REQUEST['serie'];
<a name="l00696"></a>00696         <span class="keywordflow">if</span> (count ($tSeries[$r_jury]) == 1)
<a name="l00697"></a>00697           {
<a name="l00698"></a>00698             <span class="comment">// une seule serie =&gt; on la choisit</span>
<a name="l00699"></a>00699             $r_serie = $tSeries[$r_jury][0];
<a name="l00700"></a>00700           }
<a name="l00701"></a>00701         $tdSeries = <span class="stringliteral">"&lt;INPUT type='hidden' name='serie' value='$r_serie'/&gt;\n"</span>;
<a name="l00702"></a>00702         <span class="keywordflow">foreach</span> ($tSeries[$r_jury] as $serie)
<a name="l00703"></a>00703         {
<a name="l00704"></a>00704           <span class="keywordflow">if</span> ($serie == $r_serie)
<a name="l00705"></a>00705             $style = $styleBoutonActif;
<a name="l00706"></a>00706           <span class="keywordflow">else</span>
<a name="l00707"></a>00707             $style = $styleBouton;
<a name="l00708"></a>00708           $tdSeries. =
<a name="l00709"></a>00709             <span class="stringliteral">"&lt;INPUT type='submit' class='forml' name='step2' value='$serie' style='$style' "</span>.
<a name="l00710"></a>00710             <span class="stringliteral">"onClick=\"document.forms['form_notes'].serie.value='$serie';document.forms['form_notes'].matiere.value='';\"/&gt;&lt;br/&gt;\n"</span>;
<a name="l00711"></a>00711           <span class="comment">//"&lt;INPUT type='submit' class='fondo' name='resultats' value='R&amp;eacute;sultats $serie'".</span>
<a name="l00712"></a>00712           <span class="comment">//"onClick=\"document.forms['form_notes'].serie.value='$serie';\"/&gt;&lt;br/&gt;&amp;nbsp;\n";</span>
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714         <span class="keywordflow">if</span> ($r_serie != '')
<a name="l00715"></a>00715           {
<a name="l00716"></a>00716             <a class="code" href="inc-referentiel_8php.html#38c3065b99469bad788c627a7b70360b" title="Met les decisions a jour.">odb_maj_decisions</a> (<a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>, $r_jury, 3, 1);
<a name="l00717"></a>00717             <a class="code" href="inc-referentiel_8php.html#38c3065b99469bad788c627a7b70360b" title="Met les decisions a jour.">odb_maj_decisions</a> (<a class="code" href="inc-pdf-attestations_8php.html#b372e2dd50f4a592a1226a01290a2f4f">$annee</a>, $r_jury, 3, 2);
<a name="l00718"></a>00718 
<a name="l00719"></a>00719             $r_matiere = $_REQUEST['matiere'];
<a name="l00720"></a>00720             <a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a> =
<a name="l00721"></a>00721               <span class="stringliteral">"SELECT DISTINCT id_matiere, matiere, id_serie from odb_ref_examen exa, odb_ref_serie ser, odb_ref_matiere mat\n where exa.annee=$annee and ser.serie='$r_serie' and ser.id=exa.id_serie and mat.id=exa.id_matiere\n ORDER BY matiere"</span>;
<a name="l00722"></a>00722             <a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a> = <a class="code" href="inc-odb_8php.html#cc73cdf19f49ae7162c99fd07a614e88" title="Execute une requete sql.">odb_query</a> (<a class="code" href="inc-pdf-attestations_8php.html#047170d6020a882807665812a27e2525">$sql</a>, __FILE__, __LINE__);
<a name="l00723"></a>00723             $id_serie = 0;
<a name="l00724"></a>00724             <span class="keywordflow">while</span> ($row = mysql_fetch_array (<a class="code" href="inc-ezpdf_8php.html#112ef069ddc0454086e3d1e6d8d55d07">$result</a>))
<a name="l00725"></a>00725               {
<a name="l00726"></a>00726                 $id_matiere = $row['id_matiere'];
<a name="l00727"></a>00727                 $tMatieres[$id_matiere] = $row['matiere'];
<a name="l00728"></a>00728                 $id_serie = $row['id_serie'];
<a name="l00729"></a>00729               }
<a name="l00730"></a>00730             $tMatieres[<a class="code" href="odb__notes_8php.html#97b8c6303969d0488dd928447cf9fa13">ID_MATIERE_EF1</a>] = <a class="code" href="odb__notes_8php.html#14b1ddd5185370cebc79b413fe982f91">LIB_MATIERE_EF1</a>;
<a name="l00731"></a>00731             $tMatieres[<a class="code" href="odb__notes_8php.html#da2834629114affadacc37cdf87c3dde">ID_MATIERE_EF2</a>] = <a class="code" href="odb__notes_8php.html#44bb74f0b10b6ea05ff85ecaf145c8ea">LIB_MATIERE_EF2</a>;
<a name="l00732"></a>00732             $tMatieres[<a class="code" href="odb__notes_8php.html#f29ef43f72bda613ccc526c3881f2434">ID_MATIERE_EPS</a>] = <a class="code" href="odb__notes_8php.html#9ca1ed191fcdd936b992ce72239444f1">LIB_MATIERE_EPS</a>;
<a name="l00733"></a>00733             <span class="comment">//echo $sql;</span>
<a name="l00734"></a>00734             $tdMatieres =
<a name="l00735"></a>00735               <span class="stringliteral">"&lt;INPUT type='hidden' name='matiere' value='$r_matiere'/&gt;\n"</span>.
<a name="l00736"></a>00736               <span class="stringliteral">"&lt;INPUT type='hidden' name='id_matiere' value='$id_matiere'/&gt;\n"</span>.
<a name="l00737"></a>00737               <span class="stringliteral">"&lt;INPUT type='hidden' name='id_serie' value='$id_serie'/&gt;\n"</span>;
<a name="l00738"></a>00738             <span class="keywordflow">foreach</span> ($tMatieres as $id_matiere = &gt;$matiere)
<a name="l00739"></a>00739             {
<a name="l00740"></a>00740               <span class="keywordflow">if</span> ($matiere == $r_matiere)
<a name="l00741"></a>00741                 $style = 'font-weight:bold;';
<a name="l00742"></a>00742               <span class="keywordflow">else</span>
<a name="l00743"></a>00743                 $style = 'font-weight:normal;';
<a name="l00744"></a>00744               <span class="keywordflow">if</span> ($id_matiere &lt; 0)
<a name="l00745"></a>00745                 $style. = 'background-color:#ece;';
<a name="l00746"></a>00746               $tdMatieres. =
<a name="l00747"></a>00747                 <span class="stringliteral">"&lt;INPUT type='submit' class='forml' name='step3' value=\"$matiere\" style='$style' "</span>.
<a name="l00748"></a>00748                 <span class="stringliteral">"onClick=\"document.forms['form_notes'].id_matiere.value='$id_matiere';document.forms['form_notes'].matiere.value='"</span>.
<a name="l00749"></a>00749                 urlencode ($matiere).<span class="stringliteral">"';\"/&gt;&lt;br/&gt;\n"</span>;
<a name="l00750"></a>00750             }
<a name="l00751"></a>00751           }
<a name="l00752"></a>00752         <span class="keywordflow">else</span>
<a name="l00753"></a>00753           $tdMatieres = <span class="stringliteral">"Veuillez choisir une s&amp;eacute;rie"</span>;
<a name="l00754"></a>00754       }
<a name="l00755"></a>00755     <span class="keywordflow">else</span>
<a name="l00756"></a>00756       $tdSeries = 'Veuillez s&amp;eacute;lectionner un jury';
<a name="l00757"></a>00757 
<a name="l00758"></a>00758     <span class="keywordflow">foreach</span> ($tJurys as <a class="code" href="inc-pdf-attestations_8php.html#1f711ee6f46195ba9dfce71eaf779d02">$jury</a>)
<a name="l00759"></a>00759     {
<a name="l00760"></a>00760       <span class="keywordflow">if</span> ($jury == $_REQUEST['jury'])
<a name="l00761"></a>00761         $style = $styleBoutonActif;
<a name="l00762"></a>00762       <span class="keywordflow">else</span>
<a name="l00763"></a>00763         $style = $styleBouton;
<a name="l00764"></a>00764       <span class="keywordflow">if</span> ($isAdmin)
<a name="l00765"></a>00765         {
<a name="l00766"></a>00766           $class = 'fondo';
<a name="l00767"></a>00767           <span class="keywordflow">if</span> ($jury % 10 == 0)
<a name="l00768"></a>00768             $style. = 'color:#f00;';
<a name="l00769"></a>00769         }
<a name="l00770"></a>00770       <span class="keywordflow">else</span>
<a name="l00771"></a>00771         $class = 'forml';
<a name="l00772"></a>00772       <span class="keywordflow">if</span> (count ($tSeries[$jury]) &gt; 1)
<a name="l00773"></a>00773         <a class="code" href="inc-pdf-convocation_8php.html#96f46783d0d9ef01d8a88b9ee6387696">$s</a> = 's : ';
<a name="l00774"></a>00774       <span class="keywordflow">else</span>
<a name="l00775"></a>00775         <a class="code" href="inc-pdf-convocation_8php.html#96f46783d0d9ef01d8a88b9ee6387696">$s</a> = '';
<a name="l00776"></a>00776       $titleJury =
<a name="l00777"></a>00777         <span class="stringliteral">"header=[Jury $jury]    body=[S&amp;eacute;rie$s "</span>.implode (', ',
<a name="l00778"></a>00778                                                              $tSeries[$jury]).
<a name="l00779"></a>00779         <span class="stringliteral">"]      fade=[on] fadespeed=[0.5]"</span>;
<a name="l00780"></a>00780       $tdJurys. =
<a name="l00781"></a>00781         <span class="stringliteral">"&lt;INPUT title=\"$titleJury\" type='submit' class='$class'       name='step2' value='Jury "</span>.
<a name="l00782"></a>00782         str_pad ($jury, 3, <span class="charliteral">'0'</span>,
<a name="l00783"></a>00783                  PADDING_LEFT).<span class="stringliteral">"' style='$style' "</span>.
<a name="l00784"></a>00784         <span class="stringliteral">"onClick=\"document.forms['form_notes'].jury.value='$jury';document.forms['form_notes'].serie.value=''; document.forms['form_notes'].matiere.value='';\"/&gt;&lt;br/&gt;\n"</span>;
<a name="l00785"></a>00785     }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     $formNotes =
<a name="l00788"></a>00788       <span class="stringliteral">"&lt;form name='form_notes' action='"</span>.generer_url_ecrire ('odb_notes').
<a name="l00789"></a>00789       <span class="stringliteral">"' method='get' class='spip_xx-small'&gt;\n"</span>.
<a name="l00790"></a>00790       <span class="stringliteral">"&lt;INPUT type='hidden' name='exec' value='odb_notes'/&gt;\n"</span>.
<a name="l00791"></a>00791       <span class="stringliteral">"&lt;TABLE class='spip' width='100%'&gt;\n&lt;tr&gt;&lt;th&gt;Jury&lt;/th&gt;&lt;th&gt;S&amp;eacute;rie&lt;/th&gt;&lt;th&gt;Mati&amp;egrave;re&lt;/th&gt;&lt;/tr&gt;\n"</span>.
<a name="l00792"></a>00792       <span class="stringliteral">"&lt;tr&gt;\n\t&lt;td width='20%' style='vertical-align:top;'&gt;$tdJurys&lt;/td&gt;"</span>.
<a name="l00793"></a>00793       <span class="stringliteral">"\n\t&lt;td width='15%' style='vertical-align:top;'&gt;$tdSeries &lt;/td&gt;"</span>.
<a name="l00794"></a>00794       <span class="stringliteral">"\n\t&lt;td width='50%' style='vertical-align:top;'&gt;$tdMatieres &lt;/td&gt;\n&lt;/tr&gt;\n"</span>.
<a name="l00795"></a>00795       <span class="stringliteral">"&lt;/form&gt;\n"</span>;
<a name="l00796"></a>00796     <span class="comment">//$selectSerie="&lt;OPTION VALUE=''&gt;-=[S&amp;eacute;rie]=-&lt;/OPTION&gt;\n";</span>
<a name="l00797"></a>00797     <span class="comment">//$selectMatiere="&lt;OPTION VALUE=''&gt;-=[Mati&amp;egrave;re]=-&lt;/OPTION&gt;\n";</span>
<a name="l00798"></a>00798     <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a> = $formNotes;
<a name="l00799"></a>00799   }
<a name="l00800"></a>00800 
<a name="l00801"></a>00801   <span class="keywordflow">if</span> (!$isPleinEcran)
<a name="l00802"></a>00802     {
<a name="l00803"></a>00803       debut_gauche ();
<a name="l00804"></a>00804       debut_boite_info ();
<a name="l00805"></a>00805       echo $gauche;
<a name="l00806"></a>00806       fin_boite_info ();
<a name="l00807"></a>00807       <span class="keywordflow">if</span> (strlen ($gauche2) &gt; 0)
<a name="l00808"></a>00808         {
<a name="l00809"></a>00809           echo '&lt;p/&gt;';
<a name="l00810"></a>00810           debut_cadre_relief (<span class="stringliteral">""</span>, <span class="keyword">false</span>, <span class="stringliteral">""</span>, <a class="code" href="inc-pdf-attestations_8php.html#43e5b5a819fedbd12b8cf5421ba6985e">$titre</a> = _T (<span class="stringliteral">"Conseils"</span>));
<a name="l00811"></a>00811           echo $gauche2;
<a name="l00812"></a>00812           fin_cadre_relief ();
<a name="l00813"></a>00813         }
<a name="l00814"></a>00814       <span class="keywordflow">if</span> ($isAdmin)
<a name="l00815"></a>00815         <a class="code" href="inc-referentiel_8php.html#ca269ae75f013c9730f590443481c7f9">odb_raccourcis</a> ('');
<a name="l00816"></a>00816       creer_colonne_droite ();
<a name="l00817"></a>00817     }
<a name="l00818"></a>00818   debut_droite ();
<a name="l00819"></a>00819   <span class="keywordflow">if</span> ($titrePrincipal == '')
<a name="l00820"></a>00820     $titrePrincipal = <span class="stringliteral">"Saisie des notes $annee ($deliberationCentre)"</span>;
<a name="l00821"></a>00821   <span class="keywordflow">if</span> ($isDessineCadrePrincipal)
<a name="l00822"></a>00822     debut_cadre_relief (<span class="stringliteral">""</span>, <span class="keyword">false</span>, <span class="stringliteral">""</span>, <a class="code" href="inc-pdf-attestations_8php.html#43e5b5a819fedbd12b8cf5421ba6985e">$titre</a> = _T ($titrePrincipal));
<a name="l00823"></a>00823   <span class="keywordflow">else</span>
<a name="l00824"></a>00824     debut_boite_info ();
<a name="l00825"></a>00825   echo <a class="code" href="resultats__ajournes__par__centre_8php.html#9e168f4152c267835864153c54449583">$msg</a>;
<a name="l00826"></a>00826   <span class="keywordflow">if</span> ($isDessineCadrePrincipal)
<a name="l00827"></a>00827     fin_cadre_relief ();
<a name="l00828"></a>00828   <span class="keywordflow">else</span>
<a name="l00829"></a>00829     fin_boite_info ();
<a name="l00830"></a>00830   <span class="keywordflow">if</span> ($r_type == '')
<a name="l00831"></a>00831     {
<a name="l00832"></a>00832       <span class="keywordflow">if</span> ($isEcrit)
<a name="l00833"></a>00833         $r_type = 'Ecrit';
<a name="l00834"></a>00834       elseif ($isPratique) $r_type = 'Pratique';
<a name="l00835"></a>00835       elseif ($isOral) $r_type = 'Oral';
<a name="l00836"></a>00836       <span class="keywordflow">else</span>
<a name="l00837"></a>00837       $r_type = 'Divers';
<a name="l00838"></a>00838     }
<a name="l00839"></a>00839   <span class="keywordflow">if</span> (isset ($_REQUEST['step3']) || isset ($_REQUEST['step4']))
<a name="l00840"></a>00840     {
<a name="l00841"></a>00841       echo <a class="code" href="inc-html_8php.html#26ce7f961b7c017f444305029440e0d3" title="Ajoute du code javascript.">putJavascript</a> (<span class="stringliteral">"document.forms['form_$r_type'].note.focus();"</span>);
<a name="l00842"></a>00842     }
<a name="l00843"></a>00843 
<a name="l00844"></a>00844   fin_cadre_relief ();
<a name="l00845"></a>00845   fin_page ();
<a name="l00846"></a>00846   exit;
<a name="l00847"></a>00847 
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 ? &gt;
</pre></div><hr size="1"><address style="text-align: right;"><small>Généré le Mon Mar 17 22:53:00 2008 pour Siou par&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.3 </small></address>
</body>
</html>
