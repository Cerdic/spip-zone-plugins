#SET{self,#SELF|parametre_url{debut_galerie,''}}
#SET{self,#GET{self}|parametre_url{extension,''}}
<ul class='choix media-type'>
[<li>(#GET{self}|parametre_url{media,''}|aouspan{<:gestdoc:tous_les_medias:>,#ENV{media,''}|=={''},ajax})</li>]
<BOUCLE_medias(DOCUMENTS){id_rubrique ?}{id_article ?}{id_breve ?}{id_document ?}{recherche ?}{statut==.*}{compteur types_documents, media}{media IN image,audio,video,file}>
[<li>(#GET{self}|parametre_url{media,#MEDIA}|aouspan{#VAL{gestdoc:media_}|concat{#MEDIA}|_T|concat{' (',#COMPTEUR{types_documents},')'},#ENV{media}|=={#MEDIA},ajax})</li>]
</BOUCLE_medias>
</ul>
<B_types>
<ul class='choix type'>
<BOUCLE_types(TYPES_DOCUMENTS){media=#ENV{media,''}}>
<BOUCLE_compte(DOCUMENTS){id_rubrique ?}{id_article ?}{id_breve ?}{id_document ?}{recherche ?}{statut==.*}{extension} />
[(#TOTAL_BOUCLE|oui)[<li>(#GET{self}|parametre_url{extension,#EXTENSION}|aouspan{#TITRE|concat{' (',#TOTAL_BOUCLE,')'},#ENV{extension}|=={#EXTENSION},ajax})</li>]]
<//B_compte>
</BOUCLE_types>
</ul>
</B_types>
<ul class='choix statut'>
[<li>(#GET{self}|parametre_url{statut,''}|aouspan{<:gestdoc:documents_tous:>,#ENV{statut,.*}|=={.*},ajax})</li>]
[<li>(#GET{self}|parametre_url{statut,publie}|aouspan{<:gestdoc:documents_publies:>,#ENV{statut}|=={publie},ajax})</li>]
[<li>(#GET{self}|parametre_url{statut,prepa|poubelle}|aouspan{<:gestdoc:documents_non_publies:>,#ENV{statut}|=={prepa|poubelle},ajax})</li>]
</ul>
<ul class='choix distant'>
[<li>(#GET{self}|parametre_url{distant,''}|aouspan{<:gestdoc:documents_tous:>,#ENV{distant,''}|=={''},ajax})</li>]
[<li>(#GET{self}|parametre_url{distant,'oui'}|aouspan{<:gestdoc:documents_distants:>,#ENV{distant,''}|=={'oui'},ajax})</li>]
[<li>(#GET{self}|parametre_url{distant,'non'}|aouspan{<:gestdoc:documents_locaux:>,#ENV{distant,''}|=={'non'},ajax})</li>]
</ul>
<ul class='choix brises'>
[<li>(#GET{self}|parametre_url{brise,''}|aouspan{<:gestdoc:documents_tous:>,#ENV{brise,0}|=={0},ajax})</li>]
[<li>(#GET{self}|parametre_url{brise,1}|aouspan{<:gestdoc:documents_brises:>,#ENV{brise,0}|=={1},ajax})</li>]
[(#ENV{brise,0}|oui)
[<li>(#URL_ACTION_AUTEUR{verifier_documents_brises,'1',#GET{self}}|aouspan{<:gestdoc:verifier_documents_brises:>,0,ajax})</li>]]
</ul>
<div class="galerie[ media-(#ENV{media,''})]">
	<B_galerie>
	<h2>[(#GRAND_TOTAL|gestdoc_affiche_un_ou_plusieurs{#VAL{gestdoc:un_}|concat{#ENV{media,document}},#VAL{gestdoc:des_}|concat{#ENV{media,document},s}})]</h2>
	<p class="pagination">
	[ (#SELF|parametre_url{sens,-1}|aouspan{#CHEMIN{img_pack/croissant-16.png}|tag_img{<:gestdoc:par_tri_croissant:>},#ENV{sens,1}|<{0},ajax})]
	[<span class='invisible'>|</span> (#SELF|parametre_url{sens,1}|aouspan{#CHEMIN{img_pack/decroissant-16.png}|tag_img{<:gestdoc:par_tri_decroissant:>},#ENV{sens,1}|>{0},ajax})]
	[| (#SELF|parametre_url{tri,id_document}|aouspan{<:gestdoc:par_id:>,#ENV{tri,id_document}|=={id_document},ajax})]
	[| (#SELF|parametre_url{tri,date}|aouspan{<:gestdoc:par_date:>,#ENV{tri,id_document}|=={date},ajax})]
	[| (#SELF|parametre_url{tri,taille}|aouspan{<:gestdoc:par_taille:>,#ENV{tri,id_document}|=={taille},ajax})]
	[| (#SELF|parametre_url{tri,largeur}|aouspan{<:gestdoc:par_largeur:>,#ENV{tri,id_document}|=={largeur},ajax})]
	[| (#SELF|parametre_url{tri,hauteur}|aouspan{<:gestdoc:par_hauteur:>,#ENV{tri,id_document}|=={hauteur},ajax})]
	[| (#SELF|parametre_url{tri,'titre'}|aouspan{<:gestdoc:par_titre:>,#ENV{tri,id_document}|=={'titre'},ajax})]
	[| (#PAGINATION{page})]</p>
	<table>
	<thead>
		<th></th>
		<th class="id"><:gestdoc:id:></th>
		<th></th>
		<th><:gestdoc:logo:></th>
		<th><:gestdoc:infos:></th>
		<th><:gestdoc:descriptif:></th>
	</thead>
	<BOUCLE_galerie(DOCUMENTS) {id_rubrique ?}{id_article ?}{id_breve ?}{id_document ?}{recherche ?} {par #ENV{tri,id_document}}{inverse #ENV{sens,1}|>{0}}{media?}{extension?}{distant?}{brise?}{statut==#ENV{statut,.*}}{pagination 10}>
	<tr class="[(#ENV{media}|non)[ media-(#MEDIA)]]">
	#SET{missing,''}
		[(#EXTENSION|in_any{#ARRAY{0,gif,1,png,2,jpg}}|oui)
		#SET{logo,#URL_DOCUMENT|image_reduire{250,100}}
		[(#GET{logo}|match{'^<img'}|non)#SET{logo,#LOGO_DOCUMENT}#SET{missing,' '}]
		][(#EXTENSION|in_any{#ARRAY{0,gif,1,png,2,jpg}}|non)
		#SET{logo,#LOGO_DOCUMENT}
		[(#DISTANT|=={oui}|non)#SET{missing,#FICHIER|file_exists|non}]
		]
		<td class='infos'>
		[(#ENV{media}|non|et{#MEDIA|!={file}})<img src='#CHEMIN{img_pack/#MEDIA|replace{image,photo}|concat{-22.png}}' width='22' height='22' alt='<:gestdoc:fichier_manquant:>' />]
		[(#GET{missing}|oui)<img src='#CHEMIN{img_pack/unreadable-22.png}' width='22' height='22' alt='<:gestdoc:fichier_manquant:>' />]
		[(#DISTANT|=={oui}|oui)<img src='#CHEMIN{img_pack/distant-22.png}' width='22' height='22' alt='<:gestdoc:fichier_distant:>' />]
		</td>
		<td class="id">
			<strong>#ID_DOCUMENT</strong>
		</td>
		<td class='statut'>
		[(#ID_DOCUMENT|gestdoc_puce_statut_document{#STATUT})]
		</td>
		<td class="logo">
		[<a href="#URL_DOCUMENT" type="#MIME_TYPE"[ title="(#FICHIER)"]>(#GET{logo}||inserer_attribut{alt,[(#TITRE|couper{60}|texte_backend)]})</a>]
		</td>
		<td class="exif">
			[<strong class="extension">(#EXTENSION)</strong>]
			[<div class="dimensions">(#LARGEUR|?{[(#LARGEUR)[ x (#HAUTEUR) pixels]],''})</div>]
			[<div class="taille">(#TAILLE|taille_en_octets)</div>]
			[<div class="date">(#DATE|affdate{d/m/Y})</div>]
			<B_liens>
			[(#TOTAL_BOUCLE|>{1}|oui)
			<a href='#' onclick="jQuery(this).next().show();$(this).hide();return false;">[(#TOTAL_BOUCLE|gestdoc_affiche_un_ou_plusieurs{gestdoc:une_utilisation,gestdoc:des_utilisations})]</a><div style='display: none;'>
			]
			<BOUCLE_liens(DOCUMENTS_LIENS){id_document}{'<br />'}>
			<a href="[(#ID_OBJET|generer_url_entite{#OBJET,'','',0})]">#OBJET #ID_OBJET</a>
			</BOUCLE_liens>
			[(#TOTAL_BOUCLE|>{1}|oui)</div>]
			</B_liens>
		</td>
		<td class="descriptif">
			[<strong class="#EDIT{titre}">(#TITRE|sinon{<i>sans titre</i>})</strong>]
			[<div class="#EDIT{descriptif}">(#DESCRIPTIF|sinon{...})</div>]
		</td>
	</tr>
	</BOUCLE_galerie>
	</table>
	[<p class="pagination">(#PAGINATION{page})</p>]
	</B_galerie>
	<h2>[(#VAL{gestdoc:aucun_}|concat{#ENV{media,document}}|_T)]</h2>
	<//B_galerie>
</div><!--#galerie-->