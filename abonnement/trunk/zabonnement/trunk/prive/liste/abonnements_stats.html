[(#SET{defaut_tri,#ARRAY{
	date,-1,
	validite,-1,
	commande,1
	id_auteur,1
	prix,1
}})
]<B_liste_abonnements>
#ANCRE_PAGINATION
<div class="liste-elements abonnements">
<table class='spip liste'>
[<caption><strong class="caption">(#ENV*{titre,<:abo:info_tous_abonnements:>})</strong></caption>]
	<thead>
		<tr class='first_row'>
			<th class='id'>[(#TRI{id_abonnement,<:info_numero_abbreviation:>,ajax})]</th>
			<th class='commande'><:abo:commande:></th>
			<th class='relance'>[(#TRI{stade_relance,<:abo:relance:>,ajax})]</th>
			<th class='qui'>[(#TRI{id_auteur,<:abo:abonnement_client:>,ajax})]</th>
			<th class='date'>[(#TRI{date,<:abo:abonnement_debut:>,ajax})]</th>
			<th class='validite'>[(#TRI{validite,<:abo:abonnement_fin:>,ajax})]</th>
			<th class='descriptif'>[(#TRI{objet,<:abo:contenu:>,ajax})]</th>
			<th class='prix'>[(#TRI{prix,<:abo:montant:>,ajax})]</th>
			<th class='action'></th>
		</tr>
	</thead>
	<tbody>
	<BOUCLE_liste_abonnements(CONTACTS_ABONNEMENTS)
		{id_auteur?}{id_abonnement?}{where?}{objet?}
		{stade_relance ?}{tri #ENV{order,date},#GET{defaut_tri}}
		{pagination #ENV{nb,30}}>
		<tr class="[(#COMPTEUR_BOUCLE|alterner{row_odd,row_even})]">
			<td class='id'>---</td>
			<td class='commande'>
				<BOUCLE_quellecommand(COMMANDES_DETAILS){id_commandes_detail}>
				<a href="#URL_ECRIRE{commandes}">#ID_COMMANDE</a>#SET{id_commande,#ID_COMMANDE}
				</BOUCLE_quellecommand><:abo:aucune_commande:><//B_quellecommand>
			</td>
			<td class='relance'>[(#STADE_RELANCE)]</td>
			<td class='qui'><a href="[(#ID_AUTEUR|generer_url_entite{auteur})]">#INFO_NOM{auteur,#ID_AUTEUR}</a></td>
			<td class='date'>[(#DATE|affdate)]</td>
			<td class='date validite'>[(#VALIDITE|affdate)]</td>
			<td class='descriptif'>
			<BOUCLE_zabo(CONDITION){si #OBJET|=={abonnement}}>
					<BOUCLE_detail_abonnement(ABONNEMENTS){id_abonnement=#ID_OBJET}>
					<:abo:abonnement:> <a href="#URL_ECRIRE{abonnements}">[(#TITRE)]</a>
					#SET{prix,#PRIX}
					</BOUCLE_detail_abonnement>
			</BOUCLE_zabo>
			<BOUCLE_zarti(CONDITION){si #OBJET|=={article}}>
					<BOUCLE_detail_article(ARTICLES){id_article=#ID_OBJET}>
					<:abo:article:> <a href="#URL_ECRIRE{articles,id_article=#ID_ARTICLE}">[(#TITRE)]</a>
					#SET{prix,#PRIX}
					</BOUCLE_detail_article>
			</BOUCLE_zarti>
			<BOUCLE_zrubi(CONDITION){si #OBJET|=={rubrique}}>
					<BOUCLE_detail_rubrique(RUBRIQUES){id_rubrique=#ID_OBJET}>
					<:abo:rubrique:> <a href="#URL_ECRIRE{naviguer,id_rubrique=#ID_RUBRIQUE}">[(#TITRE)]</a>
					#SET{prix,#PRIX}
					</BOUCLE_detail_rubrique>
			</BOUCLE_zrubi>
			</td>
			<td class='montant'>#GET{prix}</td>
			<td class='action'>
			[(#GET{id_commande}|oui)
				[(#AUTORISER{voir,abonnement,#ID_ABONNEMENT})
					[<a href="(#URL_PAGE{facture}
						|parametre_url{redirect,#SELF}
						|parametre_url{id_commande,#GET{id_commande}})"><:abo:facture:></a>]
				]
			]
				[(#AUTORISER{supprimer,abonnement,#ID_ABONNEMENT})
					[(#BOUTON_ACTION{				
						<:abo:supprimer:>,
						[(#URL_ACTION_AUTEUR{supprimer_contactabonnement,contactabonnement-#ID_AUTEUR-#ID_OBJET-#OBJET}|parametre_url{redirect,#SELF})],
						ajax,<:abo:confirmer_supprimer_abonnement:>})]
				]
			</td>
		</tr>
	</BOUCLE_liste_abonnements>
	</tbody>
</table>
[<p class='pagination'>(#PAGINATION{prive})</p>]
</div>
</B_liste_abonnements>[
<div class="liste-elements abonnements"><strong class="caption">(#ENV*{sinon,''})</strong></div>
]<//B_liste_abonnements>
