[(#REM)
/*
 *  Plugin BrowserID pour SPIP
 *
 *  (c) Fil 2012 - Licence GNU/GPL
 *
 */

]

[(#REM)
	le formulaire de login normal continue de fonctionner ;
	on pourrait le desactiver avec une config
]
<div id="browserid_traditionnel">
<INCLURE{fond=prive/formulaires/login,env} />
</div>



<script type="text/javascript">
[
	var url = (#ENV{url}|sinon{#EVAL{_DIR_RESTREINT_ABS}}|_q);
	[(#AUTORISER{ecrire}|?{document.location = url;})]
]

function browserid_message(m) {
	$("#browserid_login .message")
	.html(m);
}

function browserid_login() {
	navigator.id.getVerifiedEmail(browserid_verify_server);
	browserid_message("Veuillez autoriser les popups");
}

function browserid_start() {
	browserid_message("connexion BrowserID en coursâ€¦");
//	$.getScript('?page=browserid.js&v=8', browserid_login);
	browserid_login();
}
</script>
<div id="browserid_login">
<button onclick="browserid_start();">[<img src="(#CHEMIN{images/sign_in_red.png})" />]</button>
<div class="message"></div>
</div>
<script type="text/javascript">
if (!$("#browserid_traditionnel .erreur").size())
$("#browserid_traditionnel")
.hide()
.parent()
.append("<button onclick='$(\"#browserid_traditionnel\").toggle();'>login traditionnel</button>");
</script>
[<script src="(#URL_PAGE{browserid.js}|parametre_url{v,9})" type="text/javascript"></script>]

