[(#REM)

	Controleur pour le crayon 'vignette'
	Ce crayon ne s'applique qu'aux documents
	On le mets dans une boucle documents contenant le crit√®re {tous} au cas
	ou le document ne soit pas considere comme publie

]
#CACHE{0}

<BOUCLE_document(DOCUMENTS){id_document}{tous}>
[(#SET{image,[(#ID_VIGNETTE|>{0}|?{#LOGO_DOCUMENT})]})]
[(#GET{image}|?{
	[(#SET{vignette,[(#GET{image}|image_reduire{64})]})]
	[(#REM) hacke l'url pour eviter le cache du navigateur ]
	[(#SET{url,[(#GET{vignette}|extraire_attribut{src}
		|parametre_url{s,#EVAL{time()}})]})]
	[(#SET{legend,
		remplacer la vignette
		[((#GET{image}
		|extraire_attribut{width})&times;[(#GET{image}
		|extraire_attribut{height})]px)]&nbsp;:
	})]
	[(#SET{supprimer,
		[<br /><label>
			<input type="checkbox" name="(#ENV{name_vignette})_supprimer" id="#ENV{name_vignette}_supprimer" /> <:crayons:bouton_supprimer:></label>]
	})]
})]


<fieldset[ style="(#ENV{style}); border:none;"]>
[<div style="float:#LANG_RIGHT">(#GET{vignette}|inserer_attribut{src,#GET{url}}
	|inserer_attribut{style,vertical-align:middle;})</div>]
<legend>
	<small>[(#GET{legend}|sinon{<:crayons:legend_controleur_vignette:>})]</small>
</legend>

<input class="crayon-active" name="#ENV{name_vignette}" type="file"
onchange="if (this.value && !this.value.match(/\.(png|jpeg|jpg|gif)$/i)) { alert('<:crayons:message_image_obligatoire:>'); this.value=''; }; var q=cQuery('##ENV{name_vignette}_supprimer').parent(); this.value ? q.hide() : q.show();" size="10" />

#GET{supprimer}

</fieldset>
</BOUCLE_document>