<BOUCLE_doc (DOCUMENTS) {id_document} {tout}>
[(#REM)

	Modele pour <doc> en dl/dt/dd
	cf. http://pompage.net/pompe/listesdefinitions/

	La largeur de la legende est egale a la largeur de l'image
	avec un minimum de 120px, et un maximum de 350px.

	Dans le cas d'une simple image (mode=image), on affiche
	le document lui-meme, sans lien de telechargement
]
[(#MODE|=={image}|oui)
	#SET{fichier,#URL_DOCUMENT}
	#SET{width,#LARGEUR}
	#SET{height,#HAUTEUR}
	#SET{url,#ENV{lien}}
]
[(#MODE|=={image}|non)
	[(#SET{fichier,[(#LOGO_DOCUMENT|extraire_attribut{src})]})]
	[(#SET{width,[(#LOGO_DOCUMENT|extraire_attribut{width})]})]
	[(#SET{height,[(#LOGO_DOCUMENT|extraire_attribut{height})]})]
	#SET{url,#ENV{lien,#URL_DOCUMENT}}
]





[(#REM) qd titre ou descriptif on utilise le modele en dl sinon modele <img> Ã  base de span]

[(#TITRE|!={''}|oui)
	#SET{dl,'true'}
]

[(#DESCRIPTIF|!={''}|oui)
	#SET{dl,'true'}
	#SET{desc,'true'}
]

[(#GET{dl}|=={'true'}|oui)
<dl class='spip_document_#ID_DOCUMENT spip_documents[ spip_documents_(#ENV{align})][ (#ENV{class})] spip_lien_ok'[ style='float:(#ENV{align}|match{left|right});[width:(#GET{width}|min{350}|max{120})]px;']>
<dt>[<a href="(#GET{url})"[ class="(#ENV{lien_class})"][(#MODE|=={image}|non)[ title="(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html|sinon{<:info_document:>}}})[(#ENV{lien}|?{'',' - '})][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|non)[(#TYPE_DOCUMENT) - ][(#TAILLE|taille_en_octets)]][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|oui)<:accessibilite:voir_grand:>]"]] [(#MODE|=={image}|oui)[ title="(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html}})"]][ type="(#ENV{lien}|?{#ENV{lien_mime},#MIME_TYPE})"][ lang="(#ENV{langue})"]>]<img src='#GET{fichier}' width='#GET{width}' height='#GET{height}'[(#MODE|=={image}|non) alt="[(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html|sinon{<:info_document:>}}})[(#ENV{lien}|?{'',' - '})][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|non)[(#TYPE_DOCUMENT) - ][(#TAILLE|taille_en_octets)]][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|oui)<:accessibilite:voir_grand:>]]"][(#MODE|=={image}|oui) alt="[(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html}})]"][(#DESCRIPTIF|oui)[(#ENV{legende}|?{' ',longdesc="#desc-#ID_DOCUMENT"})longdesc="[(#URL_PAGE{longdesc,id=#ID_DOCUMENT}|parametre_url{'lang',#ENV{langue,#LANG}})]"]][ lang="(#ENV{langue})"] />[(#GET{url}|?{</a>})]</dt>
[(#GET{desc}|=={'true'}|oui)
[<dt class="#EDIT{titre} spip_doc_titre"[ style="width:(#GET{width}|min{350}|max{120})px;"]><strong>(#ENV*{titre}|propre|PtoBR|sinon{#TITRE})</strong></dt>]
]
[(#GET{desc}|=={''}|oui)
[<dd class="#EDIT{titre} spip_doc_titre"[ style="width:(#GET{width}|min{350}|max{120})px;"]><strong>(#ENV*{titre}|propre|PtoBR|sinon{#TITRE})</strong></dd>]
]
[<dd id="desc-#ID_DOCUMENT" class="#EDIT{descriptif} spip_doc_descriptif"[ style="width:(#GET{width}|min{350}|max{120})px;"]>(#ENV*{legende}|propre|PtoBR|sinon{#DESCRIPTIF|PtoBR})[(#NOTES|PtoBR)]</dd>]
</dl>
]

[(#GET{dl}|=={''}|oui)
<span class="spip_document_#ID_DOCUMENT spip_documents[ spip_documents_(#ENV{align})][ (#ENV{class})] spip_lien_ok"[ 
	style="float:(#ENV{align}|match{left|right});[ width:(#GET{width})px;]"]>[
	<a href="(#GET{url})"[ class="(#ENV{lien_class})"][ lang="(#ENV{langue})"][ type="(#ENV{lien}|?{#ENV{lien_mime},#MIME_TYPE})"][(#MODE|=={image}|non)[ title="(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html|sinon{<:info_document:>}}})[(#ENV{lien}|?{'',' - '})][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|non)[(#TYPE_DOCUMENT) - ][(#TAILLE|taille_en_octets)]][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|oui)<:accessibilite:voir_grand:>]"]] [(#MODE|=={image}|oui)[ title="(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html}})"]]>]<img src="#GET{fichier}" width="#GET{width}" height="#GET{height}"[ lang="(#ENV{langue})"][(#MODE|=={image}|non) alt="[(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html|sinon{<:info_document:>}}})[(#ENV{lien}|?{'',' - '})][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|non)[(#TYPE_DOCUMENT) - ][(#TAILLE|taille_en_octets)]][(#MIME_TYPE|match{^image/(gif|jpg|jpeg|png)}|oui)<:accessibilite:voir_grand:>]]"][(#MODE|=={image}|oui) alt="[(#ENV{alt}|attribut_html|sinon{#TITRE|attribut_html|sinon{#ENV{lien}|attribut_html}})]"][(#DESCRIPTIF|oui)longdesc="[(#URL_PAGE{longdesc,id=#ID_DOCUMENT}|parametre_url{'lang',#ENV{langue,#LANG}})]"] />[(#GET{url}|?{</a>})]</span>
]
</BOUCLE_doc>





