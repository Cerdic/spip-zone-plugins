[<!--(#REM)

	Modele pour <playliste> qui utilise MediaElement.js

	afficher une playliste
	
	Ex: a partir d'un squelette
	[(#MODELE{playliste}{par=fichier})]
	permet de forcer l'ordre des elements dans la liste
	triee par le nom du fichier mp3.
	Pratique si vos noms de fichiers commencent par 
	un chiffre ;-)
	
-->]#SET{id_first,0}#SET{playlist_id,playlist}
<B_doc>
	<div class="liste documents play-liste">
		[<h2>(#ENV{titre,Playlist})</h2>]
		<dl class='spip_documents spip_documents_playlist[ (#ENV{class})] spip_lien_ok'>
			[(#INCLURE**{fond=players/mejs/player,id_document=#GET{id_first},player=mejs,largeur=1000,playlist=[#(#GET{playlist_id})]})]
			<dd class="mejs-playlist">
				<ul class="liste-items" id="#GET{playlist_id}">
				<BOUCLE_doc (DOCUMENTS)
					{id_document ?}
					{id_article ?}
					{id_album ?}
					{id_objet ?}{objet ?}
					{media=audio}
					{extension=mp3}
					{tri #ENV{par,num titre}}{par titre}{!par date}{0,100}>[(#GET{id_first}|non)#SET{id_first,#ID_DOCUMENT}]
					#SET{titre,#TITRE|sinon{#FICHIER|player_joli_titre|couper{30}}}
					<li class="item short track"
						data-url="[(#FICHIER|attribut_html)]"
						title="[(#GET{titre}|attribut_html)]"><span class="entry-title">[(#TITRE|sinon{[(#FICHIER|player_joli_titre|couper{30})]})]</span><span class="sep"> - </span><small>([(#EXTENSION)][ - (#TAILLE|taille_en_octets)])</small></li>
				</BOUCLE_doc>
				</ul>
			</dd>
		</dl>
	</div>

	[<style>(#INCLURE{#CHEMIN{players/mejs/mejs-feature-playlist.css}|url_absolue_css})</style>]
	[<style>(#INCLURE{#CHEMIN{css/playliste.css}|url_absolue_css})</style>]
	<script>
		jQuery.getScript("#CHEMIN{players/mejs/mejs-feature-playlist.js}",function(){
			jQuery(function(){
				$('audio.mejs-playlist').each(function(){
					var t = this.player;
					t.options.features = ['playlistfeature', 'prevtrack', 'playpause', 'nexttrack', 'loop', 'shuffle', 'playlist', 'current', 'progress', 'duration', 'volume'];
					t.controls.html('');
					var feature;
					for (var featureIndex in t.options.features) {
						feature = t.options.features[featureIndex];
						if (t['build' + feature]) {
							try {
								t['build' + feature](t, t.controls, t.layers, t.media);
							} catch (e) {
								// TODO: report control error
								//throw e;
							}
						}
					}
					t.container.trigger('controlsready');
					// reset all layers and controls
					t.setPlayerSize(t.width, t.height);
					t.setControlsSize();
				});
			})
		});
	</script>
</B_doc>