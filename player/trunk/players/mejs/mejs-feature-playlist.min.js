(function(c){c.extend(mejs.MepDefaults,{loopText:"Repeat On/Off",shuffleText:"Shuffle On/Off",nextText:"Next Track",prevText:"Previous Track",playlistText:"Show/Hide Playlist"});c.extend(MediaElementPlayer.prototype,{buildloop:function(a,b,f,e){var d=c('<div class="mejs-button mejs-loop-button '+(a.options.loop?"mejs-loop-on":"mejs-loop-off")+'"><button type="button" aria-controls="'+a.id+'" title="'+a.options.loopText+'"></button></div>').appendTo(b).click(function(b){a.options.loop=!a.options.loop; c(e).trigger("mep-looptoggle",[a.options.loop]);a.options.loop?d.removeClass("mejs-loop-off").addClass("mejs-loop-on"):d.removeClass("mejs-loop-on").addClass("mejs-loop-off")});this.loopToggle=this.controls.find(".mejs-loop-button")},loopToggleClick:function(){this.loopToggle.trigger("click")},buildshuffle:function(a,b,f,e){var d=c('<div class="mejs-button mejs-shuffle-button '+(a.options.shuffle?"mejs-shuffle-on":"mejs-shuffle-off")+'"><button type="button" aria-controls="'+a.id+'" title="'+a.options.shuffleText+ '"></button></div>').appendTo(b).click(function(b){a.options.shuffle=!a.options.shuffle;c(e).trigger("mep-shuffletoggle",[a.options.shuffle]);a.options.shuffle?d.removeClass("mejs-shuffle-off").addClass("mejs-shuffle-on"):d.removeClass("mejs-shuffle-on").addClass("mejs-shuffle-off")});this.shuffleToggle=this.controls.find(".mejs-shuffle-button")},shuffleToggleClick:function(){this.shuffleToggle.trigger("click")},buildprevtrack:function(a,b,f,e){c('<div class="mejs-button mejs-prevtrack-button mejs-prevtrack"><button type="button" aria-controls="'+ a.id+'" title="'+a.options.prevText+'"></button></div>').appendTo(b).click(function(b){c(e).trigger("mep-playprevtrack");a.playPrevTrack()});this.prevTrack=this.controls.find(".mejs-prevtrack-button")},prevTrackClick:function(){this.prevTrack.trigger("click")},buildnexttrack:function(a,b,f,e){c('<div class="mejs-button mejs-nexttrack-button mejs-nexttrack"><button type="button" aria-controls="'+a.id+'" title="'+a.options.nextText+'"></button></div>').appendTo(b).click(function(b){c(e).trigger("mep-playnexttrack"); a.playNextTrack()});this.nextTrack=this.controls.find(".mejs-nexttrack-button")},nextTrackClick:function(){this.nextTrack.trigger("click")},buildplaylist:function(a,b,f,e){a.options.playlist=c(a.options.playlistSelector).is(":visible");var d=c('<div class="mejs-button mejs-playlist-button '+(a.options.playlist?"mejs-hide-playlist":"mejs-show-playlist")+'"><button type="button" aria-controls="'+a.id+'" title="'+a.options.playlistText+'"></button></div>').appendTo(b).click(function(b){a.options.playlist= !a.options.playlist;c(e).trigger("mep-playlisttoggle",[a.options.playlist]);a.options.playlist?(c(a.options.playlistSelector).show("fast"),d.removeClass("mejs-show-playlist").addClass("mejs-hide-playlist")):(c(a.options.playlistSelector).hide("fast"),d.removeClass("mejs-hide-playlist").addClass("mejs-show-playlist"))});this.playlistToggle=this.controls.find(".mejs-playlist-button")},playlistToggleClick:function(){this.playlistToggle.trigger("click")},playlist_tracks:{},buildplaylistfeature:function(a, b,f,e){var d=this,h=function(a){a=a.split("/");return 0<a.length?decodeURIComponent(a[a.length-1]):""};this.playlist_tracks=c(a.options.playlistSelector).find(".track[data-url]");this.playlist_tracks.each(function(b,f){var g=c(this);c.trim(g.attr("title"))||g.attr("title",h(g.attr("data-url")));g.attr("data-index",b);c('<div class="mejs-controls"><div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="'+d.id+'" title="'+d.options.playpauseText+'" aria-label="'+ d.options.playpauseText+'"></button></div></div>').prependTo(g).click(function(b){b.preventDefault();b=c(this).closest(".track");b.hasClass("current")?e.paused?(e.play(),b.addClass("playing").removeClass("paused"),c(".mejs-play",this).addClass("mejs-pause").removeClass("mejs-play")):(e.pause(),b.addClass("paused").removeClass("playing"),c(".mejs-pause",this).addClass("mejs-play").removeClass("mejs-pause")):(b.addClass("played"),a.playTrack(b));c(this).find("button").focus();return!1});c(this).prepend()}); d.playlist_tracks.eq(0).addClass("current played").siblings().removeClass("current");e.addEventListener("ended",function(a){d.playNextTrack()},!1);e.addEventListener("play",function(a){d.playlist_tracks.filter(".current").find(".mejs-play").addClass("mejs-pause").removeClass("mejs-play")},!1);e.addEventListener("pause",function(a){d.playlist_tracks.filter(".current").find(".mejs-pause").addClass("mejs-play").removeClass("mejs-pause")},!1);a.options.keyActions.push({keys:[34],action:function(a,b){d.playNextTrack()}}); a.options.keyActions.push({keys:[33],action:function(a,b){d.playPrevTrack()}})},playNextTrack:function(){var a=this.playlist_tracks.filter(".current"),b=this.playlist_tracks.not(".played");1>b.length&&(this.playlist_tracks.removeClass("played"),b=this.playlist_tracks.not(".current"));this.options.shuffle?(a=Math.floor(Math.random()*b.length),b=b.eq(a)):(b=parseInt(a.attr("data-index"))+1,b=this.playlist_tracks.eq(b),1>b.length&&this.options.loop&&(b=this.playlist_tracks.eq(0)));1==b.length&&(b.addClass("played"), this.playTrack(b))},playPrevTrack:function(){var a=this.playlist_tracks.filter(".current"),b=this.playlist_tracks.filter(".played").not(".current");1>b.length&&(this.playlist_tracks.removeClass("played"),b=this.playlist_tracks.not(".current"));if(this.options.shuffle)var c=Math.floor(Math.random()*b.length),b=b.eq(c);else b=parseInt(a.attr("data-index"))-1,b=this.playlist_tracks.eq(b),1>b.length&&this.options.loop&&(b=this.playlist_tracks.last());1==b.length&&(a.removeClass("played"),this.playTrack(b))}, playTrack:function(a){var b=this;b.options.duration=0;b.pause();b.setSrc(a.attr("data-url"));b.load();setTimeout(function(){b.media.play()},10);a.addClass("current playing").siblings().removeClass("current").removeClass("playing").removeClass("paused");b.playlist_tracks.find(".mejs-pause").addClass("mejs-play").removeClass("mejs-pause");c(".mejs-play",a).addClass("mejs-pause").removeClass("mejs-play")},playTrackURL:function(a){a=this.playlist_tracks.filter('[data-url="'+a+'"]');this.playTrack(a)}})})(mejs.$);