#SET{url,#ENV{url_document,''}}
<BOUCLE_doc (DOCUMENTS) {id_document}{tout}>
<dd class='spip_doc_descriptif player #ENV{player}'>
	<div class="mejs-audio-wrapper"[ style='width:(#ENV{largeur,400})px;max-width:100%;']>
		<audio class="mejs mejs-#ID_DOCUMENT [ mejs-(#ENV{skin})]"
		       data-id="[(#VAL{mejs-#ID_DOCUMENT}|concat{#ENV{skin}}|md5)]"
		       src="#FICHIER"
		       type="#MIME_TYPE"
		       data-mejsoptions='{"alwaysShowControls": true[,"loop":(#ENV{loop}|?{true,false})],"audioWidth":"100%"[,audioHeight:"(#ENV{hauteur})"][,startVolume:"(#ENV{volume})"]}'
		       controls="controls"
					 [autoplay="autoplay"(#ENV{autoplay}|oui)]></audio>
	</div>
	<script>
		var mejsloader;
		if (typeof mejsloader=="undefined"){
			mejsloader = jQuery.getScript("#CHEMIN{players/mejs/build/mediaelement-and-player.min.js}");
			mejsloader.done(function(){
				var cpt = 0;
				(function($) {
					jQuery("audio.mejs").each(function(){
						cpt++;
						var id = "mejs-" + (jQuery(this).attr('data-id')) + "-" + cpt;
						var autoplay = jQuery(this).attr('autoplay');
						jQuery(this).attr('id',id);
						var options = jQuery(this).attr('data-mejsoptions');
						if (options)
						  eval("options="+options+";");
						else
							options = {};

						new MediaElementPlayer('#'+id,jQuery.extend(options,{
						  "success": function(media) {
							  if (autoplay) media.play();
					    }
					  }));
					})
				})(jQuery);
			});
		}

	</script>
	<link rel="stylesheet" href="#CHEMIN{players/mejs/build/mediaelementplayer.min.css}" />
</dd>
</BOUCLE_doc>