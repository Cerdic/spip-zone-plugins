#SET{langues,#ARRAY}
#SET{langues_vides,#ARRAY}
<BOUCLE_langues_sort(TRADLANG){fusion lang}{langues_preferees}>
<BOUCLE_strings_ok(TRADLANG){lang=#LANG}{statut=OK}> </BOUCLE_strings_ok>
[(#TOTAL_BOUCLE|>{2}|oui)
#SET{langues,#GET{langues}|array_merge{#ARRAY{#LANG,#TOTAL_BOUCLE}}}]
[(#TOTAL_BOUCLE|>{2}|non)
#SET{langues_vides,#GET{langues_vides}|push{#LANG}}
]
</B_strings_ok>
#SET{langues_vides,#GET{langues_vides}|push{#LANG}}
<//B_strings_ok>
</BOUCLE_langues_sort>
#SET{langues,#GET{langues}|langues_sort}
<BOUCLE_priorites(TRADLANG_MODULES){fusion priorite}>
<h3 class="h3">#PRIORITE</h3>
<B_langues_totales>
<div class="bilan">
<table class="spip liste ss_tablesort">
	<thead>
		<tr class="row_first">
			<th></th>
			<BOUCLE_langues_totales(POUR){tableau #GET{langues}}>
			<th class="lang #CLE" title="[(#CLE|traduire_nom_langue)]">
				<abbr title="[(#CLE|traduire_nom_langue)]"><a href="[(#SELF|parametre_url{id_tradlang_module,''}|parametre_url{langue_modules,#CLE})]">[(#CLE)]</a></abbr>
			</th>
			</BOUCLE_langues_totales>
		</tr>
	</thead>
	<B_modules_lang>
	<tbody>
	<BOUCLE_modules_lang(TRADLANG_MODULES){priorite}>
	<tr class="module #NOM_MOD[ (#COMPTEUR_BOUCLE|alterner{row_odd,row_even})]" title="[(#NOM_MOD|attribut_html)]">
		<td><a href="[(#SELF|parametre_url{id_tradlang_module,#ID_TRADLANG_MODULE})]">[(#NOM_MOD)]</a></td>
		#SET{full,''}
		#SET{langue_mere,#LANG_MERE}
		<BOUCLE_compte_langue_mere(TRADLANG){module}{lang=#LANG_MERE}> </BOUCLE_compte_langue_mere>
		#SET{full,#GRAND_TOTAL}
		</B_compte_langue_mere>
		<BOUCLE_langue_module(POUR){tableau #GET{langues}}>
			<BOUCLE_compte_tradlang(TRADLANG){module}{lang=#CLE}{statut=OK}> </BOUCLE_compte_tradlang>
			#SET{class,'non_traduit'}
			[(#TOTAL_BOUCLE|=={#GET{full}}|oui)[(#SET{class,traduit_full})][(#SET{percent,100})]]
			[(#TOTAL_BOUCLE|=={#GET{full}}|non)
			#SET{percent,#TOTAL_BOUCLE|div{#GET{full}}|mult{100}}
			[(#TOTAL_BOUCLE|>={#GET{full}|div{100}|mult{50}}|oui)#SET{class,traduit}]]
			#SET{traduites,#TOTAL_BOUCLE}
			[(#_langue_module:CLE|!={#GET{langue_mere}}|oui)<td class="#GET{class}"><a href="[(#URL_TRADLANG_MODULE{#ID_TRADLANG_MODULE}|parametre_url{lang_cible,#CLE})]" title="<:tradlang:info_percent_chaines{total=#GET{full},traduites=#GET{traduites}}:>">[(#GET{percent}|floor)%]</a></td>]
			[(#_langue_module:CLE|=={#GET{langue_mere}}|oui)<td class="[(#GET{class})] lang_mere">#TOTAL_BOUCLE</td>]
			</B_compte_tradlang>
			<td class="non_traduit"><a href="[(#URL_TRADLANG_MODULE{#ID_TRADLANG_MODULE}|parametre_url{lang_cible,#CLE})]"> - </a></td>
			<//B_compte_tradlang>
		</BOUCLE_langue_module>
	</tr>
	</BOUCLE_modules_lang>
	</tbody>
	</B_modules_lang>
</table>
</B_langues_totales>
<//B_langues_totales>
</div>
</BOUCLE_priorites>
<script type='text/javascript'><!--
var modules = [];
$('table.bilan th').each(function(i){
	modules[i] = $(this).attr('title');
});
$('table.bilan tr').each(function() {
	var lang = $('td',this).parent('tr').attr('title');
	if (lang && (lang = lang.replace(/:.*/,'')) && lang != 'fr'){
		$('td',this).each(function(i){
			$(this).find('a').click(function(){
				var module = modules[i];
				if (confirm('<:tradlang:message_confirm_redirection:> : '+lang+' ['+module+']')) {
					return true;
				}else{
					return false;
				}
			});
		});
	}
});
// --></script> 