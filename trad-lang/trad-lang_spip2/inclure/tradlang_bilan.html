#SET{langues,#ARRAY}
<BOUCLE_langues_sort(TRADLANG){fusion lang}>
<BOUCLE_strings_ok(TRADLANG){lang=#LANG}{statut = 'OK'}> </BOUCLE_strings_ok>
#SET{langues,#GET{langues}|array_merge{#ARRAY{#LANG,#COMPTEUR_BOUCLE}}}
</B_strings_ok>
#SET{langues,#GET{langues}|array_merge{#ARRAY{#LANG,#COMPTEUR_BOUCLE}}}
<//B_strings_ok>
</BOUCLE_langues_sort>
#SET{langues,#GET{langues}|langues_sort}
<B_modules>
<table class="bilan spip liste">
	<thead>
		<tr class="first_row">
			<th class="lang">
			<BOUCLE_modules(TRADLANG_MODULES){par id_tradlang_module}>
			<th class="module #MODULE" title="[(#NOM_MOD|attribut_html)]">
				<abbr title="[(#NOM_MOD|attribut_html)]">[(#NOM_MOD|couper{10})]</abbr>
			</th>
			</BOUCLE_modules>
		</tr>
	</thead>
	<B_langues>
	<tbody>
	<BOUCLE_langues(POUR){tableau #GET{langues}}>
	<tr class="#CLE[ (#COMPTEUR_BOUCLE|alterner{row_odd,row_even})]" title="#CLE">
		<td>[(#CLE|traduire_nom_langue)]</td>
		<BOUCLE_modules_langue(TRADLANG_MODULES){par id_tradlang_module}>
			#SET{full,''}
			#SET{langue_mere,#LANG_MERE}
			<BOUCLE_compte_mere(TRADLANG){module}{lang=#LANG_MERE}> </BOUCLE_compte_mere>
			#SET{full,#TOTAL_BOUCLE}
			</B_compte_mere>
			<BOUCLE_compte(TRADLANG){module}{lang=#_langues:CLE}{statut=OK}> </BOUCLE_compte>
			#SET{class,'non_traduit'}
			[(#TOTAL_BOUCLE|=={#GET{full}}|oui)#SET{class,traduit_full}]
			[(#TOTAL_BOUCLE|=={#GET{full}}|non)
			[(#TOTAL_BOUCLE|>={#GET{full}|div{100}|mult{60}}|oui)#SET{class,traduit}]]
			[(#_langues:CLE|!={#GET{langue_mere}}|oui)<td class="#GET{class}"><a href="[(#URL_PAGE{traduction}|parametre_url{etape,traduction}|parametre_url{module,#MODULE}|parametre_url{lang_cible,#_langues:CLE})]">#TOTAL_BOUCLE</a></td>]
			[(#_langues:CLE|=={#GET{langue_mere}}|oui)<td class="[(#GET{class})] lang_mere">#TOTAL_BOUCLE</td>]
			</B_compte>
			<td class="non_traduit"><a href="[(#URL_PAGE{traduction}|parametre_url{etape,traduction}|parametre_url{module,#MODULE}|parametre_url{lang_cible,#_langues:CLE})]"> - </a></td>
			<//B_compte>
		</BOUCLE_modules_langue>
	</tr>
	</BOUCLE_langues>
	</tbody>
	</B_langues>
</table>
</B_modules>
<script type='text/javascript'><!--
var modules = [];
$('table.bilan th').each(function(i){
	modules[i] = $(this).attr('title');
});
$('table.bilan tr').each(function() {
	var lang = $('td',this).parent('tr').attr('title');
	if (lang && (lang = lang.replace(/:.*/,'')) && lang != 'fr'){
		console.log(lang);
		$('td',this).each(function(i){
			$(this).find('a').click(function(){
				if (confirm('<:tradlang:message_confirm_redirection:> : '+modules[i]+' ['+lang+']')) {
					var url = '[(#URL_PAGE{traduction}|parametre_url{etape,traduction})]&module=' +modules[i] +'&lang_cible=' +lang;
					if (window.parent)
						window.parent.location = url;
					else
						window.location = url;
				}else{
					return false;
				}
			});
		});
	}
});
// --></script> 