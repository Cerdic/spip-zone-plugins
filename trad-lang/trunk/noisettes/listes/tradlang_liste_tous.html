<BOUCLE_module(TRADLANG_MODULES){id_tradlang_module?}{module?}>
[(#SET{lang_orig,#ENV{lang_orig,#LANG_MERE}})]
[(#SET{str_mere,#ARRAY})]
[(#SET{str_cible,#ARRAY})]
[(#SET{str_statut,#ARRAY})]
[(#SET{langue_longue,#ENV{lang_cible}|traduire_nom_langue})]
[(#SET{defaut_tri,#ARRAY{statut,#ENV{statut_sens,1},id,1,str,1,maj,-1}})]
[(#SET{autoriser_modifier,#AUTORISER{modifier,tradlang}})]

<BOUCLE_revise(TRADLANGS){module}{lang=#LANG_MERE}>[(#SET{str_mere,[(#GET{str_mere}|push{#ID})]})] </BOUCLE_revise>
#SET{total_mere,#GRAND_TOTAL}
<p><:tradlang:nb_items_langue_mere{nb=#GET{total_mere}}:></p>
	<BOUCLE_total_orig(TRADLANGS){module}{statut=OK}{lang=#ENV{lang_orig}}> </BOUCLE_total_orig>
		[(#GRAND_TOTAL|<{#GET{total_mere}}|oui)
			[(#SET{compte_langue_orig,#GRAND_TOTAL})]
			[(#SET{lang_orig,#LANG_MERE})]
			<div class="notice">
				<:tradlang:message_changement_lang_orig{lang_orig=#ENV{lang_orig},lang_nouvelle=#GET{lang_orig}}:>
			</div>]
	</B_total_orig>[(#SET{compte_langue_orig,0})
	][(#SET{lang_orig,#LANG_MERE})
	]<div class="notice">
		<:tradlang:message_changement_lang_orig_inexistante{lang_orig=#ENV{lang_orig},lang_nouvelle=#GET{lang_orig}}:>
	</div>
	<//B_total_orig>
</B_revise>
	[(#BOITE_OUVRIR{'',error})]
		<:tradlang:erreur_aucun_item_langue_mere{lang_mere=#LANG_MERE}:>
	[(#BOITE_FERMER)]
<//B_revise>

<BOUCLE_total_item(TRADLANGS){module}{id IN #GET{str_mere}}{lang=#ENV{lang_cible}}>[(#SET{str_cible,#GET{str_cible}|push{#ID}})] </BOUCLE_total_item>
[(#SET{total_cible,#GRAND_TOTAL})]</B_total_item>[(#SET{total_cible,0})]<//B_total_item>
<BOUCLE_total_item_ok(TRADLANGS){module}{id IN #GET{str_mere}}{statut=OK}{lang=#ENV{lang_cible}}> </BOUCLE_total_item_ok>
[(#SET{total_ok,#GRAND_TOTAL})]
</B_total_item_ok>#SET{total_ok,0}<//B_total_item_ok>
<BOUCLE_total_item_new(TRADLANGS){module}{id IN #GET{str_mere}}{statut=NEW}{lang=#ENV{lang_cible}}> </BOUCLE_total_item_new>
[(#SET{total_new,#GRAND_TOTAL})]
</B_total_item_new>[(#SET{total_new,0})]<//B_total_item_new>
<BOUCLE_total_item_modif(TRADLANGS){module}{id IN #GET{str_mere}}{statut=MODIF}{lang=#ENV{lang_cible}}> </BOUCLE_total_item_modif>
[(#SET{total_modif,#GRAND_TOTAL})]
</B_total_item_modif>#SET{total_modif,0}<//B_total_item_modif>
[(#SET{percent_ok,#GET{total_ok}|div{#GET{total_mere}}|mult{100}|floor})]
[(#SET{percent_modif,#GET{total_modif}|div{#GET{total_mere}}|mult{100}|floor})]
[(#SET{percent_new,#VAL{100}|moins{#GET{percent_ok}}|moins{#GET{percent_modif}}})]

<div class="info_module">
	[(#GET{total_new}|plus{#GET{total_modif}}|plus{#GET{total_ok}}|>{0}|oui)
	<p><:tradlang:info_module_traduit_pc{pc=#GET{percent_ok}}:></p>
	<ul>[(#SET{module_existant,oui})][(#GET{total_new}|>{0}|oui)
		<li>
			<:tradlang:info_module_traduction{total=#GET{total_new},percent=#GET{percent_new},statut=NEW}:>
		</li>][(#GET{total_modif}|>{0}|oui)
		<li>
			<:tradlang:info_module_traduction{total=#GET{total_modif},percent=#GET{percent_modif},statut=MODIF}:>
		</li>]
		<li>
			<div class="graph" title="<:tradlang:info_module_traduit_pc{pc=#GET{percent_ok}}:>">
				<div class="ok"[ style="width: (#GET{percent_ok})px"]> </div>
				<div class="modif" style="[#LANG_LEFT: (#GET{percent_ok})px;][width: (#GET{percent_modif})px]"></div>
				<div class="new" style="#LANG_LEFT: [(#GET{percent_ok}|plus{#GET{percent_modif}})]px; width: #GET{percent_new}px"> </div>
			</div>
		</li>
	</ul>]
	[(#GET{total_ok}|=={0}|et{#GET{total_cible}|>{0}}|et{#GET{autoriser_modifier}}|oui)
	[(#SET{texte_bouton_delete,<:tradlang:bouton_supprimer_langue_module:>}|attribut_html)]
	<div class="actions">
		[(#BOUTON_ACTION{#GET{texte_bouton_delete},[(#URL_ACTION_AUTEUR{tradlang_supprimer_langue_cible,[(#ID_TRADLANG_MODULE|concat{/#ENV{lang_cible}})],#SELF})]})]
	</div>]
	[(#GET{total_ok}|>{0}|et{#GET{total_cible}|>{0}}|et{#GET{autoriser_modifier}}|oui)
	<div class="actions">
		<p class="info_export"><:tradlang:info_export:></p>
		[(#BOUTON_ACTION{[(#VAL{tradlang:bouton_exporter_fichier_langue}|_T{#ARRAY{lang,#ENV{lang_cible}}})],[(#URL_ACTION_AUTEUR{tradlang_exporter_langue,[(#ID_TRADLANG_MODULE|concat{/#ENV{lang_cible}}|concat{/#TYPE_EXPORT}|concat{/non})],#SELF})],icon-export})]
		[(#BOUTON_ACTION{[(#VAL{tradlang:bouton_exporter_fichier_langue_complet}|_T{#ARRAY{lang,#ENV{lang_cible}}})],[(#URL_ACTION_AUTEUR{tradlang_exporter_langue,[(#ID_TRADLANG_MODULE|concat{/#ENV{lang_cible}})],#SELF})],icon-export,<:tradlang:message_avertissement_export_langue_complet:>})]
		[(#BOUTON_ACTION{[(#VAL{tradlang:bouton_exporter_fichier_langue_po}|_T{#ARRAY{lang,#ENV{lang_cible}}})],[(#URL_ACTION_AUTEUR{tradlang_exporter_langue,[(#ID_TRADLANG_MODULE|concat{/#ENV{lang_cible}|concat{/po}})],#SELF})],icon-export,<:tradlang:message_avertissement_export_langue_po:>})]
		[(#GET{lang_orig}|et{#GET{lang_orig}|!={#LANG_MERE}}|oui)
		[(#BOUTON_ACTION{[(#VAL{tradlang:bouton_exporter_fichier_langue}|_T{#ARRAY{lang,#GET{lang_orig}}})],[(#URL_ACTION_AUTEUR{tradlang_exporter_langue,[(#ID_TRADLANG_MODULE|concat{/#GET{lang_orig}})],#SELF})],icon-export})]]
		[(#BOUTON_ACTION{<:tradlang:bouton_exporter_fichier_langue_original{lang_mere=#LANG_MERE}|attribut_html:>,[(#URL_ACTION_AUTEUR{tradlang_exporter_langue,[(#ID_TRADLANG_MODULE|concat{/#LANG_MERE})],#SELF})],icon-export})]
	</div>]
</div>
[(#REM)	
[(#GET{total_mere}|>{0}|oui)<p> <:tradlang:nb_items_langue_cible{nb=#GET{total_mere},langue=#ENV{lang_cible}}:></p>]]
[(#GET{autoriser_modifier}|oui)
<div class="actions">
	<p><:tradlang:info_edition_par_lot:></p>
	[(#SET{texte_bouton_upload,<:tradlang:bouton_upload_langue_module:>}|attribut_html)]
	[(#ENV{edit}|=={1}|oui)
	<a href="[(#SELF|parametre_url{edit,2})]" class="ajax btn icon-back"><:tradlang:lien_retour_module{module=#NOM_MOD}:></a>]
	[(#ENV{edit}|=={1}|non|et{#GET{module_existant,non}|=={oui}|oui}|et{#GET{percent_ok}|!={100}|oui}|oui)
	<a href="[(#SELF|parametre_url{edit,1})]" class="ajax btn icon-edit"><:tradlang:lien_editer_tous:></a>]
	[(#BOUTON_ACTION{#GET{texte_bouton_upload},[(#SELF|parametre_url{vue,upload})],icon-upload})]
</div>]

<BOUCLE_si_edit(CONDITION){si #GET{autoriser_modifier}|et{#ENV{edit}|=={1}}}>
[(#_module:CRAYON{tradlang_tous})]
</BOUCLE_si_edit>
</B_si_edit>

<B_statut>
	[(#GRAND_TOTAL|>{1}|oui)
	<div class="actions">
		<p class="filtrer"><:tradlang:info_filtrer_status:></p>
		[(#ENV{statut}|oui)<a href="[(#_module:URL_TRADLANG_MODULE|parametre_url{statut,''}|parametre_url{lang_cible,#ENV{lang_cible}}|parametre_url{lang_orig,#ENV{lang_orig}})]" class="ajax bouton"><:tradlang:lien_aucun_status:></a>]
		[(#ENV{statut}|non)<strong class="on"><:tradlang:lien_aucun_status:></strong>]]
	<BOUCLE_statut(TRADLANGS){module}{id IN #GET{str_mere}}{lang=#ENV{lang_cible}}{fusion statut}>
	[(#GRAND_TOTAL|>{1}|oui)[(#SET{statut,#STATUT})]
		[(#STATUT|!={#ENV{statut}}|oui)<a href="[(#_module:URL_TRADLANG_MODULE|parametre_url{statut,#STATUT}|parametre_url{lang_cible,#ENV{lang_cible}}|parametre_url{lang_orig,#ENV{lang_orig}})]" class="ajax bouton">#STATUT</a>]
		[(#STATUT|!={#ENV{statut}}|non)<strong class="on">#STATUT</strong>]]
	</BOUCLE_statut>
	[(#GRAND_TOTAL|>{1}|oui)
	</div>]
</B_statut>[(#REM)
 
	Si un seul statut et pas celui de l'environnement c'est qu'on aura pas de résultats après

][(#GRAND_TOTAL|=={1}|et{#ENV{statut}}|et{#GET{statut}|!={#ENV{statut}}}|oui)
	<p><:tradlang:message_aucun_resultat_statut:></p>
	<p><a href="[(#_module:URL_TRADLANG_MODULE|parametre_url{statut,''}|parametre_url{lang_cible,#ENV{lang_cible}}|parametre_url{lang_orig,#ENV{lang_orig}})]"><:tradlang:lien_voir_toute_chaines_module:></a></p>]
</B_statut>[(#REM)

	On affiche les id qui n'existent pas dans la langue cible

]<B_revise_inexistants>[(#SET{total_inexistants,#GRAND_TOTAL})]
[(#GET{total_inexistants}|=={#GET{total_mere}}|oui)
	[(#SET{texte_bouton,[(#VAL{tradlang:bouton_activer_lang}|_T{#ARRAY{lang,#ENV{lang_cible}}})]})]
	[(#GET{autoriser_modifier}|oui)
		[(#ENV{lang_cible}|langue_possible|oui)
			[<div class="error">(#GET{total_inexistants}|singulier_ou_pluriel{tradlang:nb_item_langue_inexistant,tradlang:nb_items_langue_inexistants,nb,#ARRAY{langue,#ENV{lang_cible},langue_longue,#GET{langue_longue}}})</div>]
		<div class="actions">
			[(#BOUTON_ACTION{#GET{texte_bouton},[(#URL_ACTION_AUTEUR{tradlang_creer_langue_cible,#ID_TRADLANG_MODULE,#SELF}|parametre_url{lang_crea,#ENV{lang_cible}})]})]
		</div>]
		[(#ENV{lang_cible}|langue_possible|non)
		#BOITE_OUVRIR{'',error}
			<:tradlang:erreur_langue_activer_impossible{lang=#ENV{lang_cible}}:>
		#BOITE_FERMER]]
[(#GET{total_inexistants}|=={#GET{total_mere}}|non)
	[(#SET{texte_bouton,[(#VAL{tradlang:bouton_activer_lang}|_T{#ARRAY{lang,#ENV{lang_cible}}})]})]
	[(#GET{autoriser_modifier}|oui)
	#BOITE_OUVRIR{'',error}
		[(#SET{arg,#MODULE|concat{/#ENV{lang_cible}}})]
		[(#BOUTON_ACTION{<:tradlang:label_update_langues_cible_mere:>,[(#URL_ACTION_AUTEUR{tradlang_verifier_langue_base,#GET{arg},#SELF})]})]
	#BOITE_FERMER]
]<table class="spip liste_traductions tablesorter">
	<thead>
		<tr>
			<th class="code_langue"><:tradlang:codelangue:></th>
			<th class="origine"><:tradlang:traduction{lang=#GET{lang_orig}}:></th>
			<th class="date"><:tradlang:th_date:></th>
			<th class="statut"><:tradlang:th_status:></th>
		</tr>
	</thead>
	<tbody>
	<BOUCLE_revise_inexistants(TRADLANGS){module}{id !IN #GET{str_cible}}{lang=#LANG_MERE}>
	<tr class="[(#COMPTEUR_BOUCLE|alterner{odd,even})]">
		<td>#ID</td>
		<BOUCLE_revise_inexistants_orig(TRADLANGS){module}{id=#ID}{lang=#GET{lang_orig}}>
		<td style="text-align:#LANG_LEFT;" dir="#LANG_DIR">[(#STR**|entites_html|nl2br)]</td>
		</BOUCLE_revise_inexistants_orig>
		<td style="text-align:#LANG_LEFT;" dir="#LANG_DIR"><:tradlang:str_existe_pas_in_langue:></td>
		<//B_revise_inexistants_orig>
		<td style="text-align:#LANG_LEFT;" dir="#LANG_DIR">#MAJ</td>
		<td>#STATUT</td>
	</tr>
	</BOUCLE_revise_inexistants>
	</tbody>
</table>
</B_revise_inexistants>[(#REM)

	On affiche les id qui n'existent pas dans la langue cible

]<B_revise_en_trop>[(#SET{total_en_trop,#GRAND_TOTAL})]
[<p>(#GET{total_en_trop}|singulier_ou_pluriel{tradlang:nb_items_langue_en_trop,tradlang:nb_item_langue_en_trop,nb,#ARRAY{langue,#ENV{lang_cible},langue_longue,#GET{langue_longue}}})</p>]
<table class="spip liste_traductions tablesorter">
	<thead>
		<tr>
			<th class="code_langue"><:tradlang:codelangue:></th>
			<th class="cible"><:tradlang:traduction{lang=#ENV{lang_cible}}:></th>
			<th class="date"><:tradlang:th_date:></th>
			<th class="statut"><:tradlang:th_status:></th>
		</tr>
	</thead>
	<tbody>
	<BOUCLE_revise_en_trop(TRADLANGS){module}{!id IN #GET{str_mere}}{lang=#ENV{lang_cible}}>
	<tr class="[(#COMPTEUR_BOUCLE|alterner{row_odd,row_even})]">
		<td>#ID</td>
		<td style="text-align:#LANG_LEFT;" dir="#LANG_DIR">[(#STR**|entites_html|nl2br)]</td>
		<td style="text-align:#LANG_LEFT;" dir="#LANG_DIR">#MAJ</td>
		<td>#STATUT</td>
	</tr>
	</BOUCLE_revise_en_trop>
	</tbody>
</table>
</B_revise_en_trop>[(#REM)

	On affiche finalement le tableau de traductions

]<B_revise_cible>
<table class="spip liste_traductions tablesorter">
	<thead>
		<tr class="row_first">
			<th class="code_langue"><:tradlang:codelangue:></th>
			<th class="origine">[(#VAL{tradlang:traduction}|_T{#ARRAY{lang,#GET{lang_orig}}})]</th>
			<th class="cible"><:tradlang:traduction{lang=#ENV{lang_cible}}:></th>
			<th class="date"><:tradlang:th_date:></th>
			<th class="statut"><:tradlang:th_status:></th>
			<th class="modifier ts_disabled">&nbsp;</th>
		</tr>
	</thead>
	<tbody>[(#REM)
	
		on n'affiche que les id qui existent dans la langue mère
	]<BOUCLE_revise_cible(TRADLANGS trandlang_modules){module}{id IN #GET{str_mere}}{statut ?}{lang=#ENV{lang_cible}}{tri #ENV{par,statut},#GET{defaut_tri}}{par id}>
	<tr class="[(#COMPTEUR_BOUCLE|alterner{row_odd,row_even})] statut_[(#STATUT|strtolower)]" id="tradlang-#ID_TRADLANG">
		<td class="code_langue">#ID</td>
		<BOUCLE_revise_orig(TRADLANGS){module}{id=#ID}{lang=#GET{lang_orig,#LANG_MERE}}>
		<td class="origine" style="text-align:#LANG_LEFT;" dir="#LANG_DIR">[(#STR**|tradlang_utf8|entites_html|nl2br)]</td>
		</BOUCLE_revise_orig>
		<td class="origine" style="text-align:#LANG_LEFT;" dir="#LANG_DIR"><:tradlang:str_existe_plus:></td>
		<//B_revise_orig>
		<td class="cible #EDIT{str_statut}" style="text-align:#LANG_LEFT;" dir="#LANG_DIR">[(#STR**|tradlang_utf8|entites_html|nl2br)]</td>
		<td class="date">#MAJ</td>
		<td class="statut" width="50px">[(#STATUT|sinon{<:tradlang:info_status_ok:>})]</td>
		<td class="modifier" width="50px"><a href="[(#URL_TRADLANG|parametre_url{lang_orig,#GET{lang_orig}}|parametre_url{retour,#SELF})]"><:tradlang:lien_editer_chaine:></a></td>
	</tr>
	</BOUCLE_revise_cible>
	</tbody>
</table>
</B_revise_cible>
<//B_si_edit>
</BOUCLE_module>
</B_module>[(#REM)

	Le module n'existe pas

][(#BOITE_OUVRIR{'',error})]
	<:tradlang:erreur_module_inconnu:>
[(#BOITE_FERMER)]
<//B_module>