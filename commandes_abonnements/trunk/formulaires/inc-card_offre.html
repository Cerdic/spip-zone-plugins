#SET{prix,#ENV{prix/#ID_ABONNEMENTS_OFFRE}}
#SET{prix_libre,#ENV{prix_libre/abonnement#ID_ABONNEMENTS_OFFRE}}

[(#REM) Calcul de l'affichage du prix avec 2 cas particuliers ]
[(#SET{periodicite, #ENV{duree}|=={0}|?{<:abonnementsoffre:champ_duree_0:>,#VAL{abonnementsoffre:champ_periode_nb_}|concat{#ENV{periode}}|_T{#ARRAY{nb,#ENV{duree}}}}})]
[(#ENV{duree}|=={1}|et{#ENV{periode}|=={mois}})
#SET{periodicite, "mois"}
]
[(#ENV{duree}|=={12}|et{#ENV{periode}|=={mois}})
#SET{periodicite, "an"}
]
<form
	method="post" action="#ENV{action}" enctype="multipart/form-data"
	id="offre#ID_ABONNEMENTS_OFFRE"
	class="editer editer_abonnements_offre offre[ (#ENV{alternative/quel}|!={principal}|?{alternative})][ (#ENV{renouvellement_auto}|oui)renouvelable]"
><div class="offre__wrapper">
	[(#REM) declarer les hidden qui declencheront le service du formulaire 
	parametre : url d'action ]
	#ACTION_FORMULAIRE{#ENV{action}}

	[<div class="offre__logo">(#LOGO_ABONNEMENTS_OFFRE{#ID_ABONNEMENTS_OFFRE})</div>]

	<h3 class="offre__titre">#ENV{titre}</h3>

	[<div class="offre__descriptif">
		(#ENV*{descriptif})
	</div>]

	<div class="offre__prix">
		<span class="montant">#ENV{montant} €</span>[<span class="par">
		/ </span><span class="periodicite">(#ENV{renouvellement_auto}|?{#GET{periodicite}})</span>]
	</div>

	[(#ENV{alternative}|oui)
	<div class="offre__alternative">
		<a class="button" [(#ENV{alternative/quel}|!={principal}|oui)href="#offre#ENV{alternative/id}"]>
			#ENV{alternative/label1}
		</a>
		<a class="button" [(#ENV{alternative/quel}|=={principal}|oui)href="#offre#ENV{alternative/id}"]>
			#ENV{alternative/label2}
		</a>
	</div>
	]

	<BOUCLE_test_perso(CONDITION){si #ENV{montant_perso}}>
	<fieldset class="offre__perso">
		<legend>Personnaliser le montant</legend>
		[<span class="erreur">(#ENV{erreurs/montant_#ID_ABONNEMENTS_OFFRE})</span>]
		<BOUCLE_montants(DATA){source table, #VAL{#ENV{montant}}|concat{'|', #ENV{montant_minimum}}|explode{'|'}|array_filter}>
		#SET{montant,#VALEUR|trim}
		<input type="radio" id="montants_persos_[(#ID_ABONNEMENTS_OFFRE)]_#GET{montant}" name="montants_persos\[#ID_ABONNEMENTS_OFFRE\]\[predef\]" value="#GET{montant}" [(#COMPTEUR_BOUCLE|=={1}|oui)checked="checked"] />
		<label for="montants_persos_[(#ID_ABONNEMENTS_OFFRE)]_#GET{montant}">#GET{montant}€</label>
		</BOUCLE_montants>
		<input
			type="text"
			class="ui-widget ui-button ui-checkboxradio-label ui-checkboxradio-radio-label"
			id="montants_persos_#ID_ABONNEMENTS_OFFRE"
			name="montants_persos\[#ID_ABONNEMENTS_OFFRE\]\[libre\]"
			placeholder="Autre"
			value="#ENV{montants_persos/#ID_ABONNEMENTS_OFFRE/libre}"
			size="3"
		/>
	</fieldset>
	</BOUCLE_test_perso>

	<div class="offre__duree">
		[(#ENV{renouvellement_auto}|non)
			<span class="label"><:abonnementsoffre:info_duree:> :</span>
			[(#ENV{duree}|singulier_ou_pluriel{abonnementsoffre:champ_periode_nb_#PERIODE,abonnementsoffre:champ_periode_nb_#PERIODE})]
		]
		[(#ENV{renouvellement_auto}|oui)
			<:abonnementsoffre:info_renouvellement_auto:>
		]
	</div>

	<div class="offre__paiement">
		[(#ENV{renouvellement_auto}|non)
			<span class="label"><:abonnementsoffre:info_paiement:> :</span> <:abonnementsoffre:info_paiement_unique:>
		]
		[(#ENV{renouvellement_auto}|oui)
		<span class="label"><:abonnementsoffre:info_paiement_auto:> :</span> [(#ENV{duree})][ (#ENV{periode})]
		]
	</div>

	<div class="offre__choix">
		<button type="submit" name="id_abonnements_offre" value="#ENV{id_abonnements_offre}">Choisir cette offre</button>
	</div>
</div></form>
