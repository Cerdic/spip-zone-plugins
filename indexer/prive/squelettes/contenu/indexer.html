<h1>Test de l'indexer</h1>

<?php

include_spip('inc/indexer');

$indexer = new Indexer\Indexer();

$indexer->registerStorage(
    new Indexer\Storage\Sphinx(new Sphinx\SphinxQL(), 'spip')
);


$sources = new Indexer\Sources\Sources();
$sources->register(new Spip\Indexer\Sources\Articles());


foreach ($sources as $source) {

    # $source->setTablesLiens(false);

    echo "<strong>Temps pour $source :</strong><br />";
    spip_timer('source');

    $documents = $source->getAllDocuments();

    $t = spip_timer('source');
    echo $t;


    echo "<br /><strong>Temps pour indexer :</strong><br />";
    spip_timer('indexage');

    $indexer->replaceDocuments($documents);

    $t = spip_timer('indexage');
    echo $t;
}



