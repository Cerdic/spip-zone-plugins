<BOUCLE_doc (DOCUMENTS) {id_document}>
[(#REM)

	Modele pour <doc> en dl/dt/dd
	cf. http://pompage.net/pompe/listesdefinitions/

	La largeur de la legende est egale a la largeur de l'image
	avec un minimum de 120px, et un maximum de 350px.

	Dans le cas d'une simple image (mode=vignette), on affiche
	le document lui-meme, sans lien de telechargement
]
[(#MODE|=={vignette}|?{' '})
	#SET{fichier,#URL_DOCUMENT}
	#SET{width,#LARGEUR}
	#SET{height,#HAUTEUR}
	#SET{url,#ENV{lien}}
]
[(#MODE|=={vignette}|?{'',' '})
	[(#SET{fichier,[(#LOGO_DOCUMENT||extraire_attribut{src})]})]
	[(#SET{width,[(#LOGO_DOCUMENT||extraire_attribut{width})]})]
	[(#SET{height,[(#LOGO_DOCUMENT||extraire_attribut{height})]})]
	#SET{url,#ENV{lien,#URL_DOCUMENT}}
]
#SET{lien_class,#ENV{lien_class}}
<!-- thickbox -->
[(#GET{url}|?{' '}) 
  [(#MIME_TYPE|match{image/(?:jpeg|png|gif)}|?{' '})
    #SET{lien_class,#GET{lien_class}|concat{' thickbox'}}
    #DEBUT_TEXTE_HEAD
    <script src='#CHEMIN{thickbox/thickbox.js}' type='text/javascript'></script>
    <link rel="stylesheet" href="#CHEMIN{thickbox/thickbox.css}" type="text/css" media="projection, screen" />
    <script type="text/javascript"><!--
    // Inside the function "this" will be "document" when called by ready() 
    // and "the ajaxed element" when called because of onAjaxLoad 
    var init_f = function() {
    	if ($("a.thickbox,a\u005b@type=\'image/jpeg\'\u005d,a\u005b@type=\'image/png\'\u005d,a\u005b@type=\'image/gif\'\u005d",this).addClass("thickbox").size()) {
    		TB_chemin_animation = "#CHEMIN{thickbox/circle_animation.gif}";
    		TB_chemin_close = "#CHEMIN{thickbox/close.gif}";
    		TB_chemin_css = "#CHEMIN{thickbox/thickbox.css}";
    		TB_init(this);
    	};
    }
    //onAjaxLoad is defined in private area only
    if(typeof onAjaxLoad == "function") onAjaxLoad(init_f);
    $(document).ready(init_f);
    // --></script>
    <script src='#CHEMIN{thickbox/thickbox.js}' type='text/javascript'></script>
    #FIN_TEXTE_HEAD  
  ]
]

<dl class='spip_document_#ID_DOCUMENT spip_documents[ spip_documents_(#ENV{align})][ (#ENV{class})] spip_lien_ok'[ style='float:(#ENV{align}|match{left|right});']>
<dt>[<a href="(#GET{url})"[ class="(#GET{lien_class})"] title='#TYPE_DOCUMENT - [(#TAILLE|taille_en_octets|texte_backend)]'[ (#ENV{lien}|?{'',type="#MIME_TYPE"})]>]<img src='#GET{fichier}' width='#GET{width}' height='#GET{height}' alt='#TYPE_DOCUMENT - [(#TAILLE|taille_en_octets|texte_backend)]' />[(#GET{url}|?{</a>})]</dt>[
<dt class='#EDIT{titre} spip_doc_titre'[ style='width:(#GET{width}|min{350}|max{120})px;']><strong>(#TITRE)</strong></dt>][
<dd class='#EDIT{descriptif} spip_doc_descriptif'[ style='width:(#GET{width}|min{350}|max{120})px;']>(#DESCRIPTIF|PtoBR)[(#NOTES|PtoBR)]</dd>]
</dl>
</BOUCLE_doc>
