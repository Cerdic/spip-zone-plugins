#HTTP_HEADER{Content-type: text/xml}
<!-- header pour eviter d'y mettre les boutons d'admin ... -->
#CACHE{0}
<actions>
<BOUCLE_arts(ARTICLES){0,5}>
<!-- on effectue un update d'un article -->
<update type='articles'>
	<!-- dont la cle est id_article -->
	<where name='id_article' value='#ID_ARTICLE'/>
	<!-- et dont on peut modifier les titres et surtitre,
		selon les valeurs envoyees par le formulaire -->
	<field name='titre' valueFrom='titreArt#ID_ARTICLE'/>
	<field name='surtitre' valueFrom='surtitreArt#ID_ARTICLE'/>
</update>
</BOUCLE_arts>

<!-- on effectue un insert d'un article -->
<!-- l'id de l'article cree sera stocke dans 'art' -->
<insert type='articles' id='art'>
	<!-- le titre est obligatoire -->
	<field name='titre' cond='!' valueFrom='titreNewArt'/>
	<field name='surtitre' valueFrom='surtitreNewArt'/>
	<field name='texte' valueFrom='texteNewArt'/>

	<!-- la rubrique d'accrochage aussi -->
	<field name='id_rubrique' cond='!' valueFrom='rubNewArt'/>
	<!-- le secteur se deduit de la rubrique -->
	<field name='id_secteur'>
		<!-- par un select en base -->
		<select type='rubriques' name='id_secteur'>
			<where name='id_rubrique' valueFrom='rubNewArt'/>
		</select>
	</field>
	<!-- on fait cet insert si l'autre est fait -->
	<insert type='auteurs_articles'>
		<field name='id_auteur' value='#ID_AUTEUR'/>
		<!-- on recupere l'id genere pour l'insert precedent -->
		<field name='id_article' ref='art'/>
	</insert>
</insert>
</actions>
